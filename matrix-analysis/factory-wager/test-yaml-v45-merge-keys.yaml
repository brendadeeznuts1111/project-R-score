---
# Document 1: Base configurations with anchors
_document_index: 0
_schema_version: v4.5

# Base configuration anchor
defaults: &defaults
  timeout: 30
  retries: 3
  log_level: info
  features:
    caching: true
    compression: true

# Production-specific defaults
production: &production
  <<: *defaults
  timeout: 60
  log_level: warn
  monitoring:
    enabled: true
    metrics: true

---
# Document 2: Environment configurations using merge inheritance
_document_index: 1
is_config: true

# Development environment - inherits from defaults
development:
  <<: *defaults
  debug: true
  hot_reload: true
  database:
    host: localhost
    port: 5432

# Staging environment - inherits from production
staging:
  <<: *production
  timeout: 45
  database:
    host: staging.db.internal
    ssl: true

# Production environment - inherits and extends
production:
  <<: *production
  database:
    host: prod.db.internal
    ssl: true
    pool_size: 20
  monitoring:
    alerts: true
    slack_webhook: ${SLACK_WEBHOOK}

---
# Document 3: Complex merge scenarios
_document_index: 2
is_advanced: true

# Multiple merge inheritance
hybrid_config:
  <<: *defaults
  <<: *production
  custom_feature: true
  timeout: 120

# Merge with array of anchors
multi_merge:
  <<: [*defaults, *production]
  environment: hybrid
  features:
    <<: *defaults
    new_feature: true

# Nested merge keys
nested:
  server:
    <<: *defaults
    port: 8080
  database:
    <<: *defaults
    connection_pool: 10
