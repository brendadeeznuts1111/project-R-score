<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Interactive dashboard and monitoring system with real-time performance metrics and analysis tools.">
    <meta name="keywords" content="dashboard, monitoring, performance, metrics, analytics, real-time, visualization">
    <meta property="og:title" content="Origin Dashboard - System Monitoring">
    <meta property="og:description" content="Real-time performance monitoring and analytics dashboard">
    <meta property="og:type" content="website">
    <meta property="og:image" content="/dashboard-preview.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Interactive dashboard and monitoring system with real-time performance metrics and analysis tools.">
    <meta name="keywords" content="dashboard, monitoring, performance, metrics, analytics, real-time, visualization">
    <meta property="og:title" content="Origin Dashboard - System Monitoring">
    <meta property="og:description" content="Real-time performance monitoring and analytics dashboard">
    <meta property="og:type" content="website">
    <meta property="og:image" content="/dashboard-preview.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Interactive dashboard and monitoring system with real-time performance metrics and analysis tools.">
    <meta name="keywords" content="dashboard, monitoring, performance, metrics, analytics, real-time, visualization">
    <meta property="og:title" content="Origin Dashboard - System Monitoring">
    <meta property="og:description" content="Real-time performance monitoring and analytics dashboard">
    <meta property="og:type" content="website">
    <meta property="og:image" content="/dashboard-preview.png">
    <title>Bun Feature Performance SLA Visualization</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 30px;
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .chart-container {
            position: relative;
            margin: 30px 0;
        }
        
        .bar {
            cursor: pointer;
            transition: opacity 0.3s ease;
        }
        
        .bar:hover {
            opacity: 0.8;
        }
        
        .optimization {
            fill: #27ae60;
        }
        
        .security {
            fill: #e74c3c;
        }
        
        .neutral {
            fill: #3498db;
        }
        
        .axis {
            font-size: 12px;
        }
        
        .axis-label {
            font-size: 14px;
            font-weight: bold;
        }
        
        .grid line {
            stroke: #e0e0e0;
            stroke-dasharray: 2,2;
        }
        
        .grid path {
            stroke-width: 0;
        }
        
        .tooltip {
            position: absolute;
            padding: 12px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            border-radius: 8px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }
        
        .tooltip.show {
            opacity: 1;
        }
        
        .tooltip-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #3498db;
        }
        
        .tooltip-row {
            margin: 4px 0;
            display: flex;
            justify-content: space-between;
            gap: 20px;
        }
        
        .tooltip-label {
            color: #ecf0f1;
        }
        
        .tooltip-value {
            font-weight: bold;
            text-align: right;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            background: #3498db;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #2980b9;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .stat-label {
            color: #7f8c8d;
            margin-top: 5px;
        }
    </style>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com; img-src 'self' data: https:; connect-src 'self' https:;">
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Origin Dashboard",
        "description": "Real-time performance monitoring and analytics dashboard",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Any"
    }
</script>
</head>
<body>
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-blue-600 text-white px-4 py-2 rounded">Skip to main content</a>
    <div class="container">
        <h1>ðŸ”Œ Bun Feature Performance SLA</h1>
        <p class="subtitle">13-Byte Config Performance Impact Analysis (Logarithmic Scale)</p>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="totalFeatures">14</div>
                <div class="stat-label">Total Features</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="optimizations">3</div>
                <div class="stat-label">Optimizations</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="securityOverhead">1</div>
                <div class="stat-label">Security Overhead</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="neutralChanges">10</div>
                <div class="stat-label">Neutral Changes</div>
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color optimization"></div>
                <span>Optimization (Faster)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color security"></div>
                <span>Security Overhead (Slower)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color neutral"></div>
                <span>Neutral Change</span>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="toggleScale()">Toggle Scale</button>
            <button class="btn" onclick="sortData()">Sort by Delta</button>
            <button class="btn" onclick="resetView()">Reset View</button>
        </div>
        
        <div class="chart-container">
            <svg id="chart"></svg>
        </div>
        
        <div class="tooltip" id="tooltip"></div>
    </div>

    <script>
        // Performance data from the feature integration analysis
        const performanceData = [
            {
                feature: "Bun.cookies",
                dependency: "terminal_mode (Byte 9)",
                baseCost: 450,
                activeCost: 450,
                delta: 0,
                memory: 0,
                type: "neutral"
            },
            {
                feature: "Bun.fetch",
                dependency: "registry_hash (Bytes 1-4)",
                baseCost: 15,
                activeCost: 135,
                delta: 120,
                memory: 64,
                type: "neutral"
            },
            {
                feature: "Bun.serve",
                dependency: "terminal_mode (Byte 9)",
                baseCost: 50000,
                activeCost: 50450,
                delta: 450,
                memory: 0,
                type: "neutral"
            },
            {
                feature: "Bun.file",
                dependency: "MOCK_S3 flag (Bit 9)",
                baseCost: 12,
                activeCost: 5,
                delta: -7,
                memory: 0,
                type: "optimization"
            },
            {
                feature: "Bun.write",
                dependency: "config.write (Bytes 4-16)",
                baseCost: 45,
                activeCost: 45,
                delta: 0,
                memory: 0,
                type: "neutral"
            },
            {
                feature: "Bun.env",
                dependency: "override (Bytes 0-11)",
                baseCost: 5,
                activeCost: 50,
                delta: 45,
                memory: 0,
                type: "neutral"
            },
            {
                feature: "Bun.dns",
                dependency: "registry_hash (Bytes 1-4)",
                baseCost: 50,
                activeCost: 50,
                delta: 0,
                memory: 128,
                type: "neutral"
            },
            {
                feature: "Bun.password",
                dependency: "DEBUG flag (Bit 2)",
                baseCost: 200,
                activeCost: 2000,
                delta: 1800,
                memory: 0,
                type: "security"
            },
            {
                feature: "Bun.jwt",
                dependency: "PREMIUM_TYPES flag (Bit 0)",
                baseCost: 500,
                activeCost: 150,
                delta: -350,
                memory: 0,
                type: "optimization"
            },
            {
                feature: "Bun.sql",
                dependency: "registry_hash (Bytes 1-4)",
                baseCost: 500,
                activeCost: 500,
                delta: 0,
                memory: 64,
                type: "neutral"
            },
            {
                feature: "Bun.s3",
                dependency: "MOCK_S3 flag (Bit 9)",
                baseCost: 5000,
                activeCost: 5,
                delta: -4995,
                memory: 0,
                type: "optimization"
            },
            {
                feature: "Bun.websocket",
                dependency: "terminal_mode (Byte 9)",
                baseCost: 1000,
                activeCost: 1450,
                delta: 450,
                memory: 0,
                type: "neutral"
            },
            {
                feature: "Bun.gc",
                dependency: "configVersion (Byte 0)",
                baseCost: 0,
                activeCost: 0,
                delta: 0,
                memory: 0,
                type: "neutral"
            },
            {
                feature: "Bun.Transpiler",
                dependency: "BETA_API flag (Bit 3)",
                baseCost: 150,
                activeCost: 150,
                delta: 0,
                memory: 0,
                type: "neutral"
            }
        ];

        let currentData = [...performanceData];
        let useLogScale = true;

        // Chart dimensions
        const margin = { top: 80, right: 120, bottom: 100, left: 80 };
        const width = 1100 - margin.left - margin.right;
        const height = 600 - margin.top - margin.bottom;

        // Create SVG
        const svg = d3.select("#chart")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom);

        const g = svg.append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        // Scales
        const xScale = d3.scaleBand()
            .range([0, width])
            .padding(0.1);

        const yScale = d3.scaleSymlog()
            .range([height, 0]);

        const colorScale = d3.scaleOrdinal()
            .domain(["optimization", "security", "neutral"])
            .range(["#27ae60", "#e74c3c", "#3498db"]);

        // Create tooltip
        const tooltip = d3.select("#tooltip");

        function updateChart() {
            // Update scales
            xScale.domain(currentData.map(d => d.feature));
            
            if (useLogScale) {
                yScale.domain([1, d3.max(currentData, d => Math.max(d.baseCost, d.activeCost)) * 2]);
            } else {
                yScale.domain([0, d3.max(currentData, d => Math.max(d.baseCost, d.activeCost)) * 1.1]);
            }

            // Clear previous elements
            g.selectAll("*").remove();

            // Add grid
            const yAxisGrid = d3.axisLeft(yScale)
                .tickSize(-width)
                .tickFormat("")
                .scale(useLogScale ? yScale : yScale.copy().range([height, 0]));

            g.append("g")
                .attr("class", "grid")
                .call(yAxisGrid);

            // Add bars
            const bars = g.selectAll(".bar-group")
                .data(currentData)
                .enter().append("g")
                .attr("class", "bar-group")
                .attr("transform", d => `translate(${xScale(d.feature)},0)`);

            // Base cost bars
            bars.append("rect")
                .attr("class", "bar base")
                .attr("x", 0)
                .attr("y", d => yScale(d.baseCost))
                .attr("width", xScale.bandwidth() / 2 - 2)
                .attr("height", d => Math.abs(yScale(d.baseCost) - yScale(0)))
                .attr("fill", "#95a5a6")
                .attr("opacity", 0.7);

            // Active cost bars
            bars.append("rect")
                .attr("class", "bar active")
                .attr("x", xScale.bandwidth() / 2 + 2)
                .attr("y", d => yScale(d.activeCost))
                .attr("width", xScale.bandwidth() / 2 - 2)
                .attr("height", d => Math.abs(yScale(d.activeCost) - yScale(0)))
                .attr("fill", d => colorScale(d.type))
                .on("mouseover", function(event, d) {
                    showTooltip(event, d);
                })
                .on("mouseout", hideTooltip);

            // X axis
            g.append("g")
                .attr("class", "axis")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(xScale))
                .selectAll("text")
                .style("text-anchor", "end")
                .attr("dx", "-.8em")
                .attr("dy", ".15em")
                .attr("transform", "rotate(-45)");

            // Y axis
            const yAxis = d3.axisLeft(yScale)
                .tickFormat(d => {
                    if (d >= 1000000) return (d / 1000000).toFixed(1) + "M";
                    if (d >= 1000) return (d / 1000).toFixed(0) + "K";
                    return d.toString();
                });

            g.append("g")
                .attr("class", "axis")
                .call(yAxis);

            // Axis labels
            g.append("text")
                .attr("class", "axis-label")
                .attr("transform", "rotate(-90)")
                .attr("y", 0 - margin.left)
                .attr("x", 0 - (height / 2))
                .attr("dy", "1em")
                .style("text-anchor", "middle")
                .text("Execution Time (nanoseconds)");

            g.append("text")
                .attr("class", "axis-label")
                .attr("transform", `translate(${width / 2}, ${height + margin.bottom - 10})`)
                .style("text-anchor", "middle")
                .text("Bun API Features");

            // Title
            g.append("text")
                .attr("x", width / 2)
                .attr("y", -30)
                .attr("text-anchor", "middle")
                .style("font-size", "18px")
                .style("font-weight", "bold")
                .text(`Performance Impact (${useLogScale ? 'Logarithmic' : 'Linear'} Scale)`);
        }

        function showTooltip(event, data) {
            const formatNumber = (num) => {
                if (num >= 1000000) return (num / 1000000).toFixed(2) + "M ns";
                if (num >= 1000) return (num / 1000).toFixed(0) + "K ns";
                return num + " ns";
            };

            const deltaPercent = data.baseCost > 0 ? ((data.delta / data.baseCost) * 100).toFixed(1) : "N/A";
            const deltaSign = data.delta >= 0 ? "+" : "";

            tooltip.html(`
                <div class="tooltip-title">${data.feature}</div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Dependency:</span>
                    <span class="tooltip-value">${data.dependency}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Base Cost:</span>
                    <span class="tooltip-value">${formatNumber(data.baseCost)}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Active Cost:</span>
                    <span class="tooltip-value">${formatNumber(data.activeCost)}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Delta:</span>
                    <span class="tooltip-value" style="color: ${data.delta > 0 ? '#e74c3c' : '#27ae60'}">
                        ${deltaSign}${formatNumber(data.delta)} (${deltaSign}${deltaPercent}%)
                    </span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Memory:</span>
                    <span class="tooltip-value">${data.memory > 0 ? data.memory + 'B' : '0B'}</span>
                </div>
                <div class="tooltip-row">
                    <span class="tooltip-label">Type:</span>
                    <span class="tooltip-value" style="color: ${colorScale(data.type)}">
                        ${data.type.charAt(0).toUpperCase() + data.type.slice(1)}
                    </span>
                </div>
            `)
            .style("left", (event.pageX + 10) + "px")
            .style("top", (event.pageY - 10) + "px")
            .classed("show", true);
        }

        function hideTooltip() {
            tooltip.classed("show", false);
        }

        function toggleScale() {
            useLogScale = !useLogScale;
            updateChart();
        }

        function sortData() {
            currentData.sort((a, b) => b.delta - a.delta);
            updateChart();
        }

        function resetView() {
            currentData = [...performanceData];
            useLogScale = true;
            updateChart();
        }

        // Update statistics
        function updateStats() {
            const optimizations = performanceData.filter(d => d.type === "optimization").length;
            const security = performanceData.filter(d => d.type === "security").length;
            const neutral = performanceData.filter(d => d.type === "neutral").length;

            document.getElementById("optimizations").textContent = optimizations;
            document.getElementById("securityOverhead").textContent = security;
            document.getElementById("neutralChanges").textContent = neutral;
        }

        // Initialize chart
        updateChart();
        updateStats();
    </script>
</body>
</html>
