# Authentication & Session Management - Implementation Guide

**Version**: 10.1.0.0.0.0  
**Component**: Implementation Examples  
**Status**: ✅ Ready

---

## Quick Start

### Basic Usage Example

```typescript
import { AuthService } from './src/services/auth-service';
import { SessionService } from './src/services/session-service';
import { CSRFService } from './src/services/csrf-service';

// In your Bun.serve() handler
export default {
  async fetch(req: Request): Promise<Response> {
    const cookies = req.cookies; // Automatically Bun.CookieMap
    
    // Login
    if (req.url.endsWith('/login') && req.method === 'POST') {
      const authService = new AuthService();
      const body = await req.json();
      return await authService.handleLogin(
        req,
        cookies,
        body.username,
        body.password
      );
    }
    
    // Protected route
    if (req.url.endsWith('/protected')) {
      if (!SessionService.validateSession(cookies)) {
        return new Response('Unauthorized', { status: 401 });
      }
      
      const csrfToken = req.headers.get('X-CSRF-Token');
      if (!CSRFService.validateToken(cookies, csrfToken)) {
        return new Response('Invalid CSRF token', { status: 403 });
      }
      
      return new Response('Protected content');
    }
    
    return new Response('Not Found', { status: 404 });
  }
};
```

---

## File Structure

```text
src/
├── constants/
│   └── cookie-expiration.ts      # Cookie expiration constants
├── types/
│   └── cookie-policy.ts          # Secure cookie type definitions
├── utils/
│   ├── cookie-policy.ts          # Cookie security policies
│   └── cookie-parser.ts          # Manual cookie parsing utilities
├── services/
│   ├── auth-service.ts           # Authentication service
│   ├── session-service.ts        # Session management service
│   └── csrf-service.ts           # CSRF protection service
└── api/
    ├── auth-handler.ts           # Example auth API handler
    └── ui-preferences.ts         # UI preference management
```

---

## Testing

Run cookie security tests:

```bash
bun test test/auth/cookie-security.test.ts
```

---

## Environment Variables

Set in `.env` or `Bun.secrets`:

```bash
SESSION_SECRET=your-secret-key-here
```

---

## Cross-References

- **10.0.0.0.0.0.0**: Main documentation
- **9.1.1.1.1.1.0**: Bun.secrets management
- **4.0.0.0.0.0.0**: MCP & Alerting (dashboard integration)
