# Design System & Theming Subsystem (17.0.0.0.0.0.0)

**Version**: 17.0.0.0.0.0.0  
**Purpose**: Deterministic, cross-medium information radiance  
**Philosophy**: Zero context switch cost from terminal to dashboard  
**Status**: ‚úÖ Integrated  
**Last Updated**: 2024-12-07

---

## üéØ Core Philosophy

**"Tmux is the OS, CSS is the GUI standard."**

Hyper-Bun treats development experience (devex) and design systems as **one coherent continuity** ‚Äî a unified nervous system from keypress ‚Üí token ‚Üí photon ‚Üí decision ‚Üí keypress.

### The Closed-Loop Perception Pipeline

**Deterministic, cross-medium information radiance**: The same semantic token that triggers log color in the terminal is the exact same token driving the alert UI in the dashboard.

**Zero context switch cost**: Engineers never leave their Tmux session. They never lose context. They never wonder "wait, what shade of red means what again?"

---

## üîÑ Lived Workflow: The Closed-Loop Pipeline

### Scenario: Latency Spike Detection (HBMO-017)

#### Step 1: Trigger ‚Üí Operational Telemetry

**Context**: Engineer working in `mlgs-monitoring` session

**Event**: Something breaks or an alpha signal appears

**Terminal Output** (Tmux Logs pane):
```
[WARN] HBMO-017 | ConcealedArbEngine | latency_spike_detected > 180ms
```

**Semantic Token**: `--color-risk-critical` (or `--color-semantic-warn-fg`)

**Visual**: Red/yellow text in terminal using xterm-256color `colour220` or `colour196`

---

#### Step 2: Immediate Reflex ‚Üí Context Preservation

**Action**: Engineer hits `Ctrl-Space ,` (or `Ctrl-Space n`) ‚Üí switches to pre-focused "Analytics" pane

**Context**: Analytics pane already running:
- `w3m http://localhost:8080/analytics.html` (text browser)
- OR `lynx` (terminal browser)
- OR Chrome tab (never closed, always open)

**Key Point**: **Zero context switch** ‚Äî engineer never leaves Tmux session

---

#### Step 3: Instant Visual Correlation ‚Üí Deterministic Radiance

**Dashboard Display**: The dashboard instantly surfaces:

1. **Flashing Alert Card**:
   ```css
   background: light-dark(#ffebee, #421c1c);
   border-left: 6px solid var(--color-risk-critical);
   ```

2. **Event ID Highlighting**:
   ```css
   /* HBMO-017 event ID highlighted */
   color: var(--color-semantic-warn-fg);
   ```

3. **Real-Time Latency Sparkline**:
   ```css
   /* Latency visualization */
   stroke: var(--color-accent-electric);
   /* Dark mode optimized */
   ```

4. **Typography Alignment**:
   ```css
   font-feature-settings: "zero" 1, "tnum" 1;
   /* Numbers align perfectly even when Tmux pane resized to 38 columns */
   ```

**Semantic Token**: **Same token** (`--color-risk-critical`) used in:
- Terminal log color
- Dashboard alert border
- Event ID highlighting
- Latency visualization

**Result**: Engineer sees **exact same semantic meaning** across terminal ‚Üí dashboard ‚Üí visualization

---

## üé® Design System Components

### 17.1.0.0.0.0: Color System & Semantic Color Patterns

**Purpose**: Deterministic color tokens that work across terminal, dashboard, and logs.

**Core Principle**: One semantic token ‚Üí One meaning ‚Üí All media

**Semantic Tokens**:
```css
:root {
  /* Risk/Severity Colors */
  --color-risk-critical: #ef4444;      /* Terminal: colour196 */
  --color-risk-warning: #f59e0b;       /* Terminal: colour220 */
  --color-risk-info: #00d4ff;          /* Terminal: colour51 */
  
  /* Semantic Foreground Colors */
  --color-semantic-warn-fg: #f59e0b;   /* Matches terminal warning */
  --color-semantic-error-fg: #ef4444;  /* Matches terminal error */
  --color-semantic-success-fg: #10b981; /* Matches terminal success */
  
  /* Accent Colors */
  --color-accent-electric: #00d4ff;    /* Latency sparklines, active states */
  --color-accent-purple: #667eea;      /* Analytics, dashboard */
  --color-accent-green: #10b981;       /* Success, active */
}
```

**Terminal Mapping**:
```tmux
# Same semantic tokens in terminal
#[fg=colour196]ERR:#{error_count}     ‚Üí --color-risk-critical
#[fg=colour220]WARN:#{warn_count}     ‚Üí --color-risk-warning
#[fg=colour51]INFO:#{info_count}      ‚Üí --color-risk-info
```

**Cross-Medium Consistency**:
- Terminal log: `[WARN]` ‚Üí Yellow (`colour220`)
- Dashboard alert: `border-left: 6px solid var(--color-risk-warning)`
- **Same semantic meaning, same visual language**

---

### 17.2.0.0.0.0: Theming (Light/Dark Mode)

**Purpose**: Automatic theme adaptation matching system preferences.

**Implementation**: `light-dark()` function for seamless theme switching

**Example**:
```css
.alert-card {
  background: light-dark(#ffebee, #421c1c);
  /* Light mode: Light red background */
  /* Dark mode: Dark red background */
  /* Matches terminal dark theme by default */
}
```

**Terminal Integration**: Tmux uses dark theme (`colour234` background) ‚Üí Dashboard automatically uses dark theme ‚Üí **Zero visual jarring**

---

### 17.3.0.0.0.0: Typography System

**Purpose**: Perfect number alignment and readability across all contexts.

**Key Feature**: Tabular numbers for alignment

```css
.metric-value {
  font-feature-settings: "zero" 1, "tnum" 1;
  /* Zero: Slashed zero for distinction */
  /* Tnum: Tabular numbers for perfect alignment */
}
```

**Use Case**: When Tmux pane resized to 38 columns, numbers still align perfectly in dashboard

**Terminal Integration**: Terminal uses monospace ‚Üí Dashboard uses `JetBrains Mono` ‚Üí **Consistent typography**

---

### 17.4.0.0.0.0: Spacing & Layout System

**Purpose**: Responsive layouts that work in terminal browsers and full browsers.

**Terminal Browser Support**:
- `w3m` (text browser) - Works with CSS grid
- `lynx` (terminal browser) - Graceful degradation
- Chrome/Firefox - Full feature support

**Layout Pattern**:
```css
.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  /* Adapts to terminal width */
  /* Full browser: 4 columns */
  /* Terminal: Graceful degradation */
}
```

---

### 17.5.0.0.0.0: Component Patterns & CSS Modules

**Purpose**: Consistent component styling across all dashboard views.

**Pattern**: Component-specific CSS modules with semantic color tokens

**Example**: `CovertSteamEventRecordCard`
```css
.covert-steam-card {
  background: var(--secondary-bg);
  border-left: 6px solid var(--color-risk-critical);
  /* Uses semantic token */
  /* Matches terminal log severity color */
}
```

---

### 17.0.1.0.0.0.0: Dashboard Manifest Integration

**Purpose**: Web App Manifest integration ensuring PWA theming aligns with Design System.

**File**: `dashboard/manifest.json`

**Key Features**:
- Design System color tokens (`_design_system`)
- Terminal Environment integration (`_terminal_integration`)
- Closed-loop pipeline metadata (`closed_loop_pipeline`)
- Philosophy documentation (`_philosophy`)

**Color Alignment**:
- `background_color: #1a1a1a` ‚Üí Matches `--bg-primary`
- `theme_color: #667eea` ‚Üí Matches `--accent-purple`
- Semantic colors match CSS tokens

**Terminal Integration**:
- Documents tmux session access patterns
- Specifies terminal browser support (w3m, lynx)
- Ensures zero context switch cost

**See**: `docs/17.0.0.0.0.0.0-DASHBOARD-MANIFEST.md` for complete documentation

---

### 17.0.2.0.0.0.0: Registry Browser Integration

**Purpose**: Registry browser integration with Design System and Terminal Environment.

**File**: `public/registry.html`, `public/manifest.json`

**Key Features**:
- Visual registry browser with semantic color coding
- Status indicators matching terminal log colors
- Category colors aligned with design system
- HTMLRewriter UI context injection
- Terminal browser support (w3m, lynx)

**Color Alignment**:
- Inline styles use design system colors
- Status indicators: Healthy=Green, Degraded=Yellow, Offline=Red
- Category colors match department colors
- Theme color matches `--accent-purple`

**Terminal Integration**:
- Accessible from all tmux sessions
- Zero context switch workflow
- Terminal command ‚Üí Registry browser ‚Üí API endpoint

**See**: `docs/17.0.0.0.0.0.0-REGISTRY-BROWSER-INTEGRATION.md` for complete documentation

---

## üîó Integration with Terminal Environment (11.4.x)

### Module-Specific Color Coding

**Core Development** (`mlgs-core`):
- Terminal: Cyan theme (`colour51`)
- Dashboard: `--color-accent-electric: #00d4ff`
- **Connection**: Same cyan for API/development context

**Analytics** (`mlgs-analytics`):
- Terminal: Purple theme (`colour99`)
- Dashboard: `--color-accent-purple: #667eea`
- **Connection**: Same purple for analytics context

**Research** (`mlgs-research`):
- Terminal: Purple theme (`colour93`)
- Dashboard: Purple variants
- **Connection**: Same purple family for research context

**Monitoring** (`mlgs-monitoring`):
- Terminal: Orange theme (`colour166`)
- Dashboard: `--color-risk-warning: #f59e0b`
- **Connection**: Same orange for monitoring/security context

---

## üìä Real-World Examples

### Example 1: Error Detection Flow

**Terminal** (Tmux Logs pane):
```
[ERROR] HBMO-002 | MarketOfferingService | Required server configuration missing.
```
- Color: `colour196` (#ff0000)
- Semantic: `--color-risk-critical`

**Dashboard** (Analytics pane):
```css
.alert-card.critical {
  border-left: 6px solid var(--color-risk-critical);  /* Same token */
  background: light-dark(#ffebee, #421c1c);
}
```
- Visual: Red border, flashing animation
- Semantic: **Same meaning** as terminal error

**Result**: Engineer sees red ‚Üí understands critical ‚Üí takes action ‚Üí **Zero context switch**

---

### Example 2: Latency Spike Visualization

**Terminal** (Console output):
```
latency_spike_detected > 180ms
```
- Color: Yellow (`colour220`)
- Semantic: `--color-risk-warning`

**Dashboard** (Sparkline):
```css
.latency-sparkline {
  stroke: var(--color-accent-electric);  /* Cyan for active */
  fill: var(--color-risk-warning);        /* Yellow for spike */
}
```
- Visual: Cyan line with yellow spike
- Semantic: **Same warning meaning** as terminal

**Result**: Engineer sees yellow spike ‚Üí understands warning ‚Üí checks latency ‚Üí **Instant correlation**

---

### Example 3: Shadow Graph Node States

**Terminal** (Research console):
```typescript
const node = await shadowGraph.getNode('NFL-20241206-1234');
console.log(node.visibility);  // 'DISPLAY' | 'API_ONLY' | 'DARK'
```

**Dashboard** (Visualization):
```css
.propagation-node.active {
  border-color: var(--color-accent-green);  /* DISPLAY = green */
}

.propagation-node.api-only {
  border-color: var(--color-accent-electric);  /* API_ONLY = cyan */
}

.propagation-node.dark {
  border-color: var(--color-risk-critical);  /* DARK = red */
}
```
- Visual: Color-coded nodes
- Semantic: **Same state meanings** as terminal

**Result**: Engineer sees graph ‚Üí understands node states ‚Üí **Visual matches data**

---

## üéØ Design Principles

### 1. **Deterministic Radiance**
Same semantic token ‚Üí Same meaning ‚Üí All media (terminal, dashboard, logs)

### 2. **Zero Context Switch**
Engineer never leaves Tmux session ‚Üí Dashboard accessible from terminal ‚Üí Seamless workflow

### 3. **Perceptual Clarity**
Every photon hitting retina carries maximum signal ‚Üí Colors convey meaning ‚Üí Typography ensures readability

### 4. **Cross-Medium Consistency**
Terminal colors match dashboard colors ‚Üí Same semantic language ‚Üí Reduced cognitive load

### 5. **Unified Nervous System**
Keypress ‚Üí Token ‚Üí Photon ‚Üí Decision ‚Üí Keypress ‚Üí **One coherent system**

---

## üìã Implementation Checklist

### Phase 1: Semantic Token System ‚úÖ
- [x] Define semantic color tokens
- [x] Map terminal colors to CSS variables
- [x] Document cross-medium consistency

### Phase 2: Component Integration ‚úÖ
- [x] Integrate tokens in dashboard components
- [x] Ensure terminal ‚Üí dashboard color matching
- [x] Test in terminal browsers (w3m, lynx)

### Phase 3: Typography System ‚úÖ
- [x] Implement tabular numbers
- [x] Ensure alignment in narrow terminals
- [x] Match terminal monospace fonts

### Phase 4: Theme Support ‚úÖ
- [x] Implement `light-dark()` function
- [x] Match terminal dark theme
- [x] Test theme switching

---

## üîç Ripgrep Patterns

```bash
# Find semantic color tokens
rg "--color-risk-|--color-semantic-|--color-accent-" styles/*.css

# Find terminal color mappings
rg "colour196|colour220|colour51" config/.tmux.conf scripts/*.sh

# Find component usage
rg "CovertSteam|ShadowGraph|CorrelationCard" styles/*.css dashboard/*.html

# Find theme functions
rg "light-dark" styles/*.css
```

---

## üìö Related Documentation

- `docs/17.0.0.0.0.0.0-CLOSED-LOOP-WORKFLOW.md` - Lived workflow documentation
- `docs/17.0.0.0.0.0.0-DASHBOARD-MANIFEST.md` - Dashboard manifest integration (17.0.1.0.0.0.0)
- `docs/17.0.0.0.0.0.0-REGISTRY-BROWSER-INTEGRATION.md` - Registry browser integration (17.0.2.0.0.0.0)
- `docs/17.0.0.0.0.0.0-VERSIONING-INTEGRATION.md` - Versioning system integration (17.0.3.0.0.0.0)
- `docs/11.4.6-TMUX-CSS-ECOSYSTEM-INTEGRATION.md` - Ecosystem integration guide
- `commands/VERSIONING.md` - CLI Commands versioning system
- `docs/11.4.5-COLOR-PATTERNS-INTEGRATION.md` - Color pattern integration
- `styles/dashboard.css` - Dashboard color definitions
- `styles/golden-template.css` - Modern CSS patterns
- `config/.tmux.conf` - Terminal color configuration
- `dashboard/manifest.json` - Web App Manifest with design system integration

---

**Version**: 17.0.0.0.0.0.0  
**Status**: ‚úÖ Integrated  
**Philosophy**: **"There is no leap. It's one coherent nervous system."**
