<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced URLPattern Routing Dashboard | Advanced API Visualization</title>
    <meta name="description" content="Interactive dashboard for URLPattern routing system with real-time monitoring, API testing, and comprehensive middleware visualization">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
    <style>
        @keyframes pulse-border {
            0%, 100% { border-color: rgb(59 130 246 / 0.5); }
            50% { border-color: rgb(59 130 246 / 1); }
        }
        .animate-pulse-border {
            animation: pulse-border 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        .gradient-text {
            background: linear-gradient(135deg, #3b82f6 0%, #3b82f6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .code-block {
            background: linear-gradient(135deg, #3b82f6 0%, #3b82f6 100%);
            border-left: 4px solid #3b82f6;
        }
        .metric-card {
            background: linear-gradient(135deg, #3b82f6 0%, #3b82f6 100%);
            border: 1px solid #3b82f6;
            transition: all 0.3s ease;
        }
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .status-online { background-color: #10b981; }
        .status-warning { background-color: #f59e0b; }
        .status-error { background-color: #ef4444; }
        .route-card {
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }
        .route-card:hover {
            border-left-color: #3b82f6;
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.05) 0%, transparent 100%);
        }
        .tab-active {
            border-bottom: 2px solid #3b82f6;
            color: #3b82f6;
        }
        .alert-critical { border-left: 4px solid #ef4444; }
        .alert-warning { border-left: 4px solid #f59e0b; }
        .alert-info { border-left: 4px solid #3b82f6; }
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        .pulse-dot {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
            }
        }
        .gradient-bg {
            background: linear-gradient(135deg, #3b82f6 0%, #3b82f6 100%);
        }
        .server-log {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
        }
        .neon-glow {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }
        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
        }
        .loading-skeleton {
            background: linear-gradient(90deg, #3b82f6 25%, #3b82f6 50%, #3b82f6 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        .dark {
            background-color: #3b82f6;
            color: #3b82f6;
        }
        .dark .bg-white {
            background-color: #3b82f6 !important;
        }
        .dark .bg-gray-50 {
            background-color: #3b82f6 !important;
        }
        .dark .text-gray-900 {
            color: #3b82f6 !important;
        }
        .dark .text-gray-600 {
            color: #3b82f6 !important;
        }
        .dark .border-gray-200 {
            border-color: #3b82f6 !important;
        }
        .heatmap-cell {
            transition: all 0.3s ease;
        }
        .heatmap-cell:hover {
            transform: scale(1.1);
            z-index: 10;
        }
        .progress-ring {
            transform: rotate(-90deg);
        }
        .floating-action {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .shimmer {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        /* SCOPE Badge Styles */
        .scope-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 9999px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .scope-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .scope-badge.enterprise {
            background: linear-gradient(135deg, #3b82f6 0%, #f59e0b 100%);
            color: #3b82f6;
            border-color: rgba(251, 191, 36, 0.3);
        }
        
        .scope-badge.production {
            background: linear-gradient(135deg, #3b82f6 0%, #10b981 100%);
            color: #3b82f6;
            border-color: rgba(52, 211, 153, 0.3);
        }
        
        .scope-badge.multi-tenant {
            background: linear-gradient(135deg, #3b82f6 0%, #3b82f6 100%);
            color: #3b82f6;
            border-color: rgba(96, 165, 250, 0.3);
        }
        
        .context-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.125rem 0.5rem;
            font-size: 0.625rem;
            font-weight: 500;
            border-radius: 9999px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .context-badge:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .context-badge.routing-enabled {
            background: linear-gradient(135deg, #8b5cf6 0%, #3b82f6 100%);
            color: #3b82f6;
            border-color: rgba(139, 92, 246, 0.3);
        }
        
        .context-badge.middleware-active {
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
            color: #3b82f6;
            border-color: rgba(6, 182, 212, 0.3);
        }
        
        /* Inspection Panel Styles */
        .inspection-panel {
            position: fixed;
            top: 0;
            right: -100vw;
            width: 100vw;
            max-width: 500px;
            height: 100vh;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
        }
        
        .inspection-panel.open {
            right: 0;
        }
        
        .inspection-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: between;
            align-items: center;
        }
        
        .inspection-content {
            padding: 1.5rem;
        }
        
        .inspection-section {
            margin-bottom: 2rem;
        }
        
        .inspection-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: #3b82f6;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .inspection-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid #3b82f6;
        }
        
        .inspection-label {
            font-size: 0.875rem;
            color: #3b82f6;
        }
        
        .inspection-value {
            font-size: 0.875rem;
            font-weight: 500;
            color: #3b82f6;
        }
        
        .inspection-toggle {
            position: fixed;
            top: 120px;
            right: 20px;
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 999;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .inspection-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        
        /* Dark Mode Styles */
        .dark {
            background-color: #3b82f6;
            color: #3b82f6;
        }
        
        .dark .bg-white {
            background-color: #3b82f6 !important;
        }
        
        .dark .bg-gray-50 {
            background-color: #3b82f6 !important;
        }
        
        .dark .text-gray-900 {
            color: #3b82f6 !important;
        }
        
        .dark .text-gray-600 {
            color: #3b82f6 !important;
        }
        
        .dark .border-gray-200 {
            border-color: #3b82f6 !important;
        }
        
        .dark .inspection-panel {
            background: rgba(15, 23, 42, 0.95) !important;
            border-color: rgba(71, 85, 105, 0.3) !important;
        }
        
        .dark .inspection-toggle {
            background: rgba(30, 41, 59, 0.9) !important;
            border-color: rgba(71, 85, 105, 0.3) !important;
        }
        
        .dark .inspection-toggle:hover {
            background: rgba(51, 65, 85, 0.9) !important;
        }
        
        /* Theme transition */
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <i data-lucide="network" class="w-8 h-8 text-blue-600"></i>
                    <h1 class="text-2xl font-bold gradient-text">URLPattern Routing Dashboard</h1>
                    
                    <!-- SCOPE Badges -->
                    <div class="flex items-center space-x-2 ml-6">
                        <span class="scope-badge enterprise" onclick="scopeManager.showBadgeInfo('enterprise')" title="Enterprise Tier: Premium features, priority support, advanced analytics">
                            <i data-lucide="crown" class="w-3 h-3 mr-1"></i>
                            ENTERPRISE
                        </span>
                        <span class="scope-badge production" onclick="scopeManager.showBadgeInfo('production')" title="Production Environment: Live deployment with full monitoring">
                            <i data-lucide="server" class="w-3 h-3 mr-1"></i>
                            PRODUCTION
                        </span>
                        <span class="scope-badge multi-tenant" onclick="scopeManager.showBadgeInfo('multi-tenant')" title="Multi-Tenant Architecture: Shared infrastructure with isolated data">
                            <i data-lucide="layers" class="w-3 h-3 mr-1"></i>
                            MULTI-TENANT
                        </span>
                        
                        <!-- Context Badges -->
                        <div style="border-left: 1px solid rgba(255, 255, 255, 0.2); height: 16px; margin: 0 0.5rem;"></div>
                        
                        <span class="context-badge routing-enabled" onclick="scopeManager.showBadgeInfo('routing')" title="Advanced URLPattern Routing: Dynamic route matching and middleware">
                            <i data-lucide="git-branch" class="w-3 h-3 mr-1"></i>
                            URLPattern v2.0
                        </span>
                        <span class="context-badge middleware-active" onclick="scopeManager.showBadgeInfo('middleware')" title="7-Layer Middleware Stack: Comprehensive request processing">
                            <i data-lucide="shield" class="w-3 h-3 mr-1"></i>
                            7-Layer Stack
                        </span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <span class="status-indicator status-online pulse-dot"></span>
                        <span class="text-sm text-gray-600">Server Online</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm">
                        <i data-lucide="clock" class="w-4 h-4 text-gray-400"></i>
                        <span id="server-time" class="text-gray-600">--:--:--</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm">
                        <i data-lucide="zap" class="w-4 h-4 text-green-500"></i>
                        <span id="response-time" class="text-gray-600">45ms</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm">
                        <i data-lucide="cpu" class="w-4 h-4 text-purple-500"></i>
                        <span id="cpu-usage" class="text-gray-600">12%</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm">
                        <i data-lucide="database" class="w-4 h-4 text-orange-500"></i>
                        <span id="memory-usage" class="text-gray-600">256MB</span>
                    </div>
                    <button onclick="toggleNotifications()" class="relative p-2 rounded-lg hover:bg-gray-100" title="Notifications">
                        <i data-lucide="bell" class="w-5 h-5"></i>
                        <span id="notification-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">3</span>
                    </button>
                    <button onclick="toggleFullscreen()" class="p-2 rounded-lg hover:bg-gray-100" title="Toggle Fullscreen">
                        <i data-lucide="maximize" class="w-5 h-5"></i>
                    </button>
                    <button onclick="toggleTheme()" class="p-2 rounded-lg hover:bg-gray-100" title="Toggle Theme">
                        <i data-lucide="moon" class="w-5 h-5"></i>
                    </button>
                    <button onclick="exportData()" class="p-2 rounded-lg hover:bg-gray-100" title="Export Data">
                        <i data-lucide="download" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Inspection Toggle Button -->
    <div class="inspection-toggle" onclick="scopeManager.toggleInspection()" title="Open Scope Inspection Panel">
        <i data-lucide="settings" class="w-5 h-5 text-blue-600"></i>
    </div>

    <!-- Inspection Panel -->
    <div id="inspectionPanel" class="inspection-panel">
        <div class="inspection-header">
            <h3 style="font-size: 1.125rem; font-weight: 600; color: #3b82f6; margin: 0;">
                <i data-lucide="search" class="w-5 h-5 mr-2 inline"></i>
                Routing Scope Inspection
            </h3>
            <button onclick="scopeManager.toggleInspection()" style="background: none; border: none; color: #3b82f6; cursor: pointer; padding: 0.5rem;">
                <i data-lucide="x" class="w-5 h-5"></i>
            </button>
        </div>
        
        <div class="inspection-content">
            <!-- Current Scope Configuration -->
            <div class="inspection-section">
                <div class="inspection-title">Current Configuration</div>
                <div class="inspection-item">
                    <span class="inspection-label">Service Tier</span>
                    <span class="inspection-value" id="currentTier">Enterprise</span>
                </div>
                <div class="inspection-item">
                    <span class="inspection-label">Environment</span>
                    <span class="inspection-value" id="currentEnvironment">Production</span>
                </div>
                <div class="inspection-item">
                    <span class="inspection-label">Architecture</span>
                    <span class="inspection-value" id="currentArchitecture">Multi-Tenant</span>
                </div>
                <div class="inspection-item">
                    <span class="inspection-label">URLPattern Version</span>
                    <span class="inspection-value" id="currentVersion">v2.0</span>
                </div>
                <div class="inspection-item">
                    <span class="inspection-label">Middleware Stack</span>
                    <span class="inspection-value" id="currentMiddleware">7-Layer</span>
                </div>
            </div>
            
            <!-- Feature Status -->
            <div class="inspection-section">
                <div class="inspection-title">Feature Status</div>
                <div class="inspection-item">
                    <span class="inspection-label">Dynamic Routing</span>
                    <span class="inspection-value">
                        <button onclick="scopeManager.toggleFeature('routing')" class="px-2 py-1 bg-green-100 text-green-800 rounded text-xs">Enabled</button>
                    </span>
                </div>
                <div class="inspection-item">
                    <span class="inspection-label">Middleware Processing</span>
                    <span class="inspection-value">
                        <button onclick="scopeManager.toggleFeature('middleware')" class="px-2 py-1 bg-green-100 text-green-800 rounded text-xs">Active</button>
                    </span>
                </div>
                <div class="inspection-item">
                    <span class="inspection-label">Route Caching</span>
                    <span class="inspection-value">
                        <button onclick="scopeManager.toggleFeature('caching')" class="px-2 py-1 bg-green-100 text-green-800 rounded text-xs">Enabled</button>
                    </span>
                </div>
                <div class="inspection-item">
                    <span class="inspection-label">Security Scanning</span>
                    <span class="inspection-value">
                        <button onclick="scopeManager.toggleFeature('security')" class="px-2 py-1 bg-green-100 text-green-800 rounded text-xs">Active</button>
                    </span>
                </div>
            </div>
            
            <!-- Controls -->
            <div class="inspection-section">
                <div class="inspection-title">Controls</div>
                <div class="space-y-3">
                    <button onclick="scopeManager.switchEnvironment()" class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
                        <i data-lucide="refresh-cw" class="w-4 h-4 inline mr-2"></i>
                        Switch Environment
                    </button>
                    <button onclick="scopeManager.changeTier()" class="w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition">
                        <i data-lucide="crown" class="w-4 h-4 inline mr-2"></i>
                        Change Service Tier
                    </button>
                    <button onclick="scopeManager.resetScope()" class="w-full px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition">
                        <i data-lucide="rotate-ccw" class="w-4 h-4 inline mr-2"></i>
                        Reset Configuration
                    </button>
                </div>
            </div>
            
            <!-- System Information -->
            <div class="inspection-section">
                <div class="inspection-title">System Information</div>
                <div class="inspection-item">
                    <span class="inspection-label">Session ID</span>
                    <span class="inspection-value" style="font-family: monospace; font-size: 0.75rem;">ROUTE-<span id="sessionId">123456789</span></span>
                </div>
                <div class="inspection-item">
                    <span class="inspection-label">Last Updated</span>
                    <span class="inspection-value" id="lastUpdated">Just now</span>
                </div>
                <div class="inspection-item">
                    <span class="inspection-label">Version</span>
                    <span class="inspection-value">v3.7.0</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Server Status & Metrics -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="metric-card p-6 rounded-lg">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Total Routes</p>
                        <p class="text-2xl font-bold text-gray-900">45+</p>
                        <p class="text-xs text-green-600 mt-1">+2 this week</p>
                    </div>
                    <i data-lucide="route" class="w-8 h-8 text-blue-500"></i>
                </div>
            </div>
            <div class="metric-card p-6 rounded-lg">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Middleware Layers</p>
                        <p class="text-2xl font-bold text-gray-900">7</p>
                        <p class="text-xs text-green-600 mt-1">All active</p>
                    </div>
                    <i data-lucide="layers" class="w-8 h-8 text-purple-500"></i>
                </div>
            </div>
            <div class="metric-card p-6 rounded-lg">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Response Time</p>
                        <p class="text-2xl font-bold text-gray-900">45ms</p>
                        <p class="text-xs text-green-600 mt-1">-5ms vs avg</p>
                    </div>
                    <i data-lucide="zap" class="w-8 h-8 text-green-500"></i>
                </div>
            </div>
            <div class="metric-card p-6 rounded-lg">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Uptime</p>
                        <p class="text-2xl font-bold text-gray-900">99.8%</p>
                        <p class="text-xs text-green-600 mt-1">30 days</p>
                    </div>
                    <i data-lucide="activity" class="w-8 h-8 text-emerald-500"></i>
                </div>
            </div>
        </div>

        <!-- Real-time Performance Chart -->
        <div class="bg-white rounded-lg shadow-sm p-6 mb-8">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-900">Real-time Performance</h3>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <span class="w-3 h-3 bg-blue-500 rounded-full"></span>
                        <span class="text-sm text-gray-600">Response Time</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                        <span class="text-sm text-gray-600">Request Rate</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="w-3 h-3 bg-purple-500 rounded-full"></span>
                        <span class="text-sm text-gray-600">CPU Usage</span>
                    </div>
                    <button onclick="toggleChartType()" class="px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200">
                        <i data-lucide="bar-chart-3" class="w-4 h-4 inline mr-1"></i>
                        Toggle View
                    </button>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="performanceChart"></canvas>
            </div>
        </div>

        <!-- Advanced Metrics Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg border border-blue-200">
                <div class="flex items-center justify-between mb-4">
                    <i data-lucide="trending-up" class="w-8 h-8 text-blue-600"></i>
                    <span class="text-xs bg-blue-600 text-white px-2 py-1 rounded-full">Live</span>
                </div>
                <h4 class="text-sm font-medium text-blue-900 mb-1">Success Rate</h4>
                <p class="text-2xl font-bold text-blue-900">99.8%</p>
                <p class="text-xs text-blue-700 mt-2">↑ 0.2% from last hour</p>
            </div>
            
            <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg border border-green-200">
                <div class="flex items-center justify-between mb-4">
                    <i data-lucide="users" class="w-8 h-8 text-green-600"></i>
                    <span class="text-xs bg-green-600 text-white px-2 py-1 rounded-full">Active</span>
                </div>
                <h4 class="text-sm font-medium text-green-900 mb-1">Active Users</h4>
                <p class="text-2xl font-bold text-green-900">1,247</p>
                <p class="text-xs text-green-700 mt-2">↑ 12% from yesterday</p>
            </div>
            
            <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg border border-purple-200">
                <div class="flex items-center justify-between mb-4">
                    <i data-lucide="shield-check" class="w-8 h-8 text-purple-600"></i>
                    <span class="text-xs bg-purple-600 text-white px-2 py-1 rounded-full">Secure</span>
                </div>
                <h4 class="text-sm font-medium text-purple-900 mb-1">Security Score</h4>
                <p class="text-2xl font-bold text-purple-900">A+</p>
                <p class="text-xs text-purple-700 mt-2">All systems protected</p>
            </div>
            
            <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-lg border border-orange-200">
                <div class="flex items-center justify-between mb-4">
                    <i data-lucide="alert-circle" class="w-8 h-8 text-orange-600"></i>
                    <span class="text-xs bg-orange-600 text-white px-2 py-1 rounded-full">Alert</span>
                </div>
                <h4 class="text-sm font-medium text-orange-900 mb-1">Active Alerts</h4>
                <p class="text-2xl font-bold text-orange-900">3</p>
                <p class="text-xs text-orange-700 mt-2">2 critical, 1 warning</p>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="bg-white rounded-lg shadow-sm mb-6">
            <div class="border-b border-gray-200">
                <nav class="flex space-x-8 px-6" aria-label="Tabs">
                    <button onclick="switchTab('routes')" class="tab-btn py-4 px-1 border-b-2 font-medium text-sm tab-active" data-tab="routes">
                        <i data-lucide="git-branch" class="w-4 h-4 inline mr-2"></i>
                        Routes
                    </button>
                    <button onclick="switchTab('test')" class="tab-btn py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700" data-tab="test">
                        <i data-lucide="play-circle" class="w-4 h-4 inline mr-2"></i>
                        Test API
                    </button>
                    <button onclick="switchTab('middleware')" class="tab-btn py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700" data-tab="middleware">
                        <i data-lucide="shield" class="w-4 h-4 inline mr-2"></i>
                        Middleware
                    </button>
                    <button onclick="switchTab('alerts')" class="tab-btn py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700" data-tab="alerts">
                        <i data-lucide="alert-triangle" class="w-4 h-4 inline mr-2"></i>
                        Alerts
                    </button>
                    <button onclick="switchTab('monitoring')" class="tab-btn py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700" data-tab="monitoring">
                        <i data-lucide="bar-chart-3" class="w-4 h-4 inline mr-2"></i>
                        Monitoring
                    </button>
                    <button onclick="switchTab('logs')" class="tab-btn py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700" data-tab="logs">
                        <i data-lucide="terminal" class="w-4 h-4 inline mr-2"></i>
                        Server Logs
                    </button>
                    <button onclick="switchTab('analytics')" class="tab-btn py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700" data-tab="analytics">
                        <i data-lucide="pie-chart" class="w-4 h-4 inline mr-2"></i>
                        Analytics
                    </button>
                    <button onclick="switchTab('security')" class="tab-button px-4 py-2 font-medium text-sm rounded-t-lg transition-colors" data-tab="security">
                        <i data-lucide="shield" class="w-4 h-4 inline mr-2"></i>Security
                    </button>
                    <button onclick="switchTab('storage')" class="tab-button px-4 py-2 font-medium text-sm rounded-t-lg transition-colors" data-tab="storage">
                        <i data-lucide="hard-drive" class="w-4 h-4 inline mr-2"></i>R2 Storage
                    </button>
                </nav>
            </div>

            <!-- Routes Tab -->
            <div id="routes-tab" class="tab-content p-6">
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Route Categories</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="route-card bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-medium text-gray-900 mb-2">
                                <i data-lucide="phone" class="w-4 h-4 inline mr-2"></i>
                                Phone Analysis
                            </h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>/api/analyze/phone/:phone</li>
                                <li>/api/analyze/phone/:phone/risk</li>
                                <li>/api/analyze/phone/:phone/network</li>
                            </ul>
                        </div>
                        <div class="route-card bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-medium text-gray-900 mb-2">
                                <i data-lucide="brain" class="w-4 h-4 inline mr-2"></i>
                                AI/ML Analysis
                            </h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>/api/ml/predict/risk/:phone/:model?</li>
                                <li>/api/ml/anomalies/detect/:phone</li>
                                <li>/api/ml/classify/pattern/:phone</li>
                            </ul>
                        </div>
                        <div class="route-card bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-medium text-gray-900 mb-2">
                                <i data-lucide="share-2" class="w-4 h-4 inline mr-2"></i>
                                Cross-Platform
                            </h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>/api/cross-platform/analyze/:phone</li>
                                <li>/api/cross-platform/graph/:phone/:depth?</li>
                                <li>/api/cross-platform/anomalies/:timeframe?</li>
                            </ul>
                        </div>
                        <div class="route-card bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-medium text-gray-900 mb-2">
                                <i data-lucide="radio" class="w-4 h-4 inline mr-2"></i>
                                Real-time
                            </h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>/api/realtime/alerts/:severity?</li>
                                <li>/api/realtime/metrics/:metric?</li>
                                <li>/api/realtime/events/:type?/:limit?</li>
                            </ul>
                        </div>
                        <div class="route-card bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-medium text-gray-900 mb-2">
                                <i data-lucide="server" class="w-4 h-4 inline mr-2"></i>
                                Platform Analysis
                            </h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>/api/v:version/platform/:platform/users/:userId</li>
                                <li>/api/v:version/platform/:platform/transactions/:userId</li>
                                <li>/api/v:version/platform/:platform/risk/:userId</li>
                            </ul>
                        </div>
                        <div class="route-card bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-medium text-gray-900 mb-2">
                                <i data-lucide="package" class="w-4 h-4 inline mr-2"></i>
                                Batch Processing
                            </h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>/api/batch/submit</li>
                                <li>/api/batch/:jobId/status</li>
                                <li>/api/batch/:jobId/pause</li>
                                <li>/api/batch/:jobId/resume</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Pattern Features</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="code-block p-4 rounded-lg text-white">
                            <h4 class="font-medium mb-2">Version Extraction</h4>
                            <code class="text-sm">
                                /api/v:version(\d+)/platform/:platform/users/:userId
                            </code>
                            <p class="text-xs text-gray-300 mt-2">
                                Extracts version, platform, and userId parameters
                            </p>
                        </div>
                        <div class="code-block p-4 rounded-lg text-white">
                            <h4 class="font-medium mb-2">Optional Parameters</h4>
                            <code class="text-sm">
                                /api/dashboard/metrics/:timeframe?
                            </code>
                            <p class="text-xs text-gray-300 mt-2">
                                timeframe parameter is optional
                            </p>
                        </div>
                        <div class="code-block p-4 rounded-lg text-white">
                            <h4 class="font-medium mb-2">Wildcard Support</h4>
                            <code class="text-sm">
                                /api/files/upload/*
                            </code>
                            <p class="text-xs text-gray-300 mt-2">
                                Matches any path after upload/
                            </p>
                        </div>
                        <div class="code-block p-4 rounded-lg text-white">
                            <h4 class="font-medium mb-2">Multiple Optional</h4>
                            <code class="text-sm">
                                /api/cross-platform/patterns/:type?/:severity?
                            </code>
                            <p class="text-xs text-gray-300 mt-2">
                                Both type and severity are optional
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Test API Tab -->
            <div id="test-tab" class="tab-content p-6 hidden">
                <div class="space-y-6">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">API Testing</h3>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Select Endpoint</label>
                                <select id="endpoint-select" class="w-full p-2 border border-gray-300 rounded-lg">
                                    <option value="phone-analysis">Phone Analysis</option>
                                    <option value="phone-risk">Phone Risk Assessment</option>
                                    <option value="ml-prediction">ML Risk Prediction</option>
                                    <option value="identity-graph">Identity Graph</option>
                                    <option value="realtime-alerts">Real-time Alerts</option>
                                    <option value="platform-analysis">Platform Analysis</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">API Key</label>
                                <select id="api-key-select" class="w-full p-2 border border-gray-300 rounded-lg">
                                    <option value="demo-key-super-admin">Super Admin (Full Access)</option>
                                    <option value="demo-key-analyst">Analyst (Read/Write)</option>
                                    <option value="">No Key (Limited Access)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div id="parameter-inputs" class="space-y-4">
                        <!-- Dynamic parameter inputs will be inserted here -->
                    </div>

                    <div class="flex space-x-4">
                        <button onclick="testAPI()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 flex items-center">
                            <i data-lucide="play" class="w-4 h-4 mr-2"></i>
                            Send Request
                        </button>
                        <button onclick="clearResponse()" class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 flex items-center">
                            <i data-lucide="trash-2" class="w-4 h-4 mr-2"></i>
                            Clear
                        </button>
                    </div>

                    <div>
                        <h4 class="font-medium text-gray-900 mb-2">Response</h4>
                        <div id="response-container" class="bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm h-64 overflow-y-auto">
                            <p class="text-gray-500">Response will appear here...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Middleware Tab -->
            <div id="middleware-tab" class="tab-content p-6 hidden">
                <div class="space-y-6">
                    <h3 class="text-lg font-semibold text-gray-900">7-Layer Middleware Stack</h3>
                    <div class="space-y-4">
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">1</span>
                                    <h4 class="font-medium text-gray-900">Request ID</h4>
                                </div>
                                <span class="status-indicator status-online"></span>
                            </div>
                            <p class="text-sm text-gray-600 mt-2">Generates unique request IDs for tracking and debugging</p>
                        </div>
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">2</span>
                                    <h4 class="font-medium text-gray-900">CORS</h4>
                                </div>
                                <span class="status-indicator status-online"></span>
                            </div>
                            <p class="text-sm text-gray-600 mt-2">Handles cross-origin requests with enhanced headers</p>
                        </div>
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">3</span>
                                    <h4 class="font-medium text-gray-900">Rate Limiting</h4>
                                </div>
                                <span class="status-indicator status-online"></span>
                            </div>
                            <p class="text-sm text-gray-600 mt-2">Tiered rate limiting (1000 req/min for API keys, 100 req/min for IP)</p>
                        </div>
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">4</span>
                                    <h4 class="font-medium text-gray-900">Authentication</h4>
                                </div>
                                <span class="status-indicator status-online"></span>
                            </div>
                            <p class="text-sm text-gray-600 mt-2">Multi-tier authentication with role-based access</p>
                        </div>
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">5</span>
                                    <h4 class="font-medium text-gray-900">Authorization</h4>
                                </div>
                                <span class="status-indicator status-online"></span>
                            </div>
                            <p class="text-sm text-gray-600 mt-2">Role-based access control (RBAC) with endpoint permissions</p>
                        </div>
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">6</span>
                                    <h4 class="font-medium text-gray-900">Validation</h4>
                                </div>
                                <span class="status-indicator status-online"></span>
                            </div>
                            <p class="text-sm text-gray-600 mt-2">Comprehensive input validation for phones, job IDs, and versions</p>
                        </div>
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">7</span>
                                    <h4 class="font-medium text-gray-900">Caching</h4>
                                </div>
                                <span class="status-indicator status-online"></span>
                            </div>
                            <p class="text-sm text-gray-600 mt-2">Intelligent caching with 30-second TTL for GET requests</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Alerts Tab -->
            <div id="alerts-tab" class="tab-content p-6 hidden">
                <div class="space-y-6">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-semibold text-gray-900">Real-time Alerts</h3>
                        <button onclick="refreshAlerts()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center">
                            <i data-lucide="refresh-cw" class="w-4 h-4 mr-2"></i>
                            Refresh
                        </button>
                    </div>
                    
                    <div id="alerts-container" class="space-y-4">
                        <div class="bg-white border-l-4 border-red-500 p-4 rounded-lg alert-critical">
                            <div class="flex items-start justify-between">
                                <div>
                                    <h4 class="font-medium text-gray-900">Critical: Synthetic Identity Detected</h4>
                                    <p class="text-sm text-gray-600 mt-1">High-confidence synthetic identity detected for phone +15559876543</p>
                                    <p class="text-xs text-gray-500 mt-2">2 minutes ago</p>
                                </div>
                                <span class="bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded">CRITICAL</span>
                            </div>
                        </div>
                        
                        <div class="bg-white border-l-4 border-yellow-500 p-4 rounded-lg alert-warning">
                            <div class="flex items-start justify-between">
                                <div>
                                    <h4 class="font-medium text-gray-900">Warning: Unusual Activity Pattern</h4>
                                    <p class="text-sm text-gray-600 mt-1">Spike in transaction volume for new account +15551112222</p>
                                    <p class="text-xs text-gray-500 mt-2">5 minutes ago</p>
                                </div>
                                <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2.5 py-0.5 rounded">WARNING</span>
                            </div>
                        </div>
                        
                        <div class="bg-white border-l-4 border-blue-500 p-4 rounded-lg alert-info">
                            <div class="flex items-start justify-between">
                                <div>
                                    <h4 class="font-medium text-gray-900">Info: ML Model Updated</h4>
                                    <p class="text-sm text-gray-600 mt-1">Risk prediction model ensemble-v1 updated to version 1.2.0</p>
                                    <p class="text-xs text-gray-500 mt-2">1 hour ago</p>
                                </div>
                                <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">INFO</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Monitoring Tab -->
            <div id="monitoring-tab" class="tab-content p-6 hidden">
                <div class="space-y-6">
                    <h3 class="text-lg font-semibold text-gray-900">System Monitoring</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-lg border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-4">Performance Metrics</h4>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Average Response Time</span>
                                    <span class="text-sm font-medium">45ms</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Request Rate</span>
                                    <span class="text-sm font-medium">234 req/min</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Error Rate</span>
                                    <span class="text-sm font-medium text-green-600">0.2%</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Cache Hit Rate</span>
                                    <span class="text-sm font-medium">73%</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">ML Processing Time</span>
                                    <span class="text-sm font-medium">95ms</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-4">System Health</h4>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">API Server</span>
                                    <span class="text-sm font-medium text-green-600">Healthy</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Database</span>
                                    <span class="text-sm font-medium text-green-600">Connected</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">ML Models</span>
                                    <span class="text-sm font-medium text-green-600">Loaded</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Cache Server</span>
                                    <span class="text-sm font-medium text-green-600">Active</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Queue System</span>
                                    <span class="text-sm font-medium text-green-600">Running</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Request Distribution Chart -->
                    <div class="bg-white p-6 rounded-lg border border-gray-200">
                        <h4 class="font-medium text-gray-900 mb-4">Request Distribution by Endpoint</h4>
                        <div class="chart-container" style="height: 250px;">
                            <canvas id="distributionChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg border border-gray-200">
                        <h4 class="font-medium text-gray-900 mb-4">Recent Activity</h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between py-2 border-b border-gray-100">
                                <div class="flex items-center space-x-3">
                                    <i data-lucide="phone" class="w-4 h-4 text-gray-400"></i>
                                    <span class="text-sm">Phone analysis completed</span>
                                </div>
                                <span class="text-xs text-gray-500">30s ago</span>
                            </div>
                            <div class="flex items-center justify-between py-2 border-b border-gray-100">
                                <div class="flex items-center space-x-3">
                                    <i data-lucide="brain" class="w-4 h-4 text-gray-400"></i>
                                    <span class="text-sm">ML risk prediction executed</span>
                                </div>
                                <span class="text-xs text-gray-500">1m ago</span>
                            </div>
                            <div class="flex items-center justify-between py-2 border-b border-gray-100">
                                <div class="flex items-center space-x-3">
                                    <i data-lucide="package" class="w-4 h-4 text-gray-400"></i>
                                    <span class="text-sm">Batch job submitted</span>
                                </div>
                                <span class="text-xs text-gray-500">2m ago</span>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <div class="flex items-center space-x-3">
                                    <i data-lucide="share-2" class="w-4 h-4 text-gray-400"></i>
                                    <span class="text-sm">Identity graph constructed</span>
                                </div>
                                <span class="text-xs text-gray-500">3m ago</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="analytics-tab" class="tab-content p-6 hidden">
                <div class="space-y-6">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-semibold text-gray-900">Advanced Analytics</h3>
                        <div class="flex items-center space-x-2">
                            <select id="analytics-timeframe" onchange="updateAnalytics()" class="px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                <option value="1h">Last Hour</option>
                                <option value="24h" selected>Last 24 Hours</option>
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                            </select>
                            <button onclick="refreshAnalytics()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center text-sm">
                                <i data-lucide="refresh-cw" class="w-4 h-4 mr-2"></i>
                                Refresh
                            </button>
                        </div>
                    </div>

                    <!-- Key Performance Indicators -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="bg-white p-6 rounded-lg border border-gray-200">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="text-sm font-medium text-gray-600">Total Requests</h4>
                                <i data-lucide="trending-up" class="w-4 h-4 text-green-500"></i>
                            </div>
                            <p class="text-2xl font-bold text-gray-900">2.4M</p>
                            <p class="text-xs text-green-600 mt-1">↑ 18% from last period</p>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg border border-gray-200">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="text-sm font-medium text-gray-600">Avg Response Time</h4>
                                <i data-lucide="zap" class="w-4 h-4 text-blue-500"></i>
                            </div>
                            <p class="text-2xl font-bold text-gray-900">42ms</p>
                            <p class="text-xs text-green-600 mt-1">↓ 5ms improvement</p>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg border border-gray-200">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="text-sm font-medium text-gray-600">Error Rate</h4>
                                <i data-lucide="alert-triangle" class="w-4 h-4 text-yellow-500"></i>
                            </div>
                            <p class="text-2xl font-bold text-gray-900">0.12%</p>
                            <p class="text-xs text-green-600 mt-1">↓ 0.08% improvement</p>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg border border-gray-200">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="text-sm font-medium text-gray-600">Throughput</h4>
                                <i data-lucide="activity" class="w-4 h-4 text-purple-500"></i>
                            </div>
                            <p class="text-2xl font-bold text-gray-900">1,847 req/s</p>
                            <p class="text-xs text-green-600 mt-1">↑ 234 req/s</p>
                        </div>
                    </div>

                    <!-- Advanced Charts -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-lg border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-4">Response Time Distribution</h4>
                            <div class="chart-container" style="height: 250px;">
                                <canvas id="responseTimeHistogram"></canvas>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-4">Status Code Breakdown</h4>
                            <div class="chart-container" style="height: 250px;">
                                <canvas id="statusCodeChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Traffic Patterns -->
                    <div class="bg-white p-6 rounded-lg border border-gray-200">
                        <h4 class="font-medium text-gray-900 mb-4">Traffic Patterns (Last 24 Hours)</h4>
                        <div class="chart-container" style="height: 300px;">
                            <canvas id="trafficPatternChart"></canvas>
                        </div>
                    </div>

                    <!-- Top Endpoints Table -->
                    <div class="bg-white p-6 rounded-lg border border-gray-200">
                        <h4 class="font-medium text-gray-900 mb-4">Top Endpoints by Usage</h4>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Endpoint</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Requests</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Avg Response</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Success Rate</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Trend</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">/api/analyze/phone/:phone</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">847,392</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">38ms</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">99.9%</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-green-600">↑ 12%</td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">/api/ml/predict/risk/:phone</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">623,447</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">95ms</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">99.7%</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-green-600">↑ 8%</td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">/api/v1/platform/:platform/users</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">412,893</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">42ms</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">99.8%</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-green-600">↑ 15%</td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">/api/cross-platform/graph/:phone</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">287,654</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">145ms</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">99.6%</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-red-600">↓ 3%</td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">/api/realtime/alerts</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">198,234</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">12ms</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">100%</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-green-600">↑ 22%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Geographic Distribution -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-lg border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-4">Geographic Distribution</h4>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <span class="text-2xl">🇺🇸</span>
                                        <span class="text-sm font-medium">United States</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-32 bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-600 h-2 rounded-full" style="width: 45%"></div>
                                        </div>
                                        <span class="text-sm text-gray-600">45%</span>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <span class="text-2xl">🇬🇧</span>
                                        <span class="text-sm font-medium">United Kingdom</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-32 bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-600 h-2 rounded-full" style="width: 18%"></div>
                                        </div>
                                        <span class="text-sm text-gray-600">18%</span>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <span class="text-2xl">🇩🇪</span>
                                        <span class="text-sm font-medium">Germany</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-32 bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-600 h-2 rounded-full" style="width: 12%"></div>
                                        </div>
                                        <span class="text-sm text-gray-600">12%</span>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <span class="text-2xl">🇯🇵</span>
                                        <span class="text-sm font-medium">Japan</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-32 bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-600 h-2 rounded-full" style="width: 8%"></div>
                                        </div>
                                        <span class="text-sm text-gray-600">8%</span>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <span class="text-2xl">🌍</span>
                                        <span class="text-sm font-medium">Others</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-32 bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-600 h-2 rounded-full" style="width: 17%"></div>
                                        </div>
                                        <span class="text-sm text-gray-600">17%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-4">Device & Browser Stats</h4>
                            <div class="space-y-4">
                                <div>
                                    <h5 class="text-sm font-medium text-gray-700 mb-2">Devices</h5>
                                    <div class="space-y-2">
                                        <div class="flex justify-between text-sm">
                                            <span>Desktop</span>
                                            <span class="text-gray-600">62%</span>
                                        </div>
                                        <div class="flex justify-between text-sm">
                                            <span>Mobile</span>
                                            <span class="text-gray-600">31%</span>
                                        </div>
                                        <div class="flex justify-between text-sm">
                                            <span>Tablet</span>
                                            <span class="text-gray-600">7%</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h5 class="text-sm font-medium text-gray-700 mb-2">Browsers</h5>
                                    <div class="space-y-2">
                                        <div class="flex justify-between text-sm">
                                            <span>Chrome</span>
                                            <span class="text-gray-600">48%</span>
                                        </div>
                                        <div class="flex justify-between text-sm">
                                            <span>Safari</span>
                                            <span class="text-gray-600">22%</span>
                                        </div>
                                        <div class="flex justify-between text-sm">
                                            <span>Firefox</span>
                                            <span class="text-gray-600">15%</span>
                                        </div>
                                        <div class="flex justify-between text-sm">
                                            <span>Others</span>
                                            <span class="text-gray-600">15%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Security Tab -->
            <div id="security-tab" class="tab-content p-6 hidden">
                <div class="space-y-6">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-semibold text-gray-900">Security Center</h3>
                        <div class="flex items-center space-x-2">
                            <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">
                                <i data-lucide="shield-check" class="w-4 h-4 inline mr-1"></i>
                                Security Score: A+
                            </span>
                            <button onclick="runSecurityScan()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 flex items-center text-sm">
                                <i data-lucide="shield" class="w-4 h-4 mr-2"></i>
                                Run Security Scan
                            </button>
                        </div>
                    </div>

                    <!-- Security Overview Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg border border-green-200">
                            <div class="flex items-center justify-between mb-4">
                                <i data-lucide="shield-check" class="w-8 h-8 text-green-600"></i>
                                <span class="text-xs bg-green-600 text-white px-2 py-1 rounded-full">Secure</span>
                            </div>
                            <h4 class="text-sm font-medium text-green-900 mb-1">Firewall Status</h4>
                            <p class="text-2xl font-bold text-green-900">Active</p>
                            <p class="text-xs text-green-700 mt-2">Blocking 1,247 threats</p>
                        </div>
                        
                        <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg border border-blue-200">
                            <div class="flex items-center justify-between mb-4">
                                <i data-lucide="lock" class="w-8 h-8 text-blue-600"></i>
                                <span class="text-xs bg-blue-600 text-white px-2 py-1 rounded-full">Encrypted</span>
                            </div>
                            <h4 class="text-sm font-medium text-blue-900 mb-1">SSL Certificate</h4>
                            <p class="text-2xl font-bold text-blue-900">Valid</p>
                            <p class="text-xs text-blue-700 mt-2">Expires in 89 days</p>
                        </div>
                        
                        <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg border border-purple-200">
                            <div class="flex items-center justify-between mb-4">
                                <i data-lucide="users" class="w-8 h-8 text-purple-600"></i>
                                <span class="text-xs bg-purple-600 text-white px-2 py-1 rounded-full">Active</span>
                            </div>
                            <h4 class="text-sm font-medium text-purple-900 mb-1">Auth Systems</h4>
                            <p class="text-2xl font-bold text-purple-900">3/3</p>
                            <p class="text-xs text-purple-700 mt-2">All operational</p>
                        </div>
                        
                        <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-lg border border-orange-200">
                            <div class="flex items-center justify-between mb-4">
                                <i data-lucide="alert-triangle" class="w-8 h-8 text-orange-600"></i>
                                <span class="text-xs bg-orange-600 text-white px-2 py-1 rounded-full">Alert</span>
                            </div>
                            <h4 class="text-sm font-medium text-orange-900 mb-1">Threats Detected</h4>
                            <p class="text-2xl font-bold text-orange-900">12</p>
                            <p class="text-xs text-orange-700 mt-2">Last 24 hours</p>
                        </div>
                    </div>

                    <!-- Security Heatmap -->
                    <div class="bg-white p-6 rounded-lg border border-gray-200">
                        <h4 class="font-medium text-gray-900 mb-4">Security Activity Heatmap (Last 7 Days)</h4>
                        <div class="grid grid-cols-8 gap-1">
                            <div class="text-xs text-gray-500 text-center">Time</div>
                            <div class="text-xs text-gray-500 text-center">Mon</div>
                            <div class="text-xs text-gray-500 text-center">Tue</div>
                            <div class="text-xs text-gray-500 text-center">Wed</div>
                            <div class="text-xs text-gray-500 text-center">Thu</div>
                            <div class="text-xs text-gray-500 text-center">Fri</div>
                            <div class="text-xs text-gray-500 text-center">Sat</div>
                            <div class="text-xs text-gray-500 text-center">Sun</div>
                            
                            <div class="text-xs text-gray-500">00:00</div>
                            <div class="heatmap-cell w-8 h-8 bg-green-200 rounded" title="Monday 00:00 - Low activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-green-300 rounded" title="Tuesday 00:00 - Low activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-yellow-300 rounded" title="Wednesday 00:00 - Medium activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-green-200 rounded" title="Thursday 00:00 - Low activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-green-100 rounded" title="Friday 00:00 - Very low activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-green-100 rounded" title="Saturday 00:00 - Very low activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-green-200 rounded" title="Sunday 00:00 - Low activity"></div>
                            
                            <div class="text-xs text-gray-500">06:00</div>
                            <div class="heatmap-cell w-8 h-8 bg-yellow-400 rounded" title="Monday 06:00 - Medium activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-orange-400 rounded" title="Tuesday 06:00 - High activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-red-400 rounded" title="Wednesday 06:00 - Critical activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-yellow-300 rounded" title="Thursday 06:00 - Medium activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-yellow-200 rounded" title="Friday 06:00 - Low-medium activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-green-200 rounded" title="Saturday 06:00 - Low activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-green-300 rounded" title="Sunday 06:00 - Low activity"></div>
                            
                            <div class="text-xs text-gray-500">12:00</div>
                            <div class="heatmap-cell w-8 h-8 bg-red-500 rounded" title="Monday 12:00 - Critical activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-red-400 rounded" title="Tuesday 12:00 - Critical activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-orange-500 rounded" title="Wednesday 12:00 - High activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-red-400 rounded" title="Thursday 12:00 - Critical activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-orange-400 rounded" title="Friday 12:00 - High activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-yellow-300 rounded" title="Saturday 12:00 - Medium activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-yellow-400 rounded" title="Sunday 12:00 - Medium activity"></div>
                            
                            <div class="text-xs text-gray-500">18:00</div>
                            <div class="heatmap-cell w-8 h-8 bg-orange-400 rounded" title="Monday 18:00 - High activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-orange-500 rounded" title="Tuesday 18:00 - High activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-red-400 rounded" title="Wednesday 18:00 - Critical activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-orange-300 rounded" title="Thursday 18:00 - Medium-high activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-yellow-400 rounded" title="Friday 18:00 - Medium activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-green-300 rounded" title="Saturday 18:00 - Low activity"></div>
                            <div class="heatmap-cell w-8 h-8 bg-green-200 rounded" title="Sunday 18:00 - Low activity"></div>
                        </div>
                        <div class="flex items-center justify-center mt-4 space-x-4 text-xs">
                            <div class="flex items-center space-x-1">
                                <div class="w-3 h-3 bg-green-100 rounded"></div>
                                <span>Very Low</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <div class="w-3 h-3 bg-green-300 rounded"></div>
                                <span>Low</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <div class="w-3 h-3 bg-yellow-400 rounded"></div>
                                <span>Medium</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <div class="w-3 h-3 bg-orange-400 rounded"></div>
                                <span>High</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <div class="w-3 h-3 bg-red-500 rounded"></div>
                                <span>Critical</span>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Security Events -->
                    <div class="bg-white p-6 rounded-lg border border-gray-200">
                        <h4 class="font-medium text-gray-900 mb-4">Recent Security Events</h4>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between p-3 bg-red-50 border border-red-200 rounded-lg">
                                <div class="flex items-center space-x-3">
                                    <i data-lucide="alert-triangle" class="w-5 h-5 text-red-600"></i>
                                    <div>
                                        <p class="text-sm font-medium text-red-900">Suspicious Login Attempt</p>
                                        <p class="text-xs text-red-700">Multiple failed attempts from IP 192.168.1.100</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p class="text-xs text-red-600">2 minutes ago</p>
                                    <button class="text-xs text-red-600 hover:text-red-800">Investigate</button>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                                <div class="flex items-center space-x-3">
                                    <i data-lucide="alert-circle" class="w-5 h-5 text-yellow-600"></i>
                                    <div>
                                        <p class="text-sm font-medium text-yellow-900">Unusual API Usage</p>
                                        <p class="text-xs text-yellow-700">High request rate from single API key</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p class="text-xs text-yellow-600">15 minutes ago</p>
                                    <button class="text-xs text-yellow-600 hover:text-yellow-800">Review</button>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                <div class="flex items-center space-x-3">
                                    <i data-lucide="info" class="w-5 h-5 text-blue-600"></i>
                                    <div>
                                        <p class="text-sm font-medium text-blue-900">SSL Certificate Renewal</p>
                                        <p class="text-xs text-blue-700">Certificate expires in 89 days</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p class="text-xs text-blue-600">1 hour ago</p>
                                    <button class="text-xs text-blue-600 hover:text-blue-800">Renew</button>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg">
                                <div class="flex items-center space-x-3">
                                    <i data-lucide="check-circle" class="w-5 h-5 text-green-600"></i>
                                    <div>
                                        <p class="text-sm font-medium text-green-900">Security Scan Completed</p>
                                        <p class="text-xs text-green-700">No vulnerabilities detected</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p class="text-xs text-green-600">3 hours ago</p>
                                    <button class="text-xs text-green-600 hover:text-green-800">View Report</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Security Metrics -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-lg border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-4">Threat Intelligence</h4>
                            <div class="space-y-4">
                                <div>
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Malware Detection</span>
                                        <span class="text-green-600">99.9%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-green-600 h-2 rounded-full" style="width: 99.9%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Phishing Protection</span>
                                        <span class="text-green-600">98.7%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-green-600 h-2 rounded-full" style="width: 98.7%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>DDoS Protection</span>
                                        <span class="text-yellow-600">87.3%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-yellow-600 h-2 rounded-full" style="width: 87.3%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Data Encryption</span>
                                        <span class="text-green-600">100%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-green-600 h-2 rounded-full" style="width: 100%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-4">Access Control</h4>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <i data-lucide="users" class="w-4 h-4 text-gray-400"></i>
                                        <span class="text-sm">Active Users</span>
                                    </div>
                                    <span class="text-sm font-medium">1,247</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <i data-lucide="key" class="w-4 h-4 text-gray-400"></i>
                                        <span class="text-sm">API Keys</span>
                                    </div>
                                    <span class="text-sm font-medium">23</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <i data-lucide="shield" class="w-4 h-4 text-gray-400"></i>
                                        <span class="text-sm">Role Permissions</span>
                                    </div>
                                    <span class="text-sm font-medium">5</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <i data-lucide="clock" class="w-4 h-4 text-gray-400"></i>
                                        <span class="text-sm">Session Timeout</span>
                                    </div>
                                    <span class="text-sm font-medium">30 min</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <i data-lucide="lock" class="w-4 h-4 text-gray-400"></i>
                                        <span class="text-sm">2FA Enabled</span>
                                    </div>
                                    <span class="text-sm font-medium text-green-600">87%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                <div class="space-y-6">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-semibold text-gray-900">Server Logs</h3>
                        <div class="flex items-center space-x-2">
                            <button onclick="clearLogs()" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 flex items-center text-sm">
                                <i data-lucide="trash-2" class="w-4 h-4 mr-2"></i>
                                Clear
                            </button>
                            <button onclick="toggleAutoScroll()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center text-sm">
                                <i data-lucide="play" class="w-4 h-4 mr-2"></i>
                                <span id="auto-scroll-text">Auto Scroll: ON</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-gray-900 rounded-lg p-4 h-96 overflow-y-auto">
                        <div id="server-logs" class="server-log text-green-400 space-y-1">
                            <div>[2024-01-14 01:13:45] 🌟 Enhanced server is running... Press Ctrl+C to stop</div>
                            <div>[2024-01-14 01:13:45] 🚀 Server running on http://localhost:3002</div>
                            <div>[2024-01-14 01:13:46] 🛡️ Middleware stack initialized (7 layers)</div>
                            <div>[2024-01-14 01:13:47] 📊 Dashboard metrics loaded</div>
                            <div>[2024-01-14 01:13:48] ⚡ Performance monitoring active</div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white p-4 rounded-lg border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-2">Log Level</h4>
                            <select id="log-level" onchange="filterLogs()" class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                                <option value="all">All Levels</option>
                                <option value="info">Info</option>
                                <option value="warn">Warning</option>
                                <option value="error">Error</option>
                            </select>
                        </div>
                        <div class="bg-white p-4 rounded-lg border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-2">Total Entries</h4>
                            <p id="log-count" class="text-2xl font-bold text-gray-900">5</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-2">Last Update</h4>
                            <p id="last-log-time" class="text-sm text-gray-600">Just now</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- R2 Storage Tab -->
        <div id="storage-tab" class="tab-content hidden p-6">
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Cloudflare R2 Storage Management</h3>
                
                <!-- Storage Overview Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-lg border border-blue-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-blue-600">Total Files</p>
                                <p id="r2-total-files" class="text-2xl font-bold text-blue-900">1,247</p>
                            </div>
                            <div class="bg-blue-200 p-3 rounded-full">
                                <i data-lucide="file-text" class="w-6 h-6 text-blue-600"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-lg border border-green-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-green-600">Storage Used</p>
                                <p id="r2-storage-used" class="text-2xl font-bold text-green-900">2.4GB</p>
                            </div>
                            <div class="bg-green-200 p-3 rounded-full">
                                <i data-lucide="database" class="w-6 h-6 text-green-600"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-lg border border-purple-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-purple-600">Uploads Today</p>
                                <p id="r2-uploads-today" class="text-2xl font-bold text-purple-900">23</p>
                            </div>
                            <div class="bg-purple-200 p-3 rounded-full">
                                <i data-lucide="upload" class="w-6 h-6 text-purple-600"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-4 rounded-lg border border-orange-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-orange-600">Downloads Today</p>
                                <p id="r2-downloads-today" class="text-2xl font-bold text-orange-900">156</p>
                            </div>
                            <div class="bg-orange-200 p-3 rounded-full">
                                <i data-lucide="download" class="w-6 h-6 text-orange-600"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="bg-white border border-gray-200 rounded-lg p-4 mb-6">
                    <h4 class="font-medium text-gray-900 mb-3">Quick Actions</h4>
                    <div class="flex flex-wrap gap-2">
                        <button onclick="refreshR2Stats()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                            <i data-lucide="refresh-cw" class="w-4 h-4 inline mr-2"></i>Refresh Stats
                        </button>
                        <button onclick="showR2UploadModal()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                            <i data-lucide="upload" class="w-4 h-4 inline mr-2"></i>Upload File
                        </button>
                        <button onclick="refreshR2Files()" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors">
                            <i data-lucide="list" class="w-4 h-4 inline mr-2"></i>List Files
                        </button>
                        <button onclick="openR2Settings()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                            <i data-lucide="settings" class="w-4 h-4 inline mr-2"></i>Settings
                        </button>
                    </div>
                </div>
                
                <!-- Storage Usage Chart -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900 mb-3">Storage Usage</h4>
                        <canvas id="r2-storage-chart" width="400" height="200"></canvas>
                    </div>
                    
                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900 mb-3">File Types Distribution</h4>
                        <canvas id="r2-filetypes-chart" width="400" height="200"></canvas>
                    </div>
                </div>
                
                <!-- File Browser -->
                <div class="bg-white border border-gray-200 rounded-lg">
                    <div class="p-4 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <h4 class="font-medium text-gray-900">File Browser</h4>
                            <div class="flex items-center space-x-2">
                                <input type="text" id="r2-search" placeholder="Search files..." 
                                       class="px-3 py-1 border border-gray-300 rounded-lg text-sm">
                                <select id="r2-filter-type" class="px-3 py-1 border border-gray-300 rounded-lg text-sm">
                                    <option value="">All Types</option>
                                    <option value="json">JSON</option>
                                    <option value="csv">CSV</option>
                                    <option value="pdf">PDF</option>
                                    <option value="gz">GZIP</option>
                                    <option value="txt">Text</option>
                                </select>
                                <button onclick="searchR2Files()" class="bg-blue-600 text-white px-3 py-1 rounded-lg text-sm hover:bg-blue-700">
                                    Search
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Size</th>
                                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Modified</th>
                                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="r2-files-table" class="bg-white divide-y divide-gray-200">
                                <!-- Files will be populated here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="p-4 border-t border-gray-200">
                        <div class="flex items-center justify-between">
                            <p id="r2-files-count" class="text-sm text-gray-600">Showing 0 files</p>
                            <div class="flex space-x-2">
                                <button onclick="previousR2Page()" class="px-3 py-1 border border-gray-300 rounded-lg text-sm hover:bg-gray-50">Previous</button>
                                <button onclick="nextR2Page()" class="px-3 py-1 border border-gray-300 rounded-lg text-sm hover:bg-gray-50">Next</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Notification Panel -->
    <div id="notification-panel" class="fixed top-16 right-4 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50 hidden">
        <div class="p-4 border-b border-gray-200">
            <div class="flex items-center justify-between">
                <h3 class="font-semibold text-gray-900">Notifications</h3>
                <button onclick="toggleNotifications()" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
        </div>
        <div class="max-h-96 overflow-y-auto">
            <div class="p-4 border-b border-gray-100 hover:bg-gray-50">
                <div class="flex items-start space-x-3">
                    <div class="w-2 h-2 bg-red-500 rounded-full mt-2"></div>
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-900">Security Alert</p>
                        <p class="text-xs text-gray-600">Suspicious activity detected</p>
                        <p class="text-xs text-gray-400 mt-1">2 minutes ago</p>
                    </div>
                </div>
            </div>
            <div class="p-4 border-b border-gray-100 hover:bg-gray-50">
                <div class="flex items-start space-x-3">
                    <div class="w-2 h-2 bg-yellow-500 rounded-full mt-2"></div>
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-900">High CPU Usage</p>
                        <p class="text-xs text-gray-600">CPU usage exceeded 80%</p>
                        <p class="text-xs text-gray-400 mt-1">15 minutes ago</p>
                    </div>
                </div>
            </div>
            <div class="p-4 border-b border-gray-100 hover:bg-gray-50">
                <div class="flex items-start space-x-3">
                    <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-900">API Update</p>
                        <p class="text-xs text-gray-600">New endpoints deployed</p>
                        <p class="text-xs text-gray-400 mt-1">1 hour ago</p>
                    </div>
                </div>
            </div>
            <div class="p-4 hover:bg-gray-50">
                <div class="flex items-start space-x-3">
                    <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-900">System Healthy</p>
                        <p class="text-xs text-gray-600">All systems operational</p>
                        <p class="text-xs text-gray-400 mt-1">3 hours ago</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="p-4 border-t border-gray-200">
            <button onclick="clearNotifications()" class="text-sm text-blue-600 hover:text-blue-800">Clear all notifications</button>
        </div>
    </div>

    <!-- Settings Panel -->
    <div id="settings-panel" class="fixed top-16 right-4 w-96 bg-white rounded-lg shadow-lg border border-gray-200 z-50 hidden">
        <div class="p-4 border-b border-gray-200">
            <div class="flex items-center justify-between">
                <h3 class="font-semibold text-gray-900">Dashboard Settings</h3>
                <button onclick="toggleSettings()" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
        </div>
        <div class="max-h-96 overflow-y-auto p-4 space-y-4">
            <!-- Duo Plus Integration -->
            <div class="border-b border-gray-200 pb-4">
                <h4 class="font-medium text-gray-900 mb-3">Duo Plus Integration</h4>
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email Integration</label>
                        <input type="email" id="duo-email" placeholder="your-email@domain.com" 
                               class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                        <button onclick="testEmailIntegration()" class="mt-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                            Test Email
                        </button>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Android VM</label>
                        <input type="text" id="android-vm" placeholder="192.168.1.100:5555" 
                               class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                        <button onclick="testAndroidVM()" class="mt-2 bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700">
                            Test Connection
                        </button>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Proxy Server</label>
                        <input type="text" id="proxy-server" placeholder="http://proxy.example.com:8080" 
                               class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                        <button onclick="testProxy()" class="mt-2 bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700">
                            Test Proxy
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- R2 Bucket Integration -->
            <div class="border-b border-gray-200 pb-4">
                <h4 class="font-medium text-gray-900 mb-3">R2 Bucket Storage</h4>
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Bucket Name</label>
                        <input type="text" id="r2-bucket" placeholder="duo-automation-storage" value="duo-automation-storage"
                               class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Access Key ID</label>
                        <input type="text" id="r2-access-key" placeholder="R2_ACCESS_KEY_ID" 
                               class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Secret Access Key</label>
                        <input type="password" id="r2-secret-key" placeholder="R2_SECRET_ACCESS_KEY" 
                               class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="testR2Connection()" class="bg-orange-600 text-white px-3 py-1 rounded text-sm hover:bg-orange-700">
                            Test R2
                        </button>
                        <button onclick="getR2Stats()" class="bg-teal-600 text-white px-3 py-1 rounded text-sm hover:bg-teal-700">
                            Get Stats
                        </button>
                        <button onclick="listR2Files()" class="bg-indigo-600 text-white px-3 py-1 rounded text-sm hover:bg-indigo-700">
                            List Files
                        </button>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Upload File</label>
                        <input type="file" id="r2-file-upload" class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                        <input type="text" id="r2-file-key" placeholder="folder/filename.ext" 
                               class="w-full p-2 border border-gray-300 rounded-lg text-sm mt-2">
                        <button onclick="uploadToR2()" class="mt-2 bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700">
                            Upload to R2
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Dashboard Settings -->
            <div>
                <h4 class="font-medium text-gray-900 mb-3">Dashboard Preferences</h4>
                <div class="space-y-3">
                    <div class="flex items-center justify-between">
                        <label class="text-sm font-medium text-gray-700">Auto-refresh</label>
                        <input type="checkbox" id="auto-refresh" checked class="w-4 h-4 text-blue-600 rounded">
                    </div>
                    <div class="flex items-center justify-between">
                        <label class="text-sm font-medium text-gray-700">Sound alerts</label>
                        <input type="checkbox" id="sound-alerts" class="w-4 h-4 text-blue-600 rounded">
                    </div>
                    <div class="flex items-center justify-between">
                        <label class="text-sm font-medium text-gray-700">Compact mode</label>
                        <input type="checkbox" id="compact-mode" class="w-4 h-4 text-blue-600 rounded">
                    </div>
                </div>
            </div>
        </div>
        <div class="p-4 border-t border-gray-200">
            <button onclick="saveSettings()" class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                Save Settings
            </button>
        </div>
    </div>
    <div class="fixed bottom-6 right-6 floating-action">
        <button onclick="toggleQuickActions()" class="bg-blue-600 text-white p-4 rounded-full shadow-lg hover:bg-blue-700 transition-all hover:scale-110">
            <i data-lucide="plus" class="w-6 h-6"></i>
        </button>
        
        <!-- Quick Actions Menu -->
        <div id="quick-actions" class="absolute bottom-16 right-0 bg-white rounded-lg shadow-lg border border-gray-200 w-48 hidden">
            <div class="py-2">
                <button onclick="quickTestAPI()" class="w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center space-x-2">
                    <i data-lucide="play" class="w-4 h-4"></i>
                    <span>Quick API Test</span>
                </button>
                <button onclick="refreshDashboard()" class="w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center space-x-2">
                    <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                    <span>Refresh Dashboard</span>
                </button>
                <button onclick="generateReport()" class="w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center space-x-2">
                    <i data-lucide="file-text" class="w-4 h-4"></i>
                    <span>Generate Report</span>
                </button>
                <button onclick="toggleSettings()" class="w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center space-x-2">
                    <i data-lucide="settings" class="w-4 h-4"></i>
                    <span>Settings</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        const API_BASE = 'http://localhost:3002';
        let autoScroll = true;
        let performanceChart = null;
        let distributionChart = null;
        let responseTimeHistogram = null;
        let statusCodeChart = null;
        let trafficPatternChart = null;
        let logEntries = [];
        let currentChartType = 'line';
        let isDarkMode = false;
        let notifications = [];
        let securityScanInProgress = false;
        let r2StorageChart = null;
        let r2FileTypesChart = null;
        let r2Files = [];
        let r2CurrentPage = 1;
        let r2FilesPerPage = 10;

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', () => {
            updateParameterInputs();
            document.getElementById('endpoint-select').addEventListener('change', updateParameterInputs);
            
            // Initialize charts
            initializePerformanceChart();
            initializeDistributionChart();
            initializeAnalyticsCharts();
            initializeR2Charts();
            
            // Start real-time updates
            startRealTimeUpdates();
            
            // Initialize server time
            updateServerTime();
            setInterval(updateServerTime, 1000);
            
            // Initialize system metrics
            updateSystemMetrics();
            setInterval(updateSystemMetrics, 3000);
        });

        // Real-time server time
        function updateServerTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', { hour12: false });
            const timeElement = document.getElementById('server-time');
            if (timeElement) {
                timeElement.textContent = timeString;
            }
        }

        // Initialize performance chart with enhanced features
        function initializePerformanceChart() {
            const ctx = document.getElementById('performanceChart');
            if (!ctx) return;
            
            performanceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 20}, (_, i) => `${19-i}s ago`).reverse(),
                    datasets: [{
                        label: 'Response Time (ms)',
                        data: Array.from({length: 20}, () => 40 + Math.random() * 20),
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'Request Rate (req/min)',
                        data: Array.from({length: 20}, () => 200 + Math.random() * 100),
                        borderColor: 'rgb(34, 197, 94)',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'CPU Usage (%)',
                        data: Array.from({length: 20}, () => 10 + Math.random() * 15),
                        borderColor: 'rgb(168, 85, 247)',
                        backgroundColor: 'rgba(168, 85, 247, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += context.parsed.y.toFixed(1);
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        // Initialize analytics charts
        function initializeAnalyticsCharts() {
            // Response Time Histogram
            const histogramCtx = document.getElementById('responseTimeHistogram');
            if (histogramCtx) {
                responseTimeHistogram = new Chart(histogramCtx, {
                    type: 'bar',
                    data: {
                        labels: ['0-10ms', '10-25ms', '25-50ms', '50-100ms', '100-200ms', '200ms+'],
                        datasets: [{
                            label: 'Request Count',
                            data: [1234, 3456, 5678, 2345, 890, 234],
                            backgroundColor: 'rgba(59, 130, 246, 0.8)'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // Status Code Chart
            const statusCodeCtx = document.getElementById('statusCodeChart');
            if (statusCodeCtx) {
                statusCodeChart = new Chart(statusCodeCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['200 OK', '201 Created', '400 Bad Request', '404 Not Found', '500 Server Error'],
                        datasets: [{
                            data: [85, 10, 3, 1.5, 0.5],
                            backgroundColor: [
                                'rgb(34, 197, 94)',
                                'rgb(59, 130, 246)',
                                'rgb(251, 146, 60)',
                                'rgb(239, 68, 68)',
                                'rgb(127, 29, 29)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'right'
                            }
                        }
                    }
                });
            }

            // Traffic Pattern Chart
            const trafficCtx = document.getElementById('trafficPatternChart');
            if (trafficCtx) {
                const hours = Array.from({length: 24}, (_, i) => `${i}:00`);
                trafficPatternChart = new Chart(trafficCtx, {
                    type: 'line',
                    data: {
                        labels: hours,
                        datasets: [{
                            label: 'Request Volume',
                            data: Array.from({length: 24}, () => Math.floor(Math.random() * 1000) + 500),
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        // Initialize distribution chart
        function initializeDistributionChart() {
            const ctx = document.getElementById('distributionChart');
            if (!ctx) return;
            
            distributionChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Phone Analysis', 'ML Prediction', 'Platform Analysis', 'Cross-Platform', 'Real-time', 'Batch Processing'],
                    datasets: [{
                        data: [35, 25, 20, 10, 7, 3],
                        backgroundColor: [
                            'rgb(59, 130, 246)',
                            'rgb(168, 85, 247)',
                            'rgb(34, 197, 94)',
                            'rgb(251, 146, 60)',
                            'rgb(236, 72, 153)',
                            'rgb(107, 114, 128)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
        }

        // Start real-time updates
        function startRealTimeUpdates() {
            // Update performance chart
            setInterval(() => {
                if (performanceChart) {
                    performanceChart.data.datasets[0].data.shift();
                    performanceChart.data.datasets[0].data.push(40 + Math.random() * 20);
                    performanceChart.data.datasets[1].data.shift();
                    performanceChart.data.datasets[1].data.push(200 + Math.random() * 100);
                    performanceChart.update('none');
                }
                
                // Update response time display
                const responseTimeElement = document.getElementById('response-time');
                if (responseTimeElement) {
                    responseTimeElement.textContent = `${Math.floor(40 + Math.random() * 20)}ms`;
                }
            }, 2000);

            // Simulate log entries
            setInterval(() => {
                if (Math.random() > 0.7) {
                    addLogEntry();
                }
            }, 3000);
        }

        // Add log entry
        function addLogEntry() {
            const messages = [
                '🔍 Phone analysis completed for +15551234567',
                '⚠️ Rate limit check passed',
                '🤖 ML prediction executed with model ensemble-v1',
                '📊 Metrics updated successfully',
                '🛡️ Authentication verified for API key',
                '⚡ Cache hit for dashboard metrics',
                '🌐 Cross-platform correlation completed',
                '📦 Batch job status checked'
            ];
            
            const now = new Date();
            const timestamp = now.toLocaleString('en-US', { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit', 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit',
                hour12: false 
            });
            
            const message = messages[Math.floor(Math.random() * messages.length)];
            const logEntry = `[${timestamp}] ${message}`;
            
            logEntries.push(logEntry);
            
            const logsContainer = document.getElementById('server-logs');
            if (logsContainer) {
                const newLog = document.createElement('div');
                newLog.textContent = logEntry;
                newLog.className = 'text-green-400';
                logsContainer.appendChild(newLog);
                
                // Keep only last 50 entries
                while (logsContainer.children.length > 50) {
                    logsContainer.removeChild(logsContainer.firstChild);
                }
                
                // Auto scroll
                if (autoScroll) {
                    logsContainer.scrollTop = logsContainer.scrollHeight;
                }
                
                // Update log count
                const logCount = document.getElementById('log-count');
                if (logCount) {
                    logCount.textContent = logsContainer.children.length;
                }
                
                // Update last log time
                const lastLogTime = document.getElementById('last-log-time');
                if (lastLogTime) {
                    lastLogTime.textContent = 'Just now';
                }
            }
        }

        // Tab switching
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('tab-active');
                btn.classList.add('text-gray-500', 'hover:text-gray-700');
            });
            
            // Show selected tab
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
            
            // Add active class to selected tab button
            const activeBtn = document.querySelector(`[data-tab="${tabName}"]`);
            activeBtn.classList.add('tab-active');
            activeBtn.classList.remove('text-gray-500', 'hover:text-gray-700');
            
            // Re-initialize icons for the new tab
            setTimeout(() => lucide.createIcons(), 100);
        }

        // API Testing
        function updateParameterInputs() {
            const endpoint = document.getElementById('endpoint-select').value;
            const container = document.getElementById('parameter-inputs');
            
            let inputsHTML = '';
            
            switch(endpoint) {
                case 'phone-analysis':
                    inputsHTML = `
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                            <input type="text" id="param-phone" placeholder="+15551234567" 
                                   class="w-full p-2 border border-gray-300 rounded-lg" 
                                   value="+15551234567">
                            <p class="text-xs text-gray-500 mt-1">Test numbers: +15551234567 (LOW), +15551112222 (MEDIUM), +15559876543 (HIGH)</p>
                        </div>
                    `;
                    break;
                case 'phone-risk':
                    inputsHTML = `
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                            <input type="text" id="param-phone" placeholder="+15551234567" 
                                   class="w-full p-2 border border-gray-300 rounded-lg" 
                                   value="+15559876543">
                        </div>
                    `;
                    break;
                case 'ml-prediction':
                    inputsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                                <input type="text" id="param-phone" placeholder="+15551234567" 
                                       class="w-full p-2 border border-gray-300 rounded-lg" 
                                       value="+15551234567">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ML Model</label>
                                <select id="param-model" class="w-full p-2 border border-gray-300 rounded-lg">
                                    <option value="ensemble-v1">Ensemble v1 (94% accuracy)</option>
                                    <option value="neural-v2">Neural v2 (96% accuracy)</option>
                                    <option value="gradient-boost">Gradient Boost (92% accuracy)</option>
                                </select>
                            </div>
                        </div>
                    `;
                    break;
                case 'identity-graph':
                    inputsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                                <input type="text" id="param-phone" placeholder="+15551234567" 
                                       class="w-full p-2 border border-gray-300 rounded-lg" 
                                       value="+15551234567">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Graph Depth</label>
                                <input type="number" id="param-depth" placeholder="2" min="1" max="5"
                                       class="w-full p-2 border border-gray-300 rounded-lg" 
                                       value="3">
                            </div>
                        </div>
                    `;
                    break;
                case 'realtime-alerts':
                    inputsHTML = `
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Alert Severity</label>
                            <select id="param-severity" class="w-full p-2 border border-gray-300 rounded-lg">
                                <option value="">All Alerts</option>
                                <option value="critical">Critical Only</option>
                                <option value="warning">Warning Only</option>
                                <option value="info">Info Only</option>
                            </select>
                        </div>
                    `;
                    break;
                case 'platform-analysis':
                    inputsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Version</label>
                                <select id="param-version" class="w-full p-2 border border-gray-300 rounded-lg">
                                    <option value="1">v1</option>
                                    <option value="2">v2</option>
                                    <option value="3">v3</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Platform</label>
                                <select id="param-platform" class="w-full p-2 border border-gray-300 rounded-lg">
                                    <option value="cashapp">Cash App</option>
                                    <option value="venmo">Venmo</option>
                                    <option value="paypal">PayPal</option>
                                    <option value="zelle">Zelle</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">User ID</label>
                                <input type="text" id="param-userId" placeholder="johnsmith" 
                                       class="w-full p-2 border border-gray-300 rounded-lg" 
                                       value="johnsmith">
                            </div>
                        </div>
                    `;
                    break;
            }
            
            container.innerHTML = inputsHTML;
        }

        // Log management functions
        function clearLogs() {
            const logsContainer = document.getElementById('server-logs');
            if (logsContainer) {
                logsContainer.innerHTML = '<div class="text-yellow-400">[System] Logs cleared</div>';
                logEntries = [];
                
                const logCount = document.getElementById('log-count');
                if (logCount) {
                    logCount.textContent = '0';
                }
            }
        }

        function toggleAutoScroll() {
            autoScroll = !autoScroll;
            const autoScrollText = document.getElementById('auto-scroll-text');
            if (autoScrollText) {
                autoScrollText.textContent = autoScroll ? 'Auto Scroll: ON' : 'Auto Scroll: OFF';
            }
        }

        function filterLogs() {
            const level = document.getElementById('log-level')?.value;
            // In a real implementation, this would filter logs by level
            console.log('Filtering logs by level:', level);
        }

        // Enhanced API testing with response time tracking
        async function testAPI() {
            const endpoint = document.getElementById('endpoint-select').value;
            const apiKey = document.getElementById('api-key-select').value;
            const responseContainer = document.getElementById('response-container');
            
            let url = '';
            let method = 'GET';
            
            // Build URL based on endpoint
            switch(endpoint) {
                case 'phone-analysis':
                    const phone = document.getElementById('param-phone')?.value || '+15551234567';
                    url = `${API_BASE}/api/analyze/phone/${phone}`;
                    break;
                case 'phone-risk':
                    const riskPhone = document.getElementById('param-phone')?.value || '+15559876543';
                    url = `${API_BASE}/api/analyze/phone/${riskPhone}/risk`;
                    break;
                case 'ml-prediction':
                    const mlPhone = document.getElementById('param-phone')?.value || '+15551234567';
                    const model = document.getElementById('param-model')?.value || 'ensemble-v1';
                    url = `${API_BASE}/api/ml/predict/risk/${mlPhone}/${model}`;
                    break;
                case 'identity-graph':
                    const graphPhone = document.getElementById('param-phone')?.value || '+15551234567';
                    const depth = document.getElementById('param-depth')?.value || '3';
                    url = `${API_BASE}/api/cross-platform/graph/${graphPhone}/${depth}`;
                    break;
                case 'realtime-alerts':
                    const severity = document.getElementById('param-severity')?.value;
                    url = severity ? `${API_BASE}/api/realtime/alerts/${severity}` : `${API_BASE}/api/realtime/alerts`;
                    break;
                case 'platform-analysis':
                    const version = document.getElementById('param-version')?.value || '1';
                    const platform = document.getElementById('param-platform')?.value || 'cashapp';
                    const userId = document.getElementById('param-userId')?.value || 'johnsmith';
                    url = `${API_BASE}/api/v${version}/platform/${platform}/users/${userId}`;
                    break;
            }
            
            // Show loading
            responseContainer.innerHTML = '<p class="text-yellow-400">🚀 Sending request...</p>';
            
            // Add log entry
            const logMessage = `🌐 ${method} ${url} (API Key: ${apiKey || 'none'})`;
            addCustomLogEntry(logMessage);
            
            try {
                const headers = {
                    'Content-Type': 'application/json'
                };
                
                if (apiKey) {
                    headers['X-API-Key'] = apiKey;
                }
                
                const startTime = Date.now();
                const response = await fetch(url, { method, headers });
                const endTime = Date.now();
                
                const data = await response.json();
                const duration = endTime - startTime;
                
                // Format response with enhanced details
                const responseText = `✅ Request Successful!\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n📡 Request Details:\n  Method: ${method}\n  URL: ${url}\n  Status: ${response.status} ${response.statusText}\n  Duration: ${duration}ms\n  API Key: ${apiKey || 'none'}\n\n📊 Performance Metrics:\n  Response Time: ${duration}ms\n  Status Code: ${response.status}\n  Content-Type: ${response.headers.get('content-type') || 'application/json'}\n\n📦 Response Data:\n${JSON.stringify(data, null, 2)}`;
                
                responseContainer.innerHTML = `<pre class="text-green-400">${responseText}</pre>`;
                
                // Add success log
                addCustomLogEntry(`✅ Response received (${duration}ms): ${response.status}`);
                
                // Update metrics if successful
                if (response.ok) {
                    updateMetrics(duration);
                }
                
            } catch (error) {
                const errorText = `❌ Request Failed\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n🚫 Error Details:\n  Message: ${error.message}\n  URL: ${url}\n  Method: ${method}\n\n💡 Troubleshooting:\n  • Ensure server is running on ${API_BASE}\n  • Check network connectivity\n  • Verify endpoint exists\n  • Start server with: bun examples/urlpattern-routing-demo.ts`;
                
                responseContainer.innerHTML = `<pre class="text-red-400">${errorText}</pre>`;
                
                // Add error log
                addCustomLogEntry(`❌ Request failed: ${error.message}`);
            }
        }

        // Add custom log entry
        function addCustomLogEntry(message) {
            const now = new Date();
            const timestamp = now.toLocaleString('en-US', { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit', 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit',
                hour12: false 
            });
            
            const logEntry = `[${timestamp}] ${message}`;
            
            const logsContainer = document.getElementById('server-logs');
            if (logsContainer) {
                const newLog = document.createElement('div');
                newLog.textContent = logEntry;
                newLog.className = message.includes('❌') ? 'text-red-400' : 
                                  message.includes('✅') ? 'text-green-400' : 
                                  message.includes('⚠️') ? 'text-yellow-400' : 'text-blue-400';
                logsContainer.appendChild(newLog);
                
                // Keep only last 50 entries
                while (logsContainer.children.length > 50) {
                    logsContainer.removeChild(logsContainer.firstChild);
                }
                
                // Auto scroll
                if (autoScroll) {
                    logsContainer.scrollTop = logsContainer.scrollHeight;
                }
                
                // Update log count
                const logCount = document.getElementById('log-count');
                if (logCount) {
                    logCount.textContent = logsContainer.children.length;
                }
            }
        }

        // Update metrics
        function updateMetrics(responseTime) {
            // Update response time display
            const responseTimeElement = document.getElementById('response-time');
            if (responseTimeElement) {
                responseTimeElement.textContent = `${responseTime}ms`;
            }
            
            // Update chart if available
            if (performanceChart) {
                performanceChart.data.datasets[0].data.shift();
                performanceChart.data.datasets[0].data.push(responseTime);
                performanceChart.update('none');
            }
        }

        function clearResponse() {
            document.getElementById('response-container').innerHTML = '<p class="text-gray-500">Response will appear here...</p>';
        }

        function refreshAlerts() {
            // Simulate refreshing alerts
            const alertsContainer = document.getElementById('alerts-container');
            alertsContainer.style.opacity = '0.5';
            
            setTimeout(() => {
                alertsContainer.style.opacity = '1';
                // In a real implementation, this would fetch fresh alerts from the API
            }, 500);
        }

        // Update system metrics
        function updateSystemMetrics() {
            // Update CPU usage
            const cpuElement = document.getElementById('cpu-usage');
            if (cpuElement) {
                const cpuUsage = (8 + Math.random() * 12).toFixed(1);
                cpuElement.textContent = `${cpuUsage}%`;
            }
            
            // Update memory usage
            const memoryElement = document.getElementById('memory-usage');
            if (memoryElement) {
                const memoryUsage = Math.floor(200 + Math.random() * 150);
                memoryElement.textContent = `${memoryUsage}MB`;
            }
        }

        // Toggle chart type
        function toggleChartType() {
            if (!performanceChart) return;
            
            currentChartType = currentChartType === 'line' ? 'bar' : 'line';
            performanceChart.config.type = currentChartType;
            performanceChart.update();
        }

        // Toggle fullscreen
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // Enhanced theme toggle
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark');
            
            // Update chart colors for dark mode
            const textColor = isDarkMode ? '#3b82f6' : '#3b82f6';
            const gridColor = isDarkMode ? '#3b82f6' : '#3b82f6';
            
            [performanceChart, distributionChart, responseTimeHistogram, statusCodeChart, trafficPatternChart].forEach(chart => {
                if (chart) {
                    chart.options.plugins.legend.labels.color = textColor;
                    if (chart.options.scales?.x) {
                        chart.options.scales.x.ticks.color = textColor;
                        chart.options.scales.x.grid.color = gridColor;
                    }
                    if (chart.options.scales?.y) {
                        chart.options.scales.y.ticks.color = textColor;
                        chart.options.scales.y.grid.color = gridColor;
                    }
                    chart.update();
                }
            });
            
            // Update icon
            const themeIcon = document.querySelector('button[onclick="toggleTheme()"] i');
            if (themeIcon) {
                themeIcon.setAttribute('data-lucide', isDarkMode ? 'sun' : 'moon');
                lucide.createIcons();
            }
        }

        // Export data functionality
        function exportData() {
            const exportData = {
                timestamp: new Date().toISOString(),
                metrics: {
                    totalRequests: '2.4M',
                    avgResponseTime: '42ms',
                    errorRate: '0.12%',
                    throughput: '1,847 req/s'
                },
                endpoints: [
                    { path: '/api/analyze/phone/:phone', requests: 847392, avgResponse: '38ms', successRate: '99.9%' },
                    { path: '/api/ml/predict/risk/:phone', requests: 623447, avgResponse: '95ms', successRate: '99.7%' },
                    { path: '/api/v1/platform/:platform/users', requests: 412893, avgResponse: '42ms', successRate: '99.8%' }
                ],
                logs: logEntries.slice(-50) // Last 50 log entries
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `dashboard-export-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            // Show success message
            addCustomLogEntry('📊 Dashboard data exported successfully');
        }

        // Update analytics based on timeframe
        function updateAnalytics() {
            const timeframe = document.getElementById('analytics-timeframe')?.value;
            addCustomLogEntry(`📈 Analytics updated for timeframe: ${timeframe}`);
            
            // In a real implementation, this would fetch new data based on timeframe
            // For now, we'll just simulate it with random variations
            if (responseTimeHistogram) {
                responseTimeHistogram.data.datasets[0].data = responseTimeHistogram.data.datasets[0].data.map(
                    val => Math.floor(val * (0.8 + Math.random() * 0.4))
                );
                responseTimeHistogram.update();
            }
        }

        // Refresh analytics
        function refreshAnalytics() {
            addCustomLogEntry('🔄 Refreshing analytics data...');
            
            // Simulate data refresh
            setTimeout(() => {
                updateAnalytics();
                addCustomLogEntry('✅ Analytics data refreshed');
            }, 1000);
        }

        // Toggle notifications panel
        function toggleNotifications() {
            const panel = document.getElementById('notification-panel');
            panel.classList.toggle('hidden');
            
            // Clear notification badge when opened
            if (!panel.classList.contains('hidden')) {
                const badge = document.getElementById('notification-badge');
                if (badge) {
                    badge.style.display = 'none';
                }
            }
        }

        // Clear all notifications
        function clearNotifications() {
            notifications = [];
            const badge = document.getElementById('notification-badge');
            if (badge) {
                badge.style.display = 'none';
            }
            addCustomLogEntry('📢 All notifications cleared');
            toggleNotifications();
        }

        // Toggle quick actions menu
        function toggleQuickActions() {
            const menu = document.getElementById('quick-actions');
            menu.classList.toggle('hidden');
        }

        // Quick API test
        function quickTestAPI() {
            switchTab('test');
            // Auto-select first endpoint and test
            setTimeout(() => {
                testAPI();
            }, 500);
            toggleQuickActions();
        }

        // Refresh dashboard
        function refreshDashboard() {
            addCustomLogEntry('🔄 Refreshing dashboard...');
            
            // Refresh all charts
            [performanceChart, distributionChart, responseTimeHistogram, statusCodeChart, trafficPatternChart].forEach(chart => {
                if (chart) {
                    chart.update();
                }
            });
            
            // Update metrics
            updateSystemMetrics();
            updateAnalytics();
            
            setTimeout(() => {
                addCustomLogEntry('✅ Dashboard refreshed successfully');
            }, 1000);
            
            toggleQuickActions();
        }

        // Generate report
        function generateReport() {
            addCustomLogEntry('📊 Generating comprehensive report...');
            
            const report = {
                timestamp: new Date().toISOString(),
                summary: {
                    totalRequests: '2.4M',
                    avgResponseTime: '42ms',
                    errorRate: '0.12%',
                    uptime: '99.8%',
                    securityScore: 'A+'
                },
                topEndpoints: [
                    { path: '/api/analyze/phone/:phone', usage: '847,392 requests', successRate: '99.9%' },
                    { path: '/api/ml/predict/risk/:phone', usage: '623,447 requests', successRate: '99.7%' },
                    { path: '/api/v1/platform/:platform/users', usage: '412,893 requests', successRate: '99.8%' }
                ],
                securityMetrics: {
                    threatsBlocked: '1,247',
                    firewallStatus: 'Active',
                    sslCertificate: 'Valid',
                    lastScan: 'No vulnerabilities detected'
                },
                performanceMetrics: {
                    cpuUsage: '12%',
                    memoryUsage: '256MB',
                    responseTime: '45ms',
                    requestRate: '1,847 req/s'
                }
            };
            
            const reportStr = JSON.stringify(report, null, 2);
            const reportBlob = new Blob([reportStr], { type: 'application/json' });
            const reportUrl = URL.createObjectURL(reportBlob);
            
            const link = document.createElement('a');
            link.href = reportUrl;
            link.download = `dashboard-report-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(reportUrl);
            
            addCustomLogEntry('📊 Report generated and downloaded');
            toggleQuickActions();
        }

        // Open settings (now functional)
        function toggleSettings() {
            const panel = document.getElementById('settings-panel');
            panel.classList.toggle('hidden');
            
            // Load saved settings
            loadSettings();
        }

        // Test Email Integration
        async function testEmailIntegration() {
            const email = document.getElementById('duo-email').value;
            if (!email) {
                addCustomLogEntry('❌ Please enter an email address');
                return;
            }
            
            addCustomLogEntry(`📧 Testing email integration for: ${email}`);
            
            // Simulate email test
            setTimeout(() => {
                addCustomLogEntry('✅ Email integration test successful');
                showNotification('Email Test', 'Integration working correctly', 'success');
            }, 2000);
        }

        // Test Android VM Connection
        async function testAndroidVM() {
            const vmAddress = document.getElementById('android-vm').value;
            if (!vmAddress) {
                addCustomLogEntry('❌ Please enter Android VM address');
                return;
            }
            
            addCustomLogEntry(`📱 Testing Android VM connection: ${vmAddress}`);
            
            try {
                // Simulate VM connection test
                const response = await fetch(`${API_BASE}/api/test/android-vm`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': 'demo-key-super-admin'
                    },
                    body: JSON.stringify({ address: vmAddress })
                });
                
                if (response.ok) {
                    addCustomLogEntry('✅ Android VM connection successful');
                    showNotification('VM Connection', 'Android VM is reachable', 'success');
                } else {
                    addCustomLogEntry('❌ Android VM connection failed');
                }
            } catch (error) {
                // Fallback simulation
                setTimeout(() => {
                    addCustomLogEntry('✅ Android VM connection simulated successful');
                    showNotification('VM Connection', 'Android VM test completed', 'success');
                }, 1500);
            }
        }

        // Test Proxy Server
        async function testProxy() {
            const proxyUrl = document.getElementById('proxy-server').value;
            if (!proxyUrl) {
                addCustomLogEntry('❌ Please enter proxy server URL');
                return;
            }
            
            addCustomLogEntry(`🌐 Testing proxy server: ${proxyUrl}`);
            
            try {
                // Simulate proxy test
                const response = await fetch(`${API_BASE}/api/test/proxy`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': 'demo-key-super-admin'
                    },
                    body: JSON.stringify({ proxy: proxyUrl })
                });
                
                if (response.ok) {
                    addCustomLogEntry('✅ Proxy server test successful');
                    showNotification('Proxy Test', 'Proxy server is working', 'success');
                } else {
                    addCustomLogEntry('❌ Proxy server test failed');
                }
            } catch (error) {
                // Fallback simulation
                setTimeout(() => {
                    addCustomLogEntry('✅ Proxy server test simulated successful');
                    showNotification('Proxy Test', 'Proxy test completed', 'success');
                }, 1500);
            }
        }

        // Load settings from localStorage
        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('dashboard-settings') || '{}');
            
            if (settings.duoEmail) {
                document.getElementById('duo-email').value = settings.duoEmail;
            }
            if (settings.androidVM) {
                document.getElementById('android-vm').value = settings.androidVM;
            }
            if (settings.proxyServer) {
                document.getElementById('proxy-server').value = settings.proxyServer;
            }
            if (settings.r2Bucket) {
                document.getElementById('r2-bucket').value = settings.r2Bucket;
            }
            if (settings.r2AccessKey) {
                document.getElementById('r2-access-key').value = settings.r2AccessKey;
            }
            if (settings.r2SecretKey) {
                document.getElementById('r2-secret-key').value = settings.r2SecretKey;
            }
            if (settings.autoRefresh !== undefined) {
                document.getElementById('auto-refresh').checked = settings.autoRefresh;
            }
            if (settings.soundAlerts !== undefined) {
                document.getElementById('sound-alerts').checked = settings.soundAlerts;
            }
            if (settings.compactMode !== undefined) {
                document.getElementById('compact-mode').checked = settings.compactMode;
            }
        }

        // Save settings to localStorage
        function saveSettings() {
            const settings = {
                duoEmail: document.getElementById('duo-email').value,
                androidVM: document.getElementById('android-vm').value,
                proxyServer: document.getElementById('proxy-server').value,
                r2Bucket: document.getElementById('r2-bucket').value,
                r2AccessKey: document.getElementById('r2-access-key').value,
                r2SecretKey: document.getElementById('r2-secret-key').value,
                autoRefresh: document.getElementById('auto-refresh').checked,
                soundAlerts: document.getElementById('sound-alerts').checked,
                compactMode: document.getElementById('compact-mode').checked
            };
            
            localStorage.setItem('dashboard-settings', JSON.stringify(settings));
            addCustomLogEntry('✅ Settings saved successfully');
            showNotification('Settings Saved', 'Your preferences have been saved', 'success');
            
            // Apply compact mode if enabled
            if (settings.compactMode) {
                document.body.classList.add('compact-mode');
            } else {
                document.body.classList.remove('compact-mode');
            }
        }
        
        // R2 Bucket Integration Functions
        async function testR2Connection() {
            const bucket = document.getElementById('r2-bucket').value;
            const accessKey = document.getElementById('r2-access-key').value;
            const secretKey = document.getElementById('r2-secret-key').value;
            
            if (!bucket || !accessKey || !secretKey) {
                addCustomLogEntry('❌ Please fill in all R2 credentials');
                return;
            }
            
            addCustomLogEntry(`🔗 Testing R2 connection to bucket: ${bucket}`);
            
            try {
                const response = await fetch(`${API_BASE}/api/r2/stats`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': 'demo-key-super-admin'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    addCustomLogEntry('✅ R2 connection successful');
                    showNotification('R2 Connection', 'Successfully connected to R2 bucket', 'success');
                } else {
                    addCustomLogEntry('❌ R2 connection failed');
                }
            } catch (error) {
                // Fallback simulation
                setTimeout(() => {
                    addCustomLogEntry('✅ R2 connection simulated successful');
                    showNotification('R2 Connection', 'R2 bucket test completed', 'success');
                }, 1000);
            }
        }
        
        async function getR2Stats() {
            addCustomLogEntry('📊 Fetching R2 bucket statistics...');
            
            try {
                const response = await fetch(`${API_BASE}/api/r2/stats`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': 'demo-key-super-admin'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const stats = data.data;
                    addCustomLogEntry(`📊 R2 Stats: ${stats.usage.totalFiles} files, ${stats.usage.totalSize} used, ${stats.storage.utilizationPercent * 100}% utilization`);
                    showNotification('R2 Stats', `Bucket: ${stats.bucket.name}, Files: ${stats.usage.totalFiles}`, 'success');
                } else {
                    addCustomLogEntry('❌ Failed to fetch R2 stats');
                }
            } catch (error) {
                addCustomLogEntry('❌ Error fetching R2 stats');
            }
        }
        
        async function listR2Files() {
            addCustomLogEntry('📁 Listing R2 bucket files...');
            
            try {
                const response = await fetch(`${API_BASE}/api/r2/files`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': 'demo-key-super-admin'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const files = data.data.files;
                    addCustomLogEntry(`📁 Found ${files.length} files in R2 bucket`);
                    
                    files.forEach(file => {
                        addCustomLogEntry(`  📄 ${file.key} (${(file.size / 1024).toFixed(1)}KB)`);
                    });
                    
                    showNotification('R2 Files', `Found ${files.length} files in bucket`, 'success');
                } else {
                    addCustomLogEntry('❌ Failed to list R2 files');
                }
            } catch (error) {
                addCustomLogEntry('❌ Error listing R2 files');
            }
        }
        
        async function uploadToR2() {
            const fileInput = document.getElementById('r2-file-upload');
            const fileKey = document.getElementById('r2-file-key').value;
            
            if (!fileInput.files[0]) {
                addCustomLogEntry('❌ Please select a file to upload');
                return;
            }
            
            if (!fileKey) {
                addCustomLogEntry('❌ Please specify a file key/path');
                return;
            }
            
            const file = fileInput.files[0];
            addCustomLogEntry(`📤 Uploading ${file.name} to R2 as ${fileKey}...`);
            
            try {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('key', fileKey);
                
                const response = await fetch(`${API_BASE}/api/r2/upload`, {
                    method: 'POST',
                    headers: {
                        'X-API-Key': 'demo-key-super-admin'
                    },
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.success) {
                    addCustomLogEntry(`✅ File uploaded successfully: ${data.data.key}`);
                    showNotification('Upload Success', `File uploaded to R2: ${data.data.key}`, 'success');
                    
                    // Clear form
                    document.getElementById('r2-file-upload').value = '';
                    document.getElementById('r2-file-key').value = '';
                } else {
                    addCustomLogEntry('❌ Failed to upload file to R2');
                }
            } catch (error) {
                addCustomLogEntry('❌ Error uploading file to R2');
            }
        }
        
        // R2 Storage Tab Functions
        function initializeR2Charts() {
            // Storage Usage Chart
            const storageCtx = document.getElementById('r2-storage-chart');
            if (storageCtx) {
                r2StorageChart = new Chart(storageCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Used', 'Available'],
                        datasets: [{
                            data: [2.4, 976.6],
                            backgroundColor: ['#10b981', '#3b82f6'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.label + ': ' + context.parsed + 'GB';
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            // File Types Distribution Chart
            const fileTypesCtx = document.getElementById('r2-filetypes-chart');
            if (fileTypesCtx) {
                r2FileTypesChart = new Chart(fileTypesCtx, {
                    type: 'bar',
                    data: {
                        labels: ['JSON', 'CSV', 'PDF', 'GZIP', 'Text', 'Other'],
                        datasets: [{
                            label: 'Files',
                            data: [342, 267, 189, 145, 178, 126],
                            backgroundColor: '#3b82f6'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }
        }
        
        async function refreshR2Stats() {
            addCustomLogEntry('📊 Refreshing R2 storage statistics...');
            
            try {
                const response = await fetch(`${API_BASE}/api/r2/stats`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': 'demo-key-super-admin'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const stats = data.data;
                    
                    // Update overview cards
                    document.getElementById('r2-total-files').textContent = stats.usage.totalFiles.toLocaleString();
                    document.getElementById('r2-storage-used').textContent = stats.usage.totalSize;
                    document.getElementById('r2-uploads-today').textContent = stats.usage.uploadsToday;
                    document.getElementById('r2-downloads-today').textContent = stats.usage.downloadsToday;
                    
                    // Update storage chart
                    if (r2StorageChart) {
                        const usedGB = parseFloat(stats.storage.used);
                        const availableGB = parseFloat(stats.storage.available);
                        r2StorageChart.data.datasets[0].data = [usedGB, availableGB];
                        r2StorageChart.update();
                    }
                    
                    addCustomLogEntry('✅ R2 statistics refreshed successfully');
                    showNotification('R2 Stats', 'Storage statistics updated', 'success');
                } else {
                    addCustomLogEntry('❌ Failed to refresh R2 stats');
                }
            } catch (error) {
                addCustomLogEntry('❌ Error refreshing R2 statistics');
            }
        }
        
        async function refreshR2Files() {
            addCustomLogEntry('📁 Refreshing R2 file list...');
            
            try {
                const response = await fetch(`${API_BASE}/api/r2/files`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': 'demo-key-super-admin'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    r2Files = data.data.files;
                    r2CurrentPage = 1;
                    displayR2Files();
                    addCustomLogEntry(`✅ Loaded ${r2Files.length} files from R2`);
                    showNotification('R2 Files', `Found ${r2Files.length} files`, 'success');
                } else {
                    addCustomLogEntry('❌ Failed to load R2 files');
                }
            } catch (error) {
                addCustomLogEntry('❌ Error loading R2 files');
            }
        }
        
        function displayR2Files() {
            const tbody = document.getElementById('r2-files-table');
            const startIndex = (r2CurrentPage - 1) * r2FilesPerPage;
            const endIndex = startIndex + r2FilesPerPage;
            const pageFiles = r2Files.slice(startIndex, endIndex);
            
            tbody.innerHTML = '';
            
            pageFiles.forEach(file => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                
                const fileSize = file.size > 1024 * 1024 
                    ? (file.size / (1024 * 1024)).toFixed(1) + 'MB'
                    : (file.size / 1024).toFixed(1) + 'KB';
                
                const fileIcon = getFileIcon(file.contentType);
                
                row.innerHTML = `
                    <td class="px-4 py-2">
                        <div class="flex items-center">
                            <i data-lucide="${fileIcon}" class="w-4 h-4 mr-2 text-gray-400"></i>
                            <span class="text-sm font-medium text-gray-900">${file.key}</span>
                        </div>
                    </td>
                    <td class="px-4 py-2 text-sm text-gray-600">${fileSize}</td>
                    <td class="px-4 py-2 text-sm text-gray-600">${file.contentType}</td>
                    <td class="px-4 py-2 text-sm text-gray-600">${new Date(file.lastModified).toLocaleDateString()}</td>
                    <td class="px-4 py-2">
                        <div class="flex space-x-2">
                            <button onclick="downloadR2File('${file.key}')" class="text-blue-600 hover:text-blue-800 text-sm">
                                <i data-lucide="download" class="w-4 h-4"></i>
                            </button>
                            <button onclick="deleteR2File('${file.key}')" class="text-red-600 hover:text-red-800 text-sm">
                                <i data-lucide="trash-2" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            // Update pagination info
            document.getElementById('r2-files-count').textContent = 
                `Showing ${startIndex + 1}-${Math.min(endIndex, r2Files.length)} of ${r2Files.length} files`;
            
            // Re-initialize Lucide icons
            lucide.createIcons();
        }
        
        function getFileIcon(contentType) {
            if (contentType.includes('json')) return 'file-text';
            if (contentType.includes('csv')) return 'table';
            if (contentType.includes('pdf')) return 'file-text';
            if (contentType.includes('gzip')) return 'archive';
            if (contentType.includes('text')) return 'file';
            return 'file';
        }
        
        async function downloadR2File(key) {
            addCustomLogEntry(`📥 Generating download URL for: ${key}`);
            
            try {
                const response = await fetch(`${API_BASE}/api/r2/download/${encodeURIComponent(key)}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': 'demo-key-super-admin'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Open signed URL in new tab
                    window.open(data.data.signedUrl, '_blank');
                    addCustomLogEntry(`✅ Download URL generated for: ${key}`);
                    showNotification('Download', 'File download started', 'success');
                } else {
                    addCustomLogEntry('❌ Failed to generate download URL');
                }
            } catch (error) {
                addCustomLogEntry('❌ Error generating download URL');
            }
        }
        
        async function deleteR2File(key) {
            if (!confirm(`Are you sure you want to delete ${key}?`)) {
                return;
            }
            
            addCustomLogEntry(`🗑️ Deleting file: ${key}`);
            
            try {
                const response = await fetch(`${API_BASE}/api/r2/delete/${encodeURIComponent(key)}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': 'demo-key-super-admin'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    addCustomLogEntry(`✅ File deleted: ${key}`);
                    showNotification('File Deleted', `${key} has been deleted`, 'success');
                    refreshR2Files();
                } else {
                    addCustomLogEntry('❌ Failed to delete file');
                }
            } catch (error) {
                addCustomLogEntry('❌ Error deleting file');
            }
        }
        
        function showR2UploadModal() {
            switchTab('settings');
            setTimeout(() => {
                const r2Section = document.getElementById('r2-bucket').closest('.border-b');
                r2Section.scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }
        
        function openR2Settings() {
            switchTab('settings');
            setTimeout(() => {
                const r2Section = document.getElementById('r2-bucket').closest('.border-b');
                r2Section.scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }
        
        function searchR2Files() {
            const searchTerm = document.getElementById('r2-search').value.toLowerCase();
            const filterType = document.getElementById('r2-filter-type').value;
            
            let filteredFiles = r2Files;
            
            if (searchTerm) {
                filteredFiles = filteredFiles.filter(file => 
                    file.key.toLowerCase().includes(searchTerm)
                );
            }
            
            if (filterType) {
                filteredFiles = filteredFiles.filter(file => 
                    file.contentType.includes(filterType)
                );
            }
            
            const originalFiles = r2Files;
            r2Files = filteredFiles;
            r2CurrentPage = 1;
            displayR2Files();
            r2Files = originalFiles;
            
            addCustomLogEntry(`🔍 Found ${filteredFiles.length} matching files`);
        }
        
        function previousR2Page() {
            if (r2CurrentPage > 1) {
                r2CurrentPage--;
                displayR2Files();
            }
        }
        
        function nextR2Page() {
            const totalPages = Math.ceil(r2Files.length / r2FilesPerPage);
            if (r2CurrentPage < totalPages) {
                r2CurrentPage++;
                displayR2Files();
            }
        }
        
        // Run security scan
        function runSecurityScan() {
            if (securityScanInProgress) return;
            
            securityScanInProgress = true;
            addCustomLogEntry('🔍 Starting security scan...');
            
            // Simulate security scan progress
            setTimeout(() => {
                addCustomLogEntry('🔍 Scanning endpoints...');
            }, 2000);
            
            setTimeout(() => {
                addCustomLogEntry('🔍 Checking authentication...');
            }, 4000);
            
            setTimeout(() => {
                addCustomLogEntry('🔍 Analyzing traffic patterns...');
            }, 6000);
            
            setTimeout(() => {
                addCustomLogEntry('✅ Security scan completed - No vulnerabilities found');
                securityScanInProgress = false;
                
                // Show success notification
                showNotification('Security Scan Complete', 'No vulnerabilities detected', 'success');
            }, 8000);
        }

        // Show notification
        function showNotification(title, message, type = 'info') {
            const colors = {
                success: 'bg-green-500',
                warning: 'bg-yellow-500',
                error: 'bg-red-500',
                info: 'bg-blue-500'
            };
            
            const notification = {
                title,
                message,
                type,
                timestamp: new Date().toISOString()
            };
            
            notifications.unshift(notification);
            
            // Update badge
            const badge = document.getElementById('notification-badge');
            if (badge) {
                badge.textContent = Math.min(notifications.length, 99);
                badge.style.display = 'flex';
            }
        }

        // Close menus when clicking outside
        document.addEventListener('click', (event) => {
            const notificationPanel = document.getElementById('notification-panel');
            const notificationButton = event.target.closest('button[onclick="toggleNotifications()"]');
            
            if (!notificationPanel.contains(event.target) && !notificationButton) {
                notificationPanel.classList.add('hidden');
            }
            
            const quickActions = document.getElementById('quick-actions');
            const quickActionsButton = event.target.closest('button[onclick="toggleQuickActions()"]');
            
            if (!quickActions.contains(event.target) && !quickActionsButton) {
                quickActions.classList.add('hidden');
            }
        });

        // Initialize parameter inputs when page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize theme manager first
            themeManager.init();
            
            // Initialize activity tracker
            activityTracker.init();
            
            // Initialize scope manager
            scopeManager.init();
            
            updateParameterInputs();
            document.getElementById('endpoint-select').addEventListener('change', updateParameterInputs);
        });

        // SCOPE Manager for Routing Dashboard
        const scopeManager = {
            currentScope: {
                tier: 'Enterprise',
                environment: 'Production',
                architecture: 'Multi-Tenant',
                version: 'v2.0',
                middleware: '7-Layer',
                features: {
                    routing: true,
                    middleware: true,
                    caching: true,
                    security: true
                }
            },
            
            init() {
                console.log('🏷️ Routing SCOPE Manager initialized');
                this.loadSavedScope();
                this.updateBadges();
                this.updateInspectionPanel();
                this.generateSessionId();
            },
            
            loadSavedScope() {
                const saved = localStorage.getItem('routing-scope-config');
                if (saved) {
                    this.currentScope = { ...this.currentScope, ...JSON.parse(saved) };
                    console.log('📂 SCOPE configuration loaded from localStorage');
                }
            },
            
            saveScope() {
                localStorage.setItem('routing-scope-config', JSON.stringify(this.currentScope));
                console.log('💾 SCOPE configuration saved to localStorage');
            },
            
            updateBadges() {
                // Update badge visibility based on current scope
                console.log('🔄 Updating SCOPE badges:', this.currentScope);
            },
            
            updateInspectionPanel() {
                document.getElementById('currentTier').textContent = this.currentScope.tier;
                document.getElementById('currentEnvironment').textContent = this.currentScope.environment;
                document.getElementById('currentArchitecture').textContent = this.currentScope.architecture;
                document.getElementById('currentVersion').textContent = this.currentScope.version;
                document.getElementById('currentMiddleware').textContent = this.currentScope.middleware;
                document.getElementById('lastUpdated').textContent = new Date().toLocaleTimeString();
            },
            
            generateSessionId() {
                const sessionId = Math.floor(Math.random() * 1000000000);
                document.getElementById('sessionId').textContent = sessionId;
                console.log('🆔 Generated session ID:', sessionId);
            },
            
            toggleInspection() {
                const panel = document.getElementById('inspectionPanel');
                panel.classList.toggle('open');
                console.log('🔍 Inspection panel toggled');
                
                // Track inspection panel open
                if (activityTracker && panel.classList.contains('open')) {
                    activityTracker.trackInspectionOpen();
                }
            },
            
            showBadgeInfo(badgeType) {
                const info = {
                    enterprise: 'Enterprise Tier: Premium features, priority support, advanced analytics',
                    production: 'Production Environment: Live deployment with full monitoring',
                    'multi-tenant': 'Multi-Tenant Architecture: Shared infrastructure with isolated data',
                    routing: 'URLPattern v2.0: Advanced dynamic routing with middleware support',
                    middleware: '7-Layer Stack: Comprehensive request processing pipeline'
                };
                
                showNotification('SCOPE Information', info[badgeType], 'info');
                console.log('🏷️ Badge info shown:', badgeType);
            },
            
            toggleFeature(feature) {
                this.currentScope.features[feature] = !this.currentScope.features[feature];
                this.updateInspectionPanel();
                this.saveScope();
                
                const status = this.currentScope.features[feature] ? 'enabled' : 'disabled';
                showNotification('Feature Toggle', `${feature} ${status}`, 'success');
                console.log(`🔄 Feature ${feature} ${status}`);
                
                // Track scope change
                if (activityTracker) {
                    activityTracker.trackScopeChange({ feature, status });
                }
            },
            
            switchEnvironment() {
                const environments = ['Production', 'Staging', 'Development', 'Testing'];
                const currentIndex = environments.indexOf(this.currentScope.environment);
                const nextIndex = (currentIndex + 1) % environments.length;
                this.currentScope.environment = environments[nextIndex];
                
                this.updateBadges();
                this.updateInspectionPanel();
                this.saveScope();
                
                showNotification('Environment Switched', `Now in ${environments[nextIndex]}`, 'success');
                console.log('🔄 Environment switched to:', environments[nextIndex]);
                
                // Track scope change
                if (activityTracker) {
                    activityTracker.trackScopeChange({ environment: environments[nextIndex] });
                }
            },
            
            changeTier() {
                const tiers = ['Enterprise', 'Professional', 'Standard', 'Basic'];
                const currentIndex = tiers.indexOf(this.currentScope.tier);
                const nextIndex = (currentIndex + 1) % tiers.length;
                this.currentScope.tier = tiers[nextIndex];
                
                this.updateBadges();
                this.updateInspectionPanel();
                this.saveScope();
                
                showNotification('Tier Changed', `Switched to ${tiers[nextIndex]} tier`, 'success');
                console.log('🔄 Tier changed to:', tiers[nextIndex]);
                
                // Track scope change
                if (activityTracker) {
                    activityTracker.trackScopeChange({ tier: tiers[nextIndex] });
                }
            },
            
            resetScope() {
                this.currentScope = {
                    tier: 'Enterprise',
                    environment: 'Production',
                    architecture: 'Multi-Tenant',
                    version: 'v2.0',
                    middleware: '7-Layer',
                    features: {
                        routing: true,
                        middleware: true,
                        caching: true,
                        security: true
                    }
                };
                
                this.updateBadges();
                this.updateInspectionPanel();
                this.saveScope();
                this.generateSessionId();
                
                showNotification('SCOPE Reset', 'Configuration reset to defaults', 'info');
                console.log('🔄 SCOPE reset to defaults');
                
                // Track scope change
                if (activityTracker) {
                    activityTracker.trackScopeChange({ action: 'reset' });
                }
            },
            
            getScope() {
                return { ...this.currentScope };
            }
        };

        // Theme Manager - Dark Mode Functionality
        const themeManager = {
            currentTheme: 'light',
            
            init() {
                console.log('🌙 Theme Manager initialized');
                this.loadSavedTheme();
                this.applyTheme(this.currentTheme);
                this.setupEventListeners();
            },
            
            toggleTheme() {
                const newTheme = this.currentTheme === 'light' ? 'dark' : 'light';
                this.applyTheme(newTheme);
                this.saveTheme(newTheme);
                this.currentTheme = newTheme;
                
                console.log(`🌙 Theme switched to ${newTheme}`);
                showNotification('Theme', `Switched to ${newTheme} mode`, 'info');
                
                // Track theme change
                if (activityTracker) {
                    activityTracker.trackThemeChange(newTheme);
                }
            },
            
            applyTheme(theme) {
                const body = document.body;
                
                if (theme === 'dark') {
                    body.classList.add('dark');
                } else {
                    body.classList.remove('dark');
                }
                
                // Update charts for dark mode
                this.updateCharts(theme);
            },
            
            updateCharts(theme) {
                // Update performance chart for dark mode
                if (window.performanceChart) {
                    window.performanceChart.options.scales.x.grid.color = theme === 'dark' ? '#3b82f6' : '#3b82f6';
                    window.performanceChart.options.scales.y.grid.color = theme === 'dark' ? '#3b82f6' : '#3b82f6';
                    window.performanceChart.update();
                }
            },
            
            saveTheme(theme) {
                localStorage.setItem('routing-dashboard-theme', theme);
                console.log('💾 Theme saved to localStorage');
            },
            
            loadSavedTheme() {
                const saved = localStorage.getItem('routing-dashboard-theme');
                if (saved) {
                    this.currentTheme = saved;
                    console.log('📂 Theme loaded from localStorage');
                } else {
                    // Check system preference
                    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                        this.currentTheme = 'dark';
                    }
                }
            },
            
            setupEventListeners() {
                // Listen for system theme changes
                if (window.matchMedia) {
                    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
                    mediaQuery.addListener((e) => {
                        if (!localStorage.getItem('routing-dashboard-theme')) {
                            const systemTheme = e.matches ? 'dark' : 'light';
                            this.applyTheme(systemTheme);
                            this.currentTheme = systemTheme;
                        }
                    });
                }
                
                // Keyboard shortcut: Ctrl/Cmd + Shift + D
                document.addEventListener('keydown', (e) => {
                    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'D') {
                        e.preventDefault();
                        this.toggleTheme();
                    }
                });
            },
            
            getTheme() {
                return this.currentTheme;
            },
            
            isDarkMode() {
                return this.currentTheme === 'dark';
            }
        };

        // User Activity Tracker & Session Manager
        const activityTracker = {
            sessionStart: null,
            lastActivity: null,
            activityLog: [],
            sessionData: {
                pageViews: 0,
                interactions: 0,
                scopeChanges: 0,
                themeChanges: 0,
                apiTests: 0,
                inspectionOpens: 0,
                routeTests: 0,
                duration: 0
            },
            
            init() {
                console.log('👤 Activity Tracker initialized');
                this.sessionStart = Date.now();
                this.lastActivity = Date.now();
                this.loadSessionData();
                this.setupEventListeners();
                this.startSessionTimer();
                this.trackPageView();
            },
            
            setupEventListeners() {
                // Track user interactions
                document.addEventListener('click', (e) => {
                    this.trackInteraction('click', e.target);
                });
                
                document.addEventListener('keydown', (e) => {
                    this.trackInteraction('keydown', e.target);
                });
                
                document.addEventListener('scroll', () => {
                    this.trackInteraction('scroll', window);
                });
                
                // Track page visibility changes
                document.addEventListener('visibilitychange', () => {
                    if (document.hidden) {
                        this.trackSessionPause();
                    } else {
                        this.trackSessionResume();
                    }
                });
                
                // Track page unload
                window.addEventListener('beforeunload', () => {
                    this.saveSessionData();
                });
            },
            
            trackInteraction(type, target) {
                const now = Date.now();
                this.lastActivity = now;
                this.sessionData.interactions++;
                
                const interaction = {
                    type: type,
                    timestamp: now,
                    target: this.getTargetDescription(target),
                    sessionId: this.getSessionId()
                };
                
                this.activityLog.push(interaction);
                
                // Keep only last 100 interactions
                if (this.activityLog.length > 100) {
                    this.activityLog = this.activityLog.slice(-100);
                }
                
                // Update session duration
                this.updateSessionDuration();
            },
            
            trackPageView() {
                this.sessionData.pageViews++;
                const pageView = {
                    type: 'pageview',
                    timestamp: Date.now(),
                    url: window.location.href,
                    sessionId: this.getSessionId()
                };
                
                this.activityLog.push(pageView);
                console.log('📊 Page view tracked');
            },
            
            trackScopeChange(scopeData) {
                this.sessionData.scopeChanges++;
                const scopeChange = {
                    type: 'scope_change',
                    timestamp: Date.now(),
                    scopeData: scopeData,
                    sessionId: this.getSessionId()
                };
                
                this.activityLog.push(scopeChange);
                console.log('🏷️ Scope change tracked:', scopeData);
            },
            
            trackThemeChange(theme) {
                this.sessionData.themeChanges++;
                const themeChange = {
                    type: 'theme_change',
                    timestamp: Date.now(),
                    theme: theme,
                    sessionId: this.getSessionId()
                };
                
                this.activityLog.push(themeChange);
                console.log('🌙 Theme change tracked:', theme);
            },
            
            trackApiTest(endpoint, method, responseTime, status) {
                this.sessionData.apiTests++;
                const apiTest = {
                    type: 'api_test',
                    timestamp: Date.now(),
                    endpoint: endpoint,
                    method: method,
                    responseTime: responseTime,
                    status: status,
                    sessionId: this.getSessionId()
                };
                
                this.activityLog.push(apiTest);
                console.log('🧪 API test tracked:', { endpoint, method, responseTime, status });
            },
            
            trackInspectionOpen() {
                this.sessionData.inspectionOpens++;
                const inspectionOpen = {
                    type: 'inspection_open',
                    timestamp: Date.now(),
                    sessionId: this.getSessionId()
                };
                
                this.activityLog.push(inspectionOpen);
                console.log('🔍 Inspection panel opened');
            },
            
            trackRouteTest(route, result) {
                this.sessionData.routeTests++;
                const routeTest = {
                    type: 'route_test',
                    timestamp: Date.now(),
                    route: route,
                    result: result,
                    sessionId: this.getSessionId()
                };
                
                this.activityLog.push(routeTest);
                console.log('🛣️ Route test tracked:', { route, result });
            },
            
            trackSessionPause() {
                const pause = {
                    type: 'session_pause',
                    timestamp: Date.now(),
                    sessionId: this.getSessionId()
                };
                
                this.activityLog.push(pause);
                console.log('⏸️ Session paused');
            },
            
            trackSessionResume() {
                const resume = {
                    type: 'session_resume',
                    timestamp: Date.now(),
                    sessionId: this.getSessionId()
                };
                
                this.activityLog.push(resume);
                console.log('▶️ Session resumed');
            },
            
            updateSessionDuration() {
                this.sessionData.duration = Math.floor((Date.now() - this.sessionStart) / 1000);
            },
            
            startSessionTimer() {
                setInterval(() => {
                    this.updateSessionDuration();
                    this.saveSessionData();
                }, 5000); // Update every 5 seconds
            },
            
            getTargetDescription(target) {
                if (!target) return 'unknown';
                
                if (target.id) return `#${target.id}`;
                if (target.className) return `.${target.className.split(' ')[0]}`;
                if (target.tagName) return target.tagName.toLowerCase();
                if (target.textContent) return target.textContent.substring(0, 20);
                
                return 'unknown';
            },
            
            getSessionId() {
                let sessionId = sessionStorage.getItem('routing-dashboard-session-id');
                if (!sessionId) {
                    sessionId = `route_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                    sessionStorage.setItem('routing-dashboard-session-id', sessionId);
                }
                return sessionId;
            },
            
            getSessionStats() {
                this.updateSessionDuration();
                
                const now = Date.now();
                const sessionDuration = now - this.sessionStart;
                const activeTime = this.calculateActiveTime();
                
                return {
                    sessionId: this.getSessionId(),
                    startTime: new Date(this.sessionStart).toISOString(),
                    duration: Math.floor(sessionDuration / 1000),
                    activeTime: Math.floor(activeTime / 1000),
                    pageViews: this.sessionData.pageViews,
                    interactions: this.sessionData.interactions,
                    scopeChanges: this.sessionData.scopeChanges,
                    themeChanges: this.sessionData.themeChanges,
                    apiTests: this.sessionData.apiTests,
                    inspectionOpens: this.sessionData.inspectionOpens,
                    routeTests: this.sessionData.routeTests,
                    lastActivity: new Date(this.lastActivity).toISOString(),
                    idleTime: Math.floor((now - this.lastActivity) / 1000)
                };
            },
            
            calculateActiveTime() {
                let activeTime = 0;
                let lastTimestamp = this.sessionStart;
                
                this.activityLog.forEach(activity => {
                    if (activity.type !== 'session_pause' && activity.type !== 'session_resume') {
                        activeTime += Math.min(30000, activity.timestamp - lastTimestamp); // Max 30s per activity
                        lastTimestamp = activity.timestamp;
                    }
                });
                
                return activeTime;
            },
            
            saveSessionData() {
                const sessionStats = this.getSessionStats();
                localStorage.setItem('routing-dashboard-session-data', JSON.stringify(sessionStats));
                localStorage.setItem('routing-dashboard-activity-log', JSON.stringify(this.activityLog));
            },
            
            loadSessionData() {
                try {
                    const savedData = localStorage.getItem('routing-dashboard-session-data');
                    if (savedData) {
                        const data = JSON.parse(savedData);
                        console.log('📂 Session data loaded:', data);
                    }
                    
                    const savedLog = localStorage.getItem('routing-dashboard-activity-log');
                    if (savedLog) {
                        this.activityLog = JSON.parse(savedLog);
                    }
                } catch (error) {
                    console.error('❌ Failed to load session data:', error);
                }
            },
            
            exportActivityData() {
                const data = {
                    sessionStats: this.getSessionStats(),
                    activityLog: this.activityLog,
                    exportTime: new Date().toISOString()
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `routing-activity-data-${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);
                
                showNotification('Export', 'Activity data exported successfully', 'success');
            },
            
            clearActivityData() {
                this.activityLog = [];
                this.sessionData = {
                    pageViews: 0,
                    interactions: 0,
                    scopeChanges: 0,
                    themeChanges: 0,
                    apiTests: 0,
                    inspectionOpens: 0,
                    routeTests: 0,
                    duration: 0
                };
                
                localStorage.removeItem('routing-dashboard-session-data');
                localStorage.removeItem('routing-dashboard-activity-log');
                sessionStorage.removeItem('routing-dashboard-session-id');
                
                console.log('🗑️ Activity data cleared');
                showNotification('Clear', 'Activity data cleared successfully', 'info');
            }
        };

        // Enhanced toggleTheme function
        function toggleTheme() {
            themeManager.toggleTheme();
        }

        // Enhanced testAPI function with activity tracking
        async function testAPI() {
            const endpointSelect = document.getElementById('endpoint-select');
            const selectedEndpoint = endpointSelect.value;
            const responseContainer = document.getElementById('response-container');
            
            responseContainer.innerHTML = '<p class="text-yellow-400">⏳ Sending request...</p>';
            
            // Track API test start
            const startTime = Date.now();
            
            try {
                // Simulate API call with the existing logic
                const response = await simulateAPICall(selectedEndpoint);
                const endTime = Date.now();
                const responseTime = endTime - startTime;
                
                responseContainer.innerHTML = `<pre class="text-green-400">${JSON.stringify(response, null, 2)}</pre>`;
                
                // Track successful API test
                if (activityTracker) {
                    activityTracker.trackApiTest(selectedEndpoint, 'GET', responseTime, 200);
                }
                
                showNotification('API Test', 'Request completed successfully', 'success');
                
            } catch (error) {
                const endTime = Date.now();
                const responseTime = endTime - startTime;
                
                responseContainer.innerHTML = `<p class="text-red-400">❌ Error: ${error.message}</p>`;
                
                // Track failed API test
                if (activityTracker) {
                    activityTracker.trackApiTest(selectedEndpoint, 'GET', responseTime, 500);
                }
                
                showNotification('API Test', 'Request failed', 'error');
            }
        }

        // Helper function to simulate API calls
        async function simulateAPICall(endpoint) {
            // Simulate network delay
            await new Promise(resolve => setTimeout(resolve, Math.random() * 1000 + 500));
            
            // Mock response based on endpoint
            const responses = {
                'phone-analysis': { success: true, data: { phone: '+1234567890', risk: 'low' } },
                'phone-risk': { success: true, data: { riskScore: 0.2, factors: [] } },
                'ml-prediction': { success: true, data: { prediction: 'safe', confidence: 0.95 } },
                'identity-graph': { success: true, data: { nodes: 5, edges: 8 } },
                'realtime-alerts': { success: true, data: { alerts: [] } },
                'platform-analysis': { success: true, data: { platform: 'venmo', status: 'active' } }
            };
            
            return responses[endpoint] || { success: false, error: 'Unknown endpoint' };
        }
    </script>
</body>
</html>
