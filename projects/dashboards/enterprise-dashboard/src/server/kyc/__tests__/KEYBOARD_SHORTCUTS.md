# Keyboard Shortcuts Integration

## Overview

WindSurf keyboard shortcuts have been integrated into the KYC test reports and the main Enterprise Dashboard. The shortcuts provide quick access to KYC operations and dashboard navigation.

## Integration Points

### 1. Standalone HTML Reports (`shortcuts.js`)

**Location:** `src/server/kyc/__tests__/shortcuts.js`

A production-ready, self-contained JavaScript module for HTML test reports. Features:
- ✅ No external dependencies
- ✅ Inline CSS and JavaScript
- ✅ Cross-platform support (Mac/Windows/Linux)
- ✅ Visual feedback with toast notifications
- ✅ Help overlay (Ctrl/Cmd+?)

**Integrated into:**
- `test-report.html` (generated by `generate-html-report.ts`)
- `test-results-viewer.html`
- `standalone-report.html`

### 2. Dashboard Integration (`shortcuts.toml`)

**Location:** `src/client/config/shortcuts.toml`

KYC shortcuts added to the TOML configuration:

```toml
[keyboard.kyc]
"Cmd/Ctrl + K" = { action = "kyc-validate", description = "Validate KYC" }
"Cmd/Ctrl + Shift + K" = { action = "kyc-failsafe", description = "Run KYC failsafe" }
"Cmd/Ctrl + Shift + R" = { action = "kyc-review-queue", description = "Open KYC review queue" }
"9" = { action = "tab-kyc", description = "Go to KYC tab" }
```

### 3. React Component Integration

**Dashboard.tsx:**
- Added KYC shortcut handlers in keyboard event listener
- Navigates to KYC tab on shortcut activation
- Shows toast notifications

**KYCReviewTab.tsx:**
- Listens for `kyc:validate:requested`, `kyc:review:requested`, and `kyc:failsafe:requested` events
- Automatically refreshes queue when shortcuts are triggered

**useGlobalShortcuts.ts:**
- Added default handlers for KYC actions
- Dispatches custom events for KYC operations

## Available Shortcuts

### KYC-Specific Shortcuts

| Shortcut | Action | Description |
|----------|--------|-------------|
| `Ctrl/Cmd + K` | `kyc-validate` | Validate KYC for current context |
| `Ctrl/Cmd + Shift + K` | `kyc-failsafe` | Run KYC failsafe execution |
| `Ctrl/Cmd + Shift + R` | `kyc-review-queue` | Open KYC review queue |
| `9` | `tab-kyc` | Navigate to KYC tab |

### General Dashboard Shortcuts

| Shortcut | Action | Description |
|----------|--------|-------------|
| `Ctrl/Cmd + R` | `refresh-data` | Refresh current view |
| `Ctrl/Cmd + E` | `export-data` | Export data |
| `Ctrl/Cmd + ,` | `open-settings` | Open settings |
| `Ctrl/Cmd + ?` | `show-shortcuts` | Show shortcuts help |
| `1-8` | `tab-*` | Navigate to tabs 1-8 |
| `T` | `toggle-theme` | Toggle light/dark theme |

### WindSurf Legacy Shortcuts (in HTML reports)

The standalone `shortcuts.js` includes additional shortcuts for compatibility:

- `Ctrl/Cmd + R` - Refresh dashboard
- `Ctrl/Cmd + E` - Export data
- `Ctrl/Cmd + A` - Run risk analysis
- `Ctrl/Cmd + ,` - Open config
- `Ctrl/Cmd + P` - Process transaction
- `Ctrl/Cmd + F` - Detect fraud
- `Ctrl/Cmd + B` - Rebalance pool
- `Ctrl/Cmd + M` - Start monitoring

## Usage

### In HTML Test Reports

The shortcuts are automatically loaded when you open any generated HTML report:

```bash
# Generate report with shortcuts
bun run test:kyc:report

# Open test-report.html in browser
open src/server/kyc/__tests__/test-report.html
```

Press `Ctrl/Cmd + ?` to see all available shortcuts.

### In Dashboard

Shortcuts are automatically active when the dashboard is loaded. The shortcuts system uses the TOML configuration and React event system.

## Event System

The shortcuts dispatch custom events that components can listen to:

```typescript
// Listen for KYC validation request
window.addEventListener('kyc:validate:requested', () => {
  // Handle validation
});

// Listen for review queue request
window.addEventListener('kyc:review:requested', () => {
  // Refresh queue
});

// Listen for failsafe request
window.addEventListener('kyc:failsafe:requested', () => {
  // Trigger failsafe execution
});
```

## Platform Support

- **macOS**: Uses `Cmd` key
- **Windows/Linux**: Uses `Ctrl` key
- Automatically detected via `navigator.platform`

## Production Readiness

✅ **No External Dependencies**
- All CSS and JavaScript are inlined
- No CDN links or external resources
- Works offline

✅ **Cross-Platform**
- Automatic platform detection
- Consistent behavior across OS

✅ **Accessible**
- Visual feedback for all actions
- Help overlay with all shortcuts
- Keyboard navigation support

✅ **Performance**
- Lightweight (~15KB minified)
- No blocking operations
- Fast initialization

## Testing

Test shortcuts in the HTML reports:

1. Generate a test report:
   ```bash
   bun run test:kyc:report
   ```

2. Open `test-report.html` in a browser

3. Press `Ctrl/Cmd + ?` to see shortcuts help

4. Try KYC shortcuts:
   - `Ctrl/Cmd + K` - Shows validation toast
   - `Ctrl/Cmd + Shift + K` - Shows failsafe toast
   - `Ctrl/Cmd + Shift + R` - Shows review queue toast

## Future Enhancements

- [ ] Add visual indicators for active shortcuts
- [ ] Add shortcut customization UI
- [ ] Add shortcut conflict resolution UI
- [ ] Add keyboard shortcut hints in tooltips
- [ ] Add shortcut recording/playback for demos

## References

- [Shortcuts Configuration](../../../client/config/shortcuts.toml)
- [Global Shortcuts Hook](../../../client/hooks/useGlobalShortcuts.ts)
- [KYC Review Tab](../../../client/KYCReviewTab.tsx)
- [Dashboard Component](../../../client/Dashboard.tsx)

---

**Last Updated:** January 23, 2026  
**Status:** ✅ Production Ready
