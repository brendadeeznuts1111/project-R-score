<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bun Payment Linker | Automated Application Acceptance</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap');
        
        :root {
            --neon-blue: #00f3ff;
            --neon-green: #0aff68;
            --neon-orange: #ff9d00;
            --neon-purple: #b829dd;
            --dark-bg: #0a0a0f;
            --panel-bg: rgba(20, 20, 30, 0.8);
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: var(--dark-bg);
            color: #e0e0e0;
            overflow-x: hidden;
        }
        
        .mono { font-family: 'JetBrains Mono', monospace; }
        
        .bg-grid {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: -1;
        }

        /* POLISHED HEADER STYLES */
        .gradient-text {
            background: linear-gradient(135deg, #00f3ff 0%, #b829dd 50%, #00f3ff 100%);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 3s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .glow-underline {
            position: relative;
            display: inline-block;
        }

        .glow-underline::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--neon-blue), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateX(100%); opacity: 0; }
        }

        .glass-header {
            background: rgba(10, 10, 15, 0.7);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 243, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        .status-pulse {
            position: relative;
        }

        .status-pulse::before {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            border: 2px solid var(--neon-green);
            opacity: 0;
            animation: pulseRing 2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }

        @keyframes pulseRing {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--neon-blue);
            border-radius: 50%;
            opacity: 0.6;
            animation: float 6s ease-in-out infinite;
            box-shadow: 0 0 10px var(--neon-blue);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); opacity: 0; }
            10% { opacity: 0.6; }
            90% { opacity: 0.6; }
            50% { transform: translateY(-20px) translateX(10px); }
        }

        .badge-glow {
            position: relative;
            overflow: hidden;
        }

        .badge-glow::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: badgeShine 3s infinite;
        }

        @keyframes badgeShine {
            0% { left: -100%; }
            50% { left: 100%; }
            100% { left: 100%; }
        }
        
        .glow { box-shadow: 0 0 20px rgba(0, 243, 255, 0.3); }
        .glow-green { box-shadow: 0 0 20px rgba(10, 255, 104, 0.3); }
        .glow-orange { box-shadow: 0 0 20px rgba(255, 157, 0, 0.3); }
        .glow-red { box-shadow: 0 0 20px rgba(255, 68, 68, 0.3); }
        .glow-purple { box-shadow: 0 0 20px rgba(184, 41, 221, 0.3); }
        
        .stat-card {
            background: var(--panel-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
            transition: left 0.5s;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--neon-blue);
            box-shadow: 0 10px 30px rgba(0, 243, 255, 0.2);
        }
        
        /* Decision Badge Styles */
        .decision-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            animation: slideIn 0.5s ease;
        }
        
        .decision-approved {
            background: rgba(10, 255, 104, 0.15);
            color: var(--neon-green);
            border: 1px solid rgba(10, 255, 104, 0.4);
        }
        
        .decision-rejected {
            background: rgba(255, 68, 68, 0.15);
            color: var(--neon-red);
            border: 1px solid rgba(255, 68, 68, 0.4);
        }
        
        .decision-review {
            background: rgba(255, 157, 0, 0.15);
            color: var(--neon-orange);
            border: 1px solid rgba(255, 157, 0, 0.4);
        }
        
        /* Risk Meter */
        .risk-meter {
            width: 200px;
            height: 100px;
            position: relative;
            overflow: hidden;
        }
        
        .risk-meter-bg {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: conic-gradient(
                from 180deg,
                var(--neon-green) 0deg 60deg,
                var(--neon-orange) 60deg 120deg,
                var(--neon-red) 120deg 180deg,
                transparent 180deg
            );
            position: absolute;
            bottom: 0;
        }
        
        .risk-meter-center {
            width: 160px;
            height: 160px;
            background: var(--dark-bg);
            border-radius: 50%;
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .risk-needle {
            width: 4px;
            height: 90px;
            background: var(--neon-blue);
            position: absolute;
            bottom: 10px;
            left: 98px;
            transform-origin: bottom center;
            transform: rotate(-90deg);
            transition: transform 1s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 2px;
            box-shadow: 0 0 10px var(--neon-blue);
        }
        
        /* Pattern Match Cards */
        .pattern-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            transition: all 0.3s ease;
        }
        
        .pattern-card:hover {
            border-color: var(--neon-blue);
            transform: translateX(5px);
        }
        
        .pattern-match {
            border-left: 3px solid var(--neon-green);
        }
        
        .pattern-fail {
            border-left: 3px solid var(--neon-red);
        }
        
        .pattern-warning {
            border-left: 3px solid var(--neon-orange);
        }
        
        /* Lookup Table Styles */
        .lookup-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 12px;
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.2s ease;
        }
        
        .lookup-row:hover {
            background: rgba(255, 255, 255, 0.03);
        }
        
        .lookup-pass { color: var(--neon-green); }
        .lookup-fail { color: var(--neon-red); }
        .lookup-pending { color: var(--neon-orange); }
        
        /* Workflow Timeline */
        .workflow-step {
            position: relative;
            padding-left: 40px;
            padding-bottom: 24px;
            border-left: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .workflow-step::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 0;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        
        .workflow-step.active::before {
            background: var(--neon-blue);
            box-shadow: 0 0 10px var(--neon-blue);
            animation: pulse 2s infinite;
        }
        
        .workflow-step.completed::before {
            background: var(--neon-green);
        }
        
        .workflow-step.failed::before {
            background: var(--neon-red);
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Heatmap Grid */
        .heatmap-cell {
            width: 40px;
            height: 40px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .heatmap-cell:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }
        
        .hidden { display: none; }
        
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.2); }
        ::-webkit-scrollbar-thumb { background: var(--neon-blue); border-radius: 4px; }

        /* Deep Analytics Styles */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .metric-card {
            background: linear-gradient(135deg, rgba(0, 243, 255, 0.05), rgba(184, 41, 221, 0.05));
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple), var(--neon-green));
            animation: gradientFlow 3s linear infinite;
        }

        @keyframes gradientFlow {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .metric-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 243, 255, 0.3);
            border-color: var(--neon-blue);
        }

        .deep-chart {
            border: 1px solid rgba(0, 243, 255, 0.2);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            max-height: 400px;
        }
        
        #performanceChart {
            max-height: 300px;
            height: auto;
        }

        .risk-distribution {
            display: flex;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.3);
        }

        .risk-segment {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .risk-segment:hover {
            filter: brightness(1.2);
            transform: scaleY(1.2);
        }

        .advanced-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background: rgba(10, 10, 15, 0.4);
            border-radius: 0.75rem;
            overflow: hidden;
        }

        .advanced-table th {
            background: linear-gradient(135deg, rgba(0, 243, 255, 0.1), rgba(184, 41, 221, 0.1));
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--neon-blue);
            border-bottom: 1px solid rgba(0, 243, 255, 0.2);
        }

        .advanced-table td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.2s ease;
        }

        .advanced-table tr:hover td {
            background: rgba(0, 243, 255, 0.05);
        }

        .prediction-confidence {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .confidence-bar {
            flex: 1;
            height: 6px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 3px;
            overflow: hidden;
            position: relative;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--neon-green), var(--neon-blue));
            border-radius: 3px;
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .neural-network {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2rem;
            padding: 2rem;
            background: rgba(10, 10, 15, 0.6);
            border-radius: 1rem;
            border: 1px solid rgba(0, 243, 255, 0.2);
        }

        .neuron-layer {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            justify-content: center;
        }

        .neuron {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: radial-gradient(circle, var(--neon-blue), rgba(0, 243, 255, 0.3));
            border: 2px solid var(--neon-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            color: white;
            animation: neuronPulse 2s ease-in-out infinite;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .neuron:hover {
            transform: scale(1.2);
            box-shadow: 0 0 20px var(--neon-blue);
        }

        @keyframes neuronPulse {
            0%, 100% { opacity: 0.7; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        .real-time-feed {
            max-height: 400px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .feed-item {
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: rgba(255, 255, 255, 0.03);
            border-left: 3px solid var(--neon-blue);
            border-radius: 0.25rem;
            animation: slideInRight 0.5s ease;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .model-performance {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .performance-metric {
            text-align: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .performance-value {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .feature-importance {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .feature-bar {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .feature-label {
            min-width: 150px;
            font-size: 0.875rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .importance-bar {
            flex: 1;
            height: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .importance-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--neon-purple), var(--neon-blue));
            border-radius: 10px;
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 0.5rem;
        }

        .importance-value {
            font-size: 0.75rem;
            font-weight: bold;
            color: white;
        }
    </style>
<base target="_blank">
</head>
<body class="min-h-screen">
    <div class="bg-grid"></div>
    
    <header class="glass-header sticky top-0 z-50 relative overflow-hidden">
        <!-- Floating Particles -->
        <div class="particle" style="top: 20%; left: 10%; animation-delay: 0s;"></div>
        <div class="particle" style="top: 60%; left: 20%; animation-delay: 1s;"></div>
        <div class="particle" style="top: 30%; left: 80%; animation-delay: 2s;"></div>
        <div class="particle" style="top: 70%; left: 90%; animation-delay: 3s;"></div>
        
        <div class="max-w-7xl mx-auto px-6 py-5">
            <div class="flex items-center justify-between">
                
                <!-- Left: Logo & Title -->
                <div class="flex items-center gap-4">
                    <!-- Animated Logo Container -->
                    <div class="relative group">
                        <div class="absolute inset-0 bg-gradient-to-br from-cyan-400 to-purple-600 rounded-xl blur-lg opacity-40 group-hover:opacity-60 transition-opacity duration-500"></div>
                        <div class="relative w-12 h-12 bg-gradient-to-br from-cyan-400 to-blue-600 rounded-xl flex items-center justify-center shadow-2xl transform group-hover:scale-105 transition-transform duration-300">
                            <i class="fas fa-robot text-white text-2xl animate-pulse"></i>
                        </div>
                        <!-- Orbiting dots -->
                        <div class="absolute inset-0 rounded-xl border border-cyan-400/30 animate-spin" style="animation-duration: 10s;"></div>
                    </div>

                    <!-- Title Section -->
                    <div class="flex flex-col">
                        <h1 class="text-2xl font-bold tracking-tight flex items-center gap-3">
                            <span class="gradient-text glow-underline">Bun Auto-Underwriting</span>
                            <span class="px-2 py-0.5 bg-cyan-500/10 border border-cyan-400/30 rounded text-xs text-cyan-400 font-mono tracking-wider">ENTERPRISE</span>
                        </h1>
                        
                        <!-- Animated Subtitle -->
                        <div class="flex items-center gap-2 mt-1">
                            <div class="h-px w-8 bg-gradient-to-r from-cyan-400 to-transparent"></div>
                            <p class="text-sm text-gray-400 tracking-wide flex items-center gap-2">
                                <span class="text-cyan-400">Pattern Matching</span>
                                <span class="text-gray-600">•</span>
                                <span class="text-purple-400">Risk Scoring</span>
                                <span class="text-gray-600">•</span>
                                <span class="text-green-400">Automated Decisioning</span>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Center: Live Status Indicators -->
                <div class="hidden lg:flex items-center gap-6">
                    <!-- System Status -->
                    <div class="flex items-center gap-3 px-4 py-2 rounded-lg bg-black/30 border border-white/5">
                        <div class="status-pulse w-2 h-2 rounded-full bg-green-400"></div>
                        <div class="flex flex-col">
                            <span class="text-[10px] text-gray-500 uppercase tracking-wider font-semibold">System Status</span>
                            <span class="text-xs text-green-400 font-mono flex items-center gap-1">
                                ONLINE <span class="text-[8px] opacity-60">99.9%</span>
                            </span>
                        </div>
                    </div>

                    <!-- Version -->
                    <div class="flex items-center gap-3 px-4 py-2 rounded-lg bg-black/30 border border-white/5">
                        <i class="fas fa-code-branch text-cyan-400 text-sm"></i>
                        <div class="flex flex-col">
                            <span class="text-[10px] text-gray-500 uppercase tracking-wider font-semibold">Version</span>
                            <span class="text-xs text-cyan-400 font-mono">v2.0.0-stable</span>
                        </div>
                    </div>

                    <!-- Automation Status -->
                    <div class="flex items-center gap-3 px-4 py-2 rounded-lg bg-black/30 border border-white/5">
                        <i class="fas fa-robot text-purple-400 text-sm"></i>
                        <div class="flex flex-col">
                            <span class="text-[10px] text-gray-500 uppercase tracking-wider font-semibold">Automation</span>
                            <span class="text-xs text-purple-400 font-mono">ACTIVE</span>
                        </div>
                    </div>
                </div>

                <!-- Right: Action Buttons -->
                <div class="flex items-center gap-3">
                    <!-- Stats Badge -->
                    <div class="badge-glow px-4 py-2 rounded-full bg-green-500/10 border border-green-400/40 text-green-400 text-xs font-semibold flex items-center gap-2 shadow-lg shadow-green-500/10 backdrop-blur-sm">
                        <i class="fas fa-check-circle"></i>
                        <span class="font-mono">94.2%</span>
                        <span class="text-green-400/70 font-normal">Auto-Approval</span>
                    </div>

                    <!-- Dashboard Navigation -->
                    <div class="flex items-center gap-1 bg-black/30 rounded-lg p-1 border border-white/10">
                        <button onclick="switchDashboard('underwriting')" class="dashboard-btn px-3 py-1.5 rounded text-xs font-medium transition-all bg-cyan-500/20 text-cyan-400">
                            <i class="fas fa-brain mr-1"></i> Underwriting
                        </button>
                        <button onclick="switchDashboard('payments')" class="dashboard-btn px-3 py-1.5 rounded text-xs font-medium transition-all text-gray-400 hover:text-white hover:bg-white/10">
                            <i class="fas fa-credit-card mr-1"></i> Payments
                        </button>
                        <button onclick="switchDashboard('compliance')" class="dashboard-btn px-3 py-1.5 rounded text-xs font-medium transition-all text-gray-400 hover:text-white hover:bg-white/10">
                            <i class="fas fa-shield-alt mr-1"></i> Compliance
                        </button>
                        <button onclick="switchDashboard('analytics')" class="dashboard-btn px-3 py-1.5 rounded text-xs font-medium transition-all text-gray-400 hover:text-white hover:bg-white/10">
                            <i class="fas fa-chart-line mr-1"></i> Analytics
                        </button>
                        <button onclick="switchDashboard('tenant')" class="dashboard-btn px-3 py-1.5 rounded text-xs font-medium transition-all text-gray-400 hover:text-white hover:bg-white/10">
                            <i class="fas fa-building mr-1"></i> Tenants
                        </button>
                        <button onclick="switchDashboard('alerting')" class="dashboard-btn px-3 py-1.5 rounded text-xs font-medium transition-all text-gray-400 hover:text-white hover:bg-white/10">
                            <i class="fas fa-bell mr-1"></i> Alerts
                        </button>
                        <button onclick="switchDashboard('models')" class="dashboard-btn px-3 py-1.5 rounded text-xs font-medium transition-all text-gray-400 hover:text-white hover:bg-white/10">
                            <i class="fas fa-brain mr-1"></i> Models
                        </button>
                        <button onclick="switchDashboard('blockchain')" class="dashboard-btn px-3 py-1.5 rounded text-xs font-medium transition-all text-gray-400 hover:text-white hover:bg-white/10">
                            <i class="fas fa-cube mr-1"></i> Blockchain
                        </button>
                    </div>

                    <button onclick="simulateNewApplication()" class="px-4 py-2 bg-cyan-500/20 text-cyan-400 rounded-lg hover:bg-cyan-500/30 transition-colors text-sm font-medium flex items-center gap-2">
                        <i class="fas fa-plus mr-2"></i>New Application
                    </button>
                </div>
            </div>

            <!-- Bottom Progress Bar -->
            <div class="mt-4 flex items-center gap-2">
                <div class="flex-1 h-1 bg-gray-800 rounded-full overflow-hidden relative">
                    <div class="absolute inset-0 bg-gradient-to-r from-cyan-400 via-purple-400 to-green-400 w-2/3 animate-pulse"></div>
                    <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent w-1/4 animate-[shimmer_2s_infinite]"></div>
                </div>
                <span class="text-[10px] text-gray-500 font-mono">SQLite WAL • 52k req/s</span>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-8 space-y-6">
        
        <!-- Underwriting Dashboard -->
        <div id="underwriting-dashboard" class="dashboard-view">
            <!-- Live Application Processing -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- Application Input Form -->
                <div class="lg:col-span-1 stat-card rounded-2xl p-6 glow">
                    <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                        <i class="fas fa-file-alt text-cyan-400"></i>
                        Application Input
                    </h2>
                    
                    <form id="application-form" class="space-y-4" onsubmit="return false;">
                        <div>
                            <label class="block text-xs text-gray-400 mb-1">Applicant Name</label>
                            <input type="text" id="app-name" class="w-full bg-black/30 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-cyan-400 focus:outline-none" value="John Smith">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-xs text-gray-400 mb-1">SSN (Last 4)</label>
                                <input type="text" id="app-ssn" class="w-full bg-black/30 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-cyan-400 focus:outline-none" value="7845">
                            </div>
                            <div>
                                <label class="block text-xs text-gray-400 mb-1">Credit Score</label>
                                <input type="number" id="app-credit" class="w-full bg-black/30 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-cyan-400 focus:outline-none" value="720">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-xs text-gray-400 mb-1">Annual Income</label>
                            <input type="text" id="app-income" class="w-full bg-black/30 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-cyan-400 focus:outline-none" value="$75,000">
                        </div>
                        
                        <div>
                            <label class="block text-xs text-gray-400 mb-1">Employment Status</label>
                            <select id="app-employment" class="w-full bg-black/30 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-cyan-400 focus:outline-none">
                                <option value="employed">Employed Full-time</option>
                                <option value="self-employed">Self-employed</option>
                                <option value="unemployed">Unemployed</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-xs text-gray-400 mb-1">Requested Limit</label>
                            <input type="text" id="app-limit" class="w-full bg-black/30 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-cyan-400 focus:outline-none" value="$10,000">
                        </div>
                        
                        <div class="pt-2">
                            <button onclick="processApplication()" class="w-full py-2 bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-lg font-semibold hover:shadow-lg hover:shadow-cyan-500/30 transition-all flex items-center justify-center gap-2">
                                <i class="fas fa-cogs"></i> Process Application
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Real-time Decision Engine -->
                <div class="lg:col-span-2 space-y-6">
                    
                    <!-- Decision Header -->
                    <div class="stat-card rounded-2xl p-6 glow-green border-l-4 border-green-400" id="decision-card">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h2 class="text-2xl font-bold text-white mb-1">Automated Decision</h2>
                                <p class="text-sm text-gray-400">Real-time risk assessment and pattern matching</p>
                            </div>
                            <div id="decision-badge" class="decision-badge decision-approved">
                                <i class="fas fa-check-circle"></i>
                                <span>APPROVED</span>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <!-- Risk Score Gauge -->
                            <div class="flex flex-col items-center">
                                <div class="risk-meter mb-2">
                                    <div class="risk-meter-bg"></div>
                                    <div class="risk-meter-center">
                                        <span class="text-2xl font-bold text-white mono" id="risk-score">23</span>
                                        <span class="text-xs text-gray-500">Risk Score</span>
                                    </div>
                                    <div class="risk-needle" id="risk-needle" style="transform: rotate(-70deg);"></div>
                                </div>
                                <div class="text-sm text-green-400 font-medium">Low Risk</div>
                            </div>
                            
                            <!-- Decision Factors -->
                            <div class="space-y-3">
                                <h4 class="text-sm text-gray-400 font-medium mb-2">Decision Factors</h4>
                                <div class="space-y-2" id="decision-factors">
                                    <div class="flex items-center gap-2 text-sm">
                                        <i class="fas fa-check-circle text-green-400"></i>
                                        <span class="text-gray-300">Credit score > 700</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm">
                                        <i class="fas fa-check-circle text-green-400"></i>
                                        <span class="text-gray-300">DTI ratio acceptable</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm">
                                        <i class="fas fa-check-circle text-green-400"></i>
                                        <span class="text-gray-300">No fraud patterns</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm">
                                        <i class="fas fa-check-circle text-green-400"></i>
                                        <span class="text-gray-300">Employment verified</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Approval Terms -->
                            <div class="bg-black/30 rounded-lg p-4">
                                <h4 class="text-sm text-gray-400 font-medium mb-3">Approved Terms</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="text-gray-500">Credit Limit</span>
                                        <span class="text-white font-mono">$12,500</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-500">APR</span>
                                        <span class="text-green-400 font-mono">14.99%</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-500">Annual Fee</span>
                                        <span class="text-white font-mono">$0</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-500">Decision Time</span>
                                        <span class="text-cyan-400 font-mono">0.8s</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pattern Matching Results -->
                    <div class="stat-card rounded-xl p-6">
                        <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                            <i class="fas fa-search text-cyan-400"></i>
                            Pattern Matching Analysis
                        </h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="pattern-grid">
                            <!-- Generated by JS -->
                        </div>
                    </div>
                </div>
            </div>

        <!-- Lookup Validation Matrix -->
        <div class="stat-card rounded-xl p-6 glow">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-semibold text-white flex items-center gap-2">
                    <i class="fas fa-table text-purple-400"></i>
                    Lookup Validation Matrix
                </h3>
                <div class="flex gap-2">
                    <button onclick="filterLookups('all')" class="px-3 py-1 rounded-full text-xs bg-cyan-500/20 text-cyan-400">All</button>
                    <button onclick="filterLookups('pass')" class="px-3 py-1 rounded-full text-xs bg-green-500/20 text-green-400">Pass</button>
                    <button onclick="filterLookups('fail')" class="px-3 py-1 rounded-full text-xs bg-red-500/20 text-red-400">Fail</button>
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <div class="min-w-full">
                    <div class="lookup-row text-xs text-gray-500 font-medium border-b border-gray-700">
                        <div>Lookup Source</div>
                        <div>Status</div>
                        <div>Match Confidence</div>
                        <div>Action</div>
                    </div>
                    <div id="lookup-rows">
                        <!-- Generated by JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Workflow Orchestration -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            
            <!-- Decision Workflow -->
            <div class="stat-card rounded-xl p-6">
                <h3 class="text-lg font-semibold text-white mb-6 flex items-center gap-2">
                    <i class="fas fa-project-diagram text-cyan-400"></i>
                    Decision Workflow
                </h3>
                
                <div class="space-y-0" id="workflow-steps">
                    <!-- Generated by JS -->
                </div>
            </div>

            <!-- Fraud Pattern Heatmap -->
            <div class="stat-card rounded-xl p-6">
                <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-th text-orange-400"></i>
                    Fraud Pattern Detection
                </h3>
                
                <div class="mb-4">
                    <div class="flex items-center justify-between text-sm mb-2">
                        <span class="text-gray-400">Risk Indicators</span>
                        <span class="text-orange-400 font-mono">3 Alerts</span>
                    </div>
                    <div class="h-2 bg-gray-800 rounded-full overflow-hidden">
                        <div class="h-full bg-gradient-to-r from-green-400 via-orange-400 to-red-400 w-[35%]"></div>
                    </div>
                </div>
                
                <div class="grid grid-cols-8 gap-1" id="fraud-heatmap">
                    <!-- Generated by JS -->
                </div>
                
                <div class="mt-4 grid grid-cols-4 gap-2 text-center text-xs">
                    <div>
                        <div class="w-3 h-3 bg-green-500 rounded mx-auto mb-1"></div>
                        <span class="text-gray-500">Clean</span>
                    </div>
                    <div>
                        <div class="w-3 h-3 bg-yellow-500 rounded mx-auto mb-1"></div>
                        <span class="text-gray-500">Caution</span>
                    </div>
                    <div>
                        <div class="w-3 h-3 bg-orange-500 rounded mx-auto mb-1"></div>
                        <span class="text-gray-500">Review</span>
                    </div>
                    <div>
                        <div class="w-3 h-3 bg-red-500 rounded mx-auto mb-1"></div>
                        <span class="text-gray-500">Block</span>
                    </div>
                </div>
                
                <div class="mt-4">
                    <button onclick="openReviewQueue()" class="w-full py-2 bg-orange-500/20 text-orange-400 rounded-lg hover:bg-orange-500/30 transition-colors text-sm">
                        Review Queue (3)
                    </button>
                </div>
            </div>
        </div>

        <!-- Recent Decisions Log -->
        <div class="stat-card rounded-xl p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-semibold text-white flex items-center gap-2">
                    <i class="fas fa-history text-cyan-400"></i>
                    Recent Automated Decisions
                </h3>
                <div class="flex gap-2">
                    <span class="text-xs text-gray-500">Auto-refresh: 5s</span>
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead class="text-gray-500 border-b border-gray-700">
                        <tr>
                            <th class="pb-3 text-left">Time</th>
                            <th class="pb-3 text-left">Applicant</th>
                            <th class="pb-3 text-left">Risk Score</th>
                            <th class="pb-3 text-left">Pattern Matches</th>
                            <th class="pb-3 text-left">Decision</th>
                            <th class="pb-3 text-left">Reason</th>
                        </tr>
                    </thead>
                    <tbody class="mono text-xs" id="decisions-table">
                        <!-- Generated by JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Deep Analytics Dashboard -->
        <div class="analytics-grid">
            <div class="metric-card">
                <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-brain text-purple-400"></i>
                    Neural Network Performance
                </h3>
                <div class="model-performance">
                    <div class="performance-metric">
                        <div class="performance-value">98.7%</div>
                        <div class="text-sm text-gray-400">Accuracy</div>
                    </div>
                    <div class="performance-metric">
                        <div class="performance-value">0.94</div>
                        <div class="text-sm text-gray-400">F1 Score</div>
                    </div>
                    <div class="performance-metric">
                        <div class="performance-value">12ms</div>
                        <div class="text-sm text-gray-400">Latency</div>
                    </div>
                    <div class="performance-metric">
                        <div class="performance-value">1.2M</div>
                        <div class="text-sm text-gray-400">Samples</div>
                    </div>
                </div>
            </div>

            <div class="metric-card">
                <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-chart-line text-cyan-400"></i>
                    Risk Distribution
                </h3>
                <div class="risk-distribution mb-4">
                    <div class="risk-segment bg-green-500" style="width: 65%;" title="Low Risk: 65%"></div>
                    <div class="risk-segment bg-yellow-500" style="width: 25%;" title="Medium Risk: 25%"></div>
                    <div class="risk-segment bg-orange-500" style="width: 8%;" title="High Risk: 8%"></div>
                    <div class="risk-segment bg-red-500" style="width: 2%;" title="Critical Risk: 2%"></div>
                </div>
                <div class="grid grid-cols-2 gap-2 text-xs">
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 bg-green-500 rounded"></div>
                        <span class="text-gray-400">Low: 65%</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 bg-yellow-500 rounded"></div>
                        <span class="text-gray-400">Medium: 25%</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 bg-orange-500 rounded"></div>
                        <span class="text-gray-400">High: 8%</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 bg-red-500 rounded"></div>
                        <span class="text-gray-400">Critical: 2%</span>
                    </div>
                </div>
            </div>

            <div class="metric-card">
                <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-dna text-green-400"></i>
                    Feature Importance
                </h3>
                <div class="feature-importance">
                    <div class="feature-bar">
                        <div class="feature-label">Credit Score</div>
                        <div class="importance-bar">
                            <div class="importance-fill" style="width: 92%;">
                                <span class="importance-value">92%</span>
                            </div>
                        </div>
                    </div>
                    <div class="feature-bar">
                        <div class="feature-label">DTI Ratio</div>
                        <div class="importance-bar">
                            <div class="importance-fill" style="width: 87%;">
                                <span class="importance-value">87%</span>
                            </div>
                        </div>
                    </div>
                    <div class="feature-bar">
                        <div class="feature-label">Income Level</div>
                        <div class="importance-bar">
                            <div class="importance-fill" style="width: 78%;">
                                <span class="importance-value">78%</span>
                            </div>
                        </div>
                    </div>
                    <div class="feature-bar">
                        <div class="feature-label">Employment</div>
                        <div class="importance-bar">
                            <div class="importance-fill" style="width: 65%;">
                                <span class="importance-value">65%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Neural Network Visualization -->
        <div class="stat-card rounded-xl p-6">
            <h3 class="text-lg font-semibold text-white mb-6 flex items-center gap-2">
                <i class="fas fa-network-wired text-purple-400"></i>
                Deep Learning Architecture
            </h3>
            <div class="neural-network">
                <div class="neuron-layer">
                    <div class="neuron">I1</div>
                    <div class="neuron">I2</div>
                    <div class="neuron">I3</div>
                    <div class="neuron">I4</div>
                    <div class="neuron">I5</div>
                </div>
                <div class="neuron-layer">
                    <div class="neuron">H1</div>
                    <div class="neuron">H2</div>
                    <div class="neuron">H3</div>
                    <div class="neuron">H4</div>
                </div>
                <div class="neuron-layer">
                    <div class="neuron">H5</div>
                    <div class="neuron">H6</div>
                    <div class="neuron">H7</div>
                </div>
                <div class="neuron-layer">
                    <div class="neuron">O1</div>
                    <div class="neuron">O2</div>
                    <div class="neuron">O3</div>
                </div>
            </div>
        </div>

        <!-- Advanced Predictions Table -->
        <div class="stat-card rounded-xl p-6">
            <h3 class="text-lg font-semibold text-white mb-6 flex items-center gap-2">
                <i class="fas fa-table text-cyan-400"></i>
                Advanced Predictive Analytics
            </h3>
            <div class="overflow-x-auto">
                <table class="advanced-table">
                    <thead>
                        <tr>
                            <th>Application ID</th>
                            <th>Predicted Risk</th>
                            <th>Confidence</th>
                            <th>Default Probability</th>
                            <th>Recommended Action</th>
                            <th>Model Version</th>
                        </tr>
                    </thead>
                    <tbody id="predictions-table">
                        <tr>
                            <td class="text-cyan-400 mono">APP-2024-0892</td>
                            <td class="text-green-400">Low</td>
                            <td>
                                <div class="prediction-confidence">
                                    <div class="confidence-bar">
                                        <div class="confidence-fill" style="width: 94%;"></div>
                                    </div>
                                    <span class="text-xs text-gray-400">94%</span>
                                </div>
                            </td>
                            <td class="text-green-400 mono">2.3%</td>
                            <td><span class="px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs">Approve</span></td>
                            <td class="text-gray-400 mono">v2.1.3</td>
                        </tr>
                        <tr>
                            <td class="text-cyan-400 mono">APP-2024-0891</td>
                            <td class="text-orange-400">Medium</td>
                            <td>
                                <div class="prediction-confidence">
                                    <div class="confidence-bar">
                                        <div class="confidence-fill" style="width: 87%;"></div>
                                    </div>
                                    <span class="text-xs text-gray-400">87%</span>
                                </div>
                            </td>
                            <td class="text-orange-400 mono">12.7%</td>
                            <td><span class="px-2 py-1 bg-orange-500/20 text-orange-400 rounded text-xs">Review</span></td>
                            <td class="text-gray-400 mono">v2.1.3</td>
                        </tr>
                        <tr>
                            <td class="text-cyan-400 mono">APP-2024-0890</td>
                            <td class="text-red-400">High</td>
                            <td>
                                <div class="prediction-confidence">
                                    <div class="confidence-bar">
                                        <div class="confidence-fill" style="width: 91%;"></div>
                                    </div>
                                    <span class="text-xs text-gray-400">91%</span>
                                </div>
                            </td>
                            <td class="text-red-400 mono">28.4%</td>
                            <td><span class="px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs">Decline</span></td>
                            <td class="text-gray-400 mono">v2.1.3</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Real-time Decision Feed -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="stat-card rounded-xl p-6">
                <h3 class="text-lg font-semibold text-white mb-6 flex items-center gap-2">
                    <i class="fas fa-stream text-cyan-400"></i>
                    Real-time Decision Stream
                </h3>
                <div class="real-time-feed" id="real-time-feed">
                    <div class="feed-item">
                        <div class="flex items-center justify-between mb-1">
                            <span class="text-cyan-400 mono text-sm">APP-2024-0893</span>
                            <span class="text-xs text-gray-500">Just now</span>
                        </div>
                        <div class="text-sm text-white">Auto-approved: Risk score 18</div>
                        <div class="text-xs text-gray-500">Credit: 750, DTI: 22%, Income: $85k</div>
                    </div>
                    <div class="feed-item">
                        <div class="flex items-center justify-between mb-1">
                            <span class="text-orange-400 mono text-sm">APP-2024-0892</span>
                            <span class="text-xs text-gray-500">2 min ago</span>
                        </div>
                        <div class="text-sm text-white">Manual review required</div>
                        <div class="text-xs text-gray-500">Risk score 45, velocity check triggered</div>
                    </div>
                    <div class="feed-item">
                        <div class="flex items-center justify-between mb-1">
                            <span class="text-red-400 mono text-sm">APP-2024-0891</span>
                            <span class="text-xs text-gray-500">5 min ago</span>
                        </div>
                        <div class="text-sm text-white">Auto-declined: High risk</div>
                        <div class="text-xs text-gray-500">Fraud patterns detected, risk score 78</div>
                    </div>
                </div>
            </div>

            <div class="stat-card rounded-xl p-6">
                <h3 class="text-lg font-semibold text-white mb-6 flex items-center gap-2">
                    <i class="fas fa-chart-pie text-purple-400"></i>
                    Model Performance Metrics
                </h3>
                <canvas id="performanceChart" height="200"></canvas>
            </div>
        </div>

        <!-- Payments Dashboard -->
        <div id="payments-dashboard" class="dashboard-view hidden">
            <!-- Payment Processing Overview -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-dollar-sign text-green-400 text-xl"></i>
                        <span class="text-xs text-green-400">+12.5%</span>
                    </div>
                    <div class="text-2xl font-bold text-white">$2.4M</div>
                    <div class="text-sm text-gray-400">Daily Volume</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-exchange-alt text-cyan-400 text-xl"></i>
                        <span class="text-xs text-cyan-400">+8.3%</span>
                    </div>
                    <div class="text-2xl font-bold text-white">18,547</div>
                    <div class="text-sm text-gray-400">Transactions</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-credit-card text-purple-400 text-xl"></i>
                        <span class="text-xs text-purple-400">Active</span>
                    </div>
                    <div class="text-2xl font-bold text-white">8</div>
                    <div class="text-sm text-gray-400">Payment Methods</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-clock text-orange-400 text-xl"></i>
                        <span class="text-xs text-orange-400">-15ms</span>
                    </div>
                    <div class="text-2xl font-bold text-white">124ms</div>
                    <div class="text-sm text-gray-400">Avg Processing</div>
                </div>
            </div>

            <!-- Payment Methods Grid -->
            <div class="stat-card rounded-xl p-6">
                <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-plug text-cyan-400"></i>
                    Platform Monitoring
                </h3>
                
                <!-- Payment Volume Trends Chart -->
                <div class="mb-6">
                    <canvas id="paymentChart" height="150"></canvas>
                </div>
                
                <!-- Enhanced Platform Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6" id="enhanced-platform-grid">
                    <!-- Generated by JS -->
                </div>
                
                <!-- Device Allocation Matrix -->
                <div class="mb-6">
                    <h4 class="text-white font-semibold mb-3 flex items-center gap-2">
                        <i class="fas fa-mobile-alt text-cyan-400"></i>
                        DuoPlus Device Allocation
                    </h4>
                    <div class="grid grid-cols-4 md:grid-cols-8 gap-2" id="device-allocation-matrix">
                        <!-- Generated by JS -->
                    </div>
                </div>
                
                <!-- Active Sessions -->
                <div class="mb-6">
                    <h4 class="text-white font-semibold mb-3 flex items-center gap-2">
                        <i class="fas fa-robot text-purple-400"></i>
                        Active Device Sessions
                    </h4>
                    <div class="space-y-2" id="active-device-sessions">
                        <!-- Generated by JS -->
                    </div>
                </div>
                
                <!-- DuoPlus Device Allocation Section -->
                <div class="mb-6 bg-orange-500/5 rounded-xl p-4 border border-orange-500/20">
                    <div class="flex items-center justify-between mb-4">
                        <h4 class="text-white font-semibold flex items-center gap-2">
                            <i class="fas fa-mobile-alt text-cyan-400"></i>
                            DuoPlus Device Allocation
                        </h4>
                        <div class="flex items-center gap-2">
                            <span class="status-dot status-processing animate-pulse"></span>
                            <span class="text-sm text-cyan-400">Cloud Connected</span>
                        </div>
                    </div>

                    <!-- Device Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4" id="duoplus-devices">
                        <!-- Devices injected via API -->
                    </div>

                    <!-- Active Device Console -->
                    <div id="active-device-console" class="hidden bg-black/50 rounded-xl border border-cyan-500/30 p-4 mb-4">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <img id="device-screenshot" class="w-32 h-56 rounded-lg border border-gray-700 object-cover" src="" alt="Device Screen">
                                <div>
                                    <h5 class="text-white font-semibold" id="device-model">Samsung Galaxy S23</h5>
                                    <p class="text-sm text-gray-400" id="device-location">📍 Los Angeles, CA (US)</p>
                                    <p class="text-xs text-cyan-400 mt-1" id="device-ip">IP: 192.168.1.XXX</p>
                                    <div class="flex gap-2 mt-2">
                                        <span class="px-2 py-1 rounded bg-green-500/10 text-green-400 text-xs border border-green-500/20">
                                            <i class="fas fa-wifi mr-1"></i>5G Connected
                                        </span>
                                        <span class="px-2 py-1 rounded bg-cyan-500/10 text-cyan-400 text-xs border border-cyan-500/20">
                                            <i class="fas fa-fingerprint mr-1"></i>Real Device
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col gap-2">
                                <button onclick="refreshDevice()" class="px-3 py-1 bg-white/5 hover:bg-white/10 rounded text-xs text-white">
                                    <i class="fas fa-sync"></i> Refresh
                                </button>
                                <button onclick="releaseDevice()" class="px-3 py-1 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded text-xs border border-red-500/30">
                                    <i class="fas fa-times"></i> Release
                                </button>
                            </div>
                        </div>

                        <!-- Automation Tasks Log -->
                        <div class="bg-black/30 rounded-lg p-3 font-mono text-xs h-32 overflow-y-auto" id="device-logs">
                            <div class="text-gray-500">[System] Waiting for device allocation...</div>
                        </div>
                    </div>

                    <div class="flex justify-between">
                        <button onclick="provisionWithDevice()" class="px-6 py-2 bg-cyan-500 hover:bg-cyan-400 text-black font-semibold rounded-lg transition-colors flex items-center gap-2">
                            Continue with Device <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="bg-black/30 rounded-lg p-4 border border-green-500/30">
                        <div class="flex items-center gap-3 mb-2">
                            <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
                                <i class="fab fa-stripe text-white"></i>
                            </div>
                            <div>
                                <div class="text-white font-medium">Stripe</div>
                                <div class="text-xs text-green-400">Connected</div>
                            </div>
                        </div>
                        <div class="text-xs text-gray-400">
                            <div>Volume: $847K</div>
                            <div>Success Rate: 99.2%</div>
                        </div>
                    </div>
                    <div class="bg-black/30 rounded-lg p-4 border border-green-500/30">
                        <div class="flex items-center gap-3 mb-2">
                            <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-800 rounded-lg flex items-center justify-center">
                                <i class="fab fa-paypal text-white"></i>
                            </div>
                            <div>
                                <div class="text-white font-medium">PayPal</div>
                                <div class="text-xs text-green-400">Connected</div>
                            </div>
                        </div>
                        <div class="text-xs text-gray-400">
                            <div>Volume: $623K</div>
                            <div>Success Rate: 98.8%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Compliance Dashboard -->
        <div id="compliance-dashboard" class="dashboard-view hidden">
            <!-- Compliance Overview -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-shield-alt text-green-400 text-xl"></i>
                        <span class="text-xs text-green-400">Compliant</span>
                    </div>
                    <div class="text-2xl font-bold text-white">100%</div>
                    <div class="text-sm text-gray-400">Regulatory Score</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-user-check text-cyan-400 text-xl"></i>
                        <span class="text-xs text-cyan-400">Active</span>
                    </div>
                    <div class="text-2xl font-bold text-white">2,847</div>
                    <div class="text-sm text-gray-400">KYC Verified</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-exclamation-triangle text-yellow-400 text-xl"></i>
                        <span class="text-xs text-yellow-400">3 Alerts</span>
                    </div>
                    <div class="text-2xl font-bold text-white">12</div>
                    <div class="text-sm text-gray-400">Pending Reviews</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-file-contract text-purple-400 text-xl"></i>
                        <span class="text-xs text-purple-400">Updated</span>
                    </div>
                    <div class="text-2xl font-bold text-white">v2.4</div>
                    <div class="text-sm text-gray-400">Policy Version</div>
                </div>
            </div>

            <!-- Compliance Risk Assessment Chart -->
            <div class="stat-card rounded-xl p-6 mb-6">
                <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-chart-radar text-purple-400"></i>
                    Risk Assessment Matrix
                </h3>
                <canvas id="complianceChart" height="200"></canvas>
            </div>

            <!-- Compliance Matrix -->
            <div class="stat-card rounded-xl p-6">
                <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-tasks text-cyan-400"></i>
                    Compliance Checklist
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-black/30 rounded-lg">
                            <div class="flex items-center gap-3">
                                <i class="fas fa-check-circle text-green-400"></i>
                                <div>
                                    <div class="text-white text-sm">AML Screening</div>
                                    <div class="text-xs text-gray-500">OFAC, sanctions lists</div>
                                </div>
                            </div>
                            <span class="text-xs text-green-400">Pass</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-black/30 rounded-lg">
                            <div class="flex items-center gap-3">
                                <i class="fas fa-check-circle text-green-400"></i>
                                <div>
                                    <div class="text-white text-sm">Identity Verification</div>
                                    <div class="text-xs text-gray-500">Document OCR, biometric</div>
                                </div>
                            </div>
                            <span class="text-xs text-green-400">Pass</span>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-black/30 rounded-lg">
                            <div class="flex items-center gap-3">
                                <i class="fas fa-exclamation-circle text-yellow-400"></i>
                                <div>
                                    <div class="text-white text-sm">Data Privacy</div>
                                    <div class="text-xs text-gray-500">GDPR, CCPA compliance</div>
                                </div>
                            </div>
                            <span class="text-xs text-yellow-400">Review</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-black/30 rounded-lg">
                            <div class="flex items-center gap-3">
                                <i class="fas fa-check-circle text-green-400"></i>
                                <div>
                                    <div class="text-white text-sm">Financial Reporting</div>
                                    <div class="text-xs text-gray-500">SAR, CTR filings</div>
                                </div>
                            </div>
                            <span class="text-xs text-green-400">Pass</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Dashboard -->
        <div id="analytics-dashboard" class="dashboard-view hidden">
            <!-- Analytics Overview -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-chart-line text-green-400 text-xl"></i>
                        <span class="text-xs text-green-400">+24%</span>
                    </div>
                    <div class="text-2xl font-bold text-white">87.3%</div>
                    <div class="text-sm text-gray-400">Approval Rate</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-users text-cyan-400 text-xl"></i>
                        <span class="text-xs text-cyan-400">+156</span>
                    </div>
                    <div class="text-2xl font-bold text-white">12,847</div>
                    <div class="text-sm text-gray-400">Total Users</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-brain text-purple-400 text-xl"></i>
                        <span class="text-xs text-purple-400">Optimal</span>
                    </div>
                    <div class="text-2xl font-bold text-white">98.7%</div>
                    <div class="text-sm text-gray-400">Model Accuracy</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-clock text-orange-400 text-xl"></i>
                        <span class="text-xs text-orange-400">-8ms</span>
                    </div>
                    <div class="text-2xl font-bold text-white">0.8s</div>
                    <div class="text-sm text-gray-400">Avg Decision Time</div>
                </div>
            </div>

            <!-- Deep Analytics Dashboard -->
            <div class="analytics-grid">
                <div class="metric-card">
                    <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                        <i class="fas fa-brain text-purple-400"></i>
                        Neural Network Performance
                    </h3>
                    <div class="model-performance">
                        <div class="performance-metric">
                            <div class="performance-value">98.7%</div>
                            <div class="text-sm text-gray-400">Accuracy</div>
                        </div>
                        <div class="performance-metric">
                            <div class="performance-value">0.94</div>
                            <div class="text-sm text-gray-400">F1 Score</div>
                        </div>
                        <div class="performance-metric">
                            <div class="performance-value">12ms</div>
                            <div class="text-sm text-gray-400">Latency</div>
                        </div>
                        <div class="performance-metric">
                            <div class="performance-value">1.2M</div>
                            <div class="text-sm text-gray-400">Samples</div>
                        </div>
                    </div>
                </div>

                <div class="metric-card">
                    <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                        <i class="fas fa-chart-line text-cyan-400"></i>
                        Risk Distribution
                    </h3>
                    <div class="risk-distribution mb-4">
                        <div class="risk-segment bg-green-500" style="width: 65%;" title="Low Risk: 65%"></div>
                        <div class="risk-segment bg-yellow-500" style="width: 25%;" title="Medium Risk: 25%"></div>
                        <div class="risk-segment bg-orange-500" style="width: 8%;" title="High Risk: 8%"></div>
                        <div class="risk-segment bg-red-500" style="width: 2%;" title="Critical Risk: 2%"></div>
                    </div>
                    <div class="grid grid-cols-2 gap-2 text-xs">
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 bg-green-500 rounded"></div>
                            <span class="text-gray-400">Low: 65%</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 bg-yellow-500 rounded"></div>
                            <span class="text-gray-400">Medium: 25%</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 bg-orange-500 rounded"></div>
                            <span class="text-gray-400">High: 8%</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 bg-red-500 rounded"></div>
                            <span class="text-gray-400">Critical: 2%</span>
                        </div>
                    </div>
                </div>

                <div class="metric-card">
                    <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                        <i class="fas fa-dna text-green-400"></i>
                        Feature Importance
                    </h3>
                    <div class="feature-importance">
                        <div class="feature-bar">
                            <div class="feature-label">Credit Score</div>
                            <div class="importance-bar">
                                <div class="importance-fill" style="width: 92%;">
                                    <span class="importance-value">92%</span>
                                </div>
                            </div>
                        </div>
                        <div class="feature-bar">
                            <div class="feature-label">DTI Ratio</div>
                            <div class="importance-bar">
                                <div class="importance-fill" style="width: 87%;">
                                    <span class="importance-value">87%</span>
                                </div>
                            </div>
                        </div>
                        <div class="feature-bar">
                            <div class="feature-label">Income Level</div>
                            <div class="importance-bar">
                                <div class="importance-fill" style="width: 78%;">
                                    <span class="importance-value">78%</span>
                                </div>
                            </div>
                        </div>
                        <div class="feature-bar">
                            <div class="feature-label">Employment</div>
                            <div class="importance-bar">
                                <div class="importance-fill" style="width: 65%;">
                                    <span class="importance-value">65%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Review Queue Modal -->
        <div id="review-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
            <div class="stat-card w-full max-w-2xl rounded-2xl border border-orange-500/30 glow-orange max-h-[80vh] overflow-hidden flex flex-col">
                <!-- Modal Header -->
                <div class="p-6 border-b border-white/10 flex items-center justify-between bg-orange-500/10">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded-full bg-orange-500/20 flex items-center justify-center">
                            <i class="fas fa-exclamation-triangle text-orange-400"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-white">Manual Review Queue</h3>
                            <p class="text-sm text-gray-400">3 automations require attention</p>
                        </div>
                    </div>
                    <button onclick="closeReviewQueue()" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <!-- Queue Items -->
                <div class="p-6 overflow-y-auto space-y-4" id="review-queue-items">
                    <!-- Items injected by JS -->
                </div>
                
                <!-- Modal Footer -->
                <div class="p-4 border-t border-white/10 bg-black/30 flex justify-between items-center">
                    <span class="text-sm text-gray-400" id="queue-stats">Showing 3 of 3 items</span>
                    <div class="flex gap-2">
                        <button onclick="bulkApprove()" class="px-4 py-2 bg-green-500/20 text-green-400 rounded-lg hover:bg-green-500/30 transition-colors text-sm flex items-center gap-2">
                            <i class="fas fa-check"></i> Approve All
                        </button>
                        <button onclick="closeReviewQueue()" class="px-4 py-2 bg-white/5 text-white rounded-lg hover:bg-white/10 transition-colors text-sm">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Platform Detail Modal -->
        <div id="platform-detail-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
            <div class="stat-card w-full max-w-2xl rounded-2xl border border-cyan-500/30 glow-cyan max-h-[80vh] overflow-hidden flex flex-col">
                <!-- Modal Header -->
                <div class="p-6 border-b border-white/10 flex items-center justify-between bg-cyan-500/10">
                    <div class="flex items-center gap-3">
                        <div id="detail-platform-icon" class="w-12 h-12 rounded-lg flex items-center justify-center">
                            <!-- Icon injected by JS -->
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-white" id="detail-platform-name">Platform Name</h3>
                            <div class="flex items-center gap-2 mt-1">
                                <span id="detail-platform-status" class="text-xs px-2 py-0.5 rounded">Status</span>
                                <span id="detail-duo-status" class="text-xs px-2 py-0.5 rounded">DuoPlus Status</span>
                            </div>
                        </div>
                    </div>
                    <button onclick="closePlatformDetail()" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <!-- Modal Content -->
                <div class="p-6 overflow-y-auto space-y-6">
                    <!-- Performance Metrics -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="bg-black/30 rounded-lg p-3">
                            <div class="text-xs text-gray-500 mb-1">Latency</div>
                            <div class="text-lg font-bold text-cyan-400" id="detail-latency">--</div>
                        </div>
                        <div class="bg-black/30 rounded-lg p-3">
                            <div class="text-xs text-gray-500 mb-1">Success Rate</div>
                            <div class="text-lg font-bold text-green-400" id="detail-success">--</div>
                        </div>
                        <div class="bg-black/30 rounded-lg p-3">
                            <div class="text-xs text-gray-500 mb-1">Rate Limit</div>
                            <div class="text-lg font-bold text-orange-400" id="detail-rate">--</div>
                        </div>
                        <div class="bg-black/30 rounded-lg p-3">
                            <div class="text-xs text-gray-500 mb-1">Features</div>
                            <div class="text-lg font-bold text-purple-400" id="detail-features">--</div>
                        </div>
                    </div>
                    
                    <!-- Health Timeline -->
                    <div>
                        <h4 class="text-white font-semibold mb-3 flex items-center gap-2">
                            <i class="fas fa-chart-line text-cyan-400"></i>
                            24-Hour Health Timeline
                        </h4>
                        <div class="bg-black/30 rounded-lg p-4">
                            <div class="flex items-end gap-0.5 h-16" id="health-timeline">
                                <!-- Timeline bars injected by JS -->
                            </div>
                            <div class="flex justify-between text-xs text-gray-500 mt-2">
                                <span>24h ago</span>
                                <span>Now</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Error Log -->
                    <div>
                        <h4 class="text-white font-semibold mb-3 flex items-center gap-2">
                            <i class="fas fa-exclamation-triangle text-red-400"></i>
                            Recent Errors
                        </h4>
                        <div class="bg-black/30 rounded-lg p-4 font-mono text-xs" id="platform-error-log">
                            <!-- Error log injected by JS -->
                        </div>
                    </div>
                </div>
                
                <!-- Modal Footer -->
                <div class="p-4 border-t border-white/10 bg-black/30 flex justify-end">
                    <button onclick="closePlatformDetail()" class="px-4 py-2 bg-white/5 text-white rounded-lg hover:bg-white/10 transition-colors">
                        Close
                    </button>
                </div>
            </div>
        </div>

        <!-- Decision Explanation Modal -->
        <div id="xai-modal" class="fixed inset-0 bg-black/90 backdrop-blur-md z-50 hidden flex items-center justify-center p-4">
            <div class="stat-card w-full max-w-4xl rounded-2xl border border-cyan-500/30 glow max-h-[90vh] overflow-hidden flex flex-col">
                <div class="p-6 border-b border-white/10 flex items-center justify-between bg-gradient-to-r from-cyan-500/10 to-purple-500/10">
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 rounded-full bg-cyan-500/20 flex items-center justify-center">
                            <i class="fas fa-brain text-cyan-400 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-white">Decision Explanation</h3>
                            <p class="text-sm text-gray-400">APP-2024-0892 • Neural Network Analysis</p>
                        </div>
                    </div>
                    <button onclick="closeXAIModal()" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
                
                <div class="p-6 overflow-y-auto space-y-6">
                    <!-- SHAP Values Visualization -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-black/40 rounded-xl p-4 border border-white/10">
                            <h4 class="text-white font-semibold mb-4 flex items-center gap-2">
                                <i class="fas fa-arrow-up text-green-400"></i>
                                Approval Factors (Positive)
                            </h4>
                            <div class="space-y-3" id="shap-positive">
                                <div class="flex items-center gap-3">
                                    <div class="flex-1 bg-gray-800 rounded-full h-2 overflow-hidden">
                                        <div class="bg-green-400 h-full rounded-full" style="width: 92%"></div>
                                    </div>
                                    <span class="text-xs text-green-400 w-12 text-right">+0.42</span>
                                    <span class="text-xs text-gray-400 w-24">Credit Score</span>
                                </div>
                                <div class="flex items-center gap-3">
                                    <div class="flex-1 bg-gray-800 rounded-full h-2 overflow-hidden">
                                        <div class="bg-green-400 h-full rounded-full" style="width: 78%"></div>
                                    </div>
                                    <span class="text-xs text-green-400 w-12 text-right">+0.31</span>
                                    <span class="text-xs text-gray-400 w-24">Income Stability</span>
                                </div>
                                <div class="flex items-center gap-3">
                                    <div class="flex-1 bg-gray-800 rounded-full h-2 overflow-hidden">
                                        <div class="bg-green-400 h-full rounded-full" style="width: 65%"></div>
                                    </div>
                                    <span class="text-xs text-green-400 w-12 text-right">+0.18</span>
                                    <span class="text-xs text-gray-400 w-24">Employment History</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-black/40 rounded-xl p-4 border border-white/10">
                            <h4 class="text-white font-semibold mb-4 flex items-center gap-2">
                                <i class="fas fa-arrow-down text-red-400"></i>
                                Risk Factors (Negative)
                            </h4>
                            <div class="space-y-3" id="shap-negative">
                                <div class="flex items-center gap-3">
                                    <div class="flex-1 bg-gray-800 rounded-full h-2 overflow-hidden">
                                        <div class="bg-red-400 h-full rounded-full" style="width: 25%"></div>
                                    </div>
                                    <span class="text-xs text-red-400 w-12 text-right">-0.08</span>
                                    <span class="text-xs text-gray-400 w-24">Recent Inquiry</span>
                                </div>
                                <div class="flex items-center gap-3">
                                    <div class="flex-1 bg-gray-800 rounded-full h-2 overflow-hidden">
                                        <div class="bg-red-400 h-full rounded-full" style="width: 15%"></div>
                                    </div>
                                    <span class="text-xs text-red-400 w-12 text-right">-0.03</span>
                                    <span class="text-xs text-gray-400 w-24">Address Change</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Attention Heatmap -->
                    <div class="bg-black/40 rounded-xl p-4 border border-white/10">
                        <h4 class="text-white font-semibold mb-4">Neural Attention Map</h4>
                        <div class="grid grid-cols-6 gap-2" id="attention-grid">
                            <!-- Generated by JS -->
                        </div>
                        <p class="text-xs text-gray-500 mt-2 text-center">Brighter cells indicate higher influence on decision outcome</p>
                    </div>

                    <!-- Counterfactual Analysis -->
                    <div class="bg-black/40 rounded-xl p-4 border border-white/10">
                        <h4 class="text-white font-semibold mb-4 flex items-center gap-2">
                            <i class="fas fa-exchange-alt text-purple-400"></i>
                            Counterfactual Scenarios
                        </h4>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between p-3 bg-white/5 rounded-lg border-l-4 border-yellow-400">
                                <div>
                                    <div class="text-sm text-white">If credit score was 650 instead of 720</div>
                                    <div class="text-xs text-gray-500">Decision would change to: <span class="text-orange-400">MANUAL REVIEW</span></div>
                                </div>
                                <div class="text-right">
                                    <div class="text-xs text-gray-400">Confidence drop</div>
                                    <div class="text-sm text-red-400">-34%</div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-white/5 rounded-lg border-l-4 border-red-400">
                                <div>
                                    <div class="text-sm text-white">If DTI ratio was >40%</div>
                                    <div class="text-xs text-gray-500">Decision would change to: <span class="text-red-400">REJECTED</span></div>
                                </div>
                                <div class="text-right">
                                    <div class="text-xs text-gray-400">Risk increase</div>
                                    <div class="text-sm text-red-400">+52%</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Similar Cases -->
                    <div class="bg-black/40 rounded-xl p-4 border border-white/10">
                        <h4 class="text-white font-semibold mb-4">Historically Similar Decisions</h4>
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div class="p-3 bg-green-500/10 rounded-lg border border-green-500/20">
                                <div class="text-2xl font-bold text-green-400">94%</div>
                                <div class="text-xs text-gray-400">Approved</div>
                                <div class="text-xs text-gray-500 mt-1">n=1,247</div>
                            </div>
                            <div class="p-3 bg-orange-500/10 rounded-lg border border-orange-500/20">
                                <div class="text-2xl font-bold text-orange-400">5%</div>
                                <div class="text-xs text-gray-400">Manual Review</div>
                                <div class="text-xs text-gray-500 mt-1">n=66</div>
                            </div>
                            <div class="p-3 bg-red-500/10 rounded-lg border border-red-500/20">
                                <div class="text-2xl font-bold text-red-400">1%</div>
                                <div class="text-xs text-gray-400">Rejected</div>
                                <div class="text-xs text-gray-500 mt-1">n=13</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="p-4 border-t border-white/10 bg-black/30 flex justify-between items-center">
                    <button onclick="exportExplanation()" class="px-4 py-2 bg-white/5 text-white rounded-lg hover:bg-white/10 transition-colors text-sm flex items-center gap-2">
                        <i class="fas fa-download"></i> Export Report
                    </button>
                    <button onclick="challengeDecision()" class="px-4 py-2 bg-cyan-500/20 text-cyan-400 rounded-lg hover:bg-cyan-500/30 transition-colors text-sm flex items-center gap-2">
                        <i class="fas fa-gavel"></i> Challenge Decision
                    </button>
                </div>
            </div>
        </div>

        <!-- Audit Trail Timeline -->
        <div id="audit-modal" class="fixed inset-0 bg-black/90 backdrop-blur-md z-50 hidden flex items-center justify-center p-4">
            <div class="stat-card w-full max-w-3xl rounded-2xl border border-purple-500/30 glow-purple max-h-[90vh] overflow-hidden flex flex-col">
                <div class="p-6 border-b border-white/10 flex items-center justify-between">
                    <h3 class="text-xl font-bold text-white flex items-center gap-2">
                        <i class="fas fa-history text-purple-400"></i>
                        Complete Audit Trail
                    </h3>
                    <button onclick="closeAuditModal()" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="p-6 overflow-y-auto">
                    <div class="relative border-l-2 border-purple-500/30 ml-4 space-y-6" id="audit-timeline">
                        <!-- Timeline items injected here -->
                    </div>
                </div>
                
                <div class="p-4 border-t border-white/10 bg-black/30 flex justify-end">
                    <button onclick="exportAuditPDF()" class="px-4 py-2 bg-purple-500/20 text-purple-400 rounded-lg hover:bg-purple-500/30 transition-colors text-sm flex items-center gap-2">
                        <i class="fas fa-file-pdf"></i> Export PDF
                    </button>
                </div>
            </div>
        </div>

        <!-- Tenant Management Dashboard -->
        <div id="tenant-dashboard" class="dashboard-view hidden">
            <!-- Tenant Overview -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-building text-cyan-400 text-xl"></i>
                        <span class="text-xs text-cyan-400">Active</span>
                    </div>
                    <div class="text-2xl font-bold text-white">4</div>
                    <div class="text-sm text-gray-400">Total Tenants</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-users text-purple-400 text-xl"></i>
                        <span class="text-xs text-purple-400">+12%</span>
                    </div>
                    <div class="text-2xl font-bold text-white">4,996</div>
                    <div class="text-sm text-gray-400">Total Users</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-dollar-sign text-green-400 text-xl"></i>
                        <span class="text-xs text-green-400">+18%</span>
                    </div>
                    <div class="text-2xl font-bold text-white">$23.5M</div>
                    <div class="text-sm text-gray-400">Monthly Volume</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-brain text-orange-400 text-xl"></i>
                        <span class="text-xs text-orange-400">7 Active</span>
                    </div>
                    <div class="text-2xl font-bold text-white">7</div>
                    <div class="text-sm text-gray-400">Deployed Models</div>
                </div>
            </div>

            <!-- Tenant Table -->
            <div class="stat-card rounded-xl p-6 mb-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-white flex items-center gap-2">
                        <i class="fas fa-building text-cyan-400"></i>
                        Tenant Management
                    </h3>
                    <button onclick="createTenant()" class="px-3 py-1.5 bg-cyan-500/20 text-cyan-400 rounded hover:bg-cyan-500/30 transition-colors text-sm">
                        <i class="fas fa-plus mr-1"></i> Add Tenant
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="text-left text-gray-400 text-xs border-b border-gray-800">
                                <th class="pb-3">Tenant</th>
                                <th class="pb-3">Plan</th>
                                <th class="pb-3">Users</th>
                                <th class="pb-3">Volume</th>
                                <th class="pb-3">Models</th>
                                <th class="pb-3">Status</th>
                                <th class="pb-3">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="tenant-table">
                            <!-- Generated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Resource Isolation Visualization -->
            <div class="stat-card rounded-xl p-6">
                <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-shield-alt text-purple-400"></i>
                    Multi-Tenant Isolation
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="isolation-viz">
                    <!-- Generated by JS -->
                </div>
            </div>
        </div>

        <!-- Alert Management Dashboard -->
        <div id="alerting-dashboard" class="dashboard-view hidden">
            <!-- Alert Overview -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-exclamation-triangle text-red-400 text-xl"></i>
                        <span class="text-xs text-red-400">2 Active</span>
                    </div>
                    <div class="text-2xl font-bold text-white">3</div>
                    <div class="text-sm text-gray-400">Critical Alerts</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-exclamation-circle text-orange-400 text-xl"></i>
                        <span class="text-xs text-orange-400">5 Active</span>
                    </div>
                    <div class="text-2xl font-bold text-white">8</div>
                    <div class="text-sm text-gray-400">Warning Alerts</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-check-circle text-green-400 text-xl"></i>
                        <span class="text-xs text-green-400">MTTR: 12m</span>
                    </div>
                    <div class="text-2xl font-bold text-white">94%</div>
                    <div class="text-sm text-gray-400">Resolution Rate</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-clock text-cyan-400 text-xl"></i>
                        <span class="text-xs text-cyan-400">-2m</span>
                    </div>
                    <div class="text-2xl font-bold text-white">3m</div>
                    <div class="text-sm text-gray-400">Avg Response</div>
                </div>
            </div>

            <!-- Alert Feed & Charts -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Alert Feed -->
                <div class="lg:col-span-2">
                    <div class="stat-card rounded-xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold text-white flex items-center gap-2">
                                <i class="fas fa-bell text-orange-400"></i>
                                Active Alerts
                            </h3>
                            <div class="flex gap-2">
                                <button onclick="acknowledgeAll()" class="px-3 py-1.5 bg-green-500/20 text-green-400 rounded hover:bg-green-500/30 transition-colors text-sm">
                                    Ack All
                                </button>
                                <button onclick="createAlertRule()" class="px-3 py-1.5 bg-cyan-500/20 text-cyan-400 rounded hover:bg-cyan-500/30 transition-colors text-sm">
                                    <i class="fas fa-plus"></i> Rule
                                </button>
                            </div>
                        </div>
                        <div class="space-y-3 max-h-96 overflow-y-auto" id="alert-feed">
                            <!-- Generated by JS -->
                        </div>
                    </div>
                </div>

                <!-- Alert Charts -->
                <div class="space-y-6">
                    <div class="stat-card rounded-xl p-6">
                        <h4 class="text-white font-semibold mb-4">Alert Volume (24h)</h4>
                        <canvas id="alertVolumeChart" height="150"></canvas>
                    </div>
                    <div class="stat-card rounded-xl p-6">
                        <h4 class="text-white font-semibold mb-4">Alert Types</h4>
                        <canvas id="alertTypeChart" height="150"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- ML Model Registry Dashboard -->
        <div id="models-dashboard" class="dashboard-view hidden">
            <!-- Model Overview -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-brain text-purple-400 text-xl"></i>
                        <span class="text-xs text-purple-400">2 Active</span>
                    </div>
                    <div class="text-2xl font-bold text-white">4</div>
                    <div class="text-sm text-gray-400">Total Models</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-rocket text-cyan-400 text-xl"></i>
                        <span class="text-xs text-cyan-400">v3.0.0</span>
                    </div>
                    <div class="text-2xl font-bold text-white">98.7%</div>
                    <div class="text-sm text-gray-400">Best Accuracy</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-tachometer-alt text-green-400 text-xl"></i>
                        <span class="text-xs text-green-400">8ms</span>
                    </div>
                    <div class="text-2xl font-bold text-white">12ms</div>
                    <div class="text-sm text-gray-400">Avg Latency</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-code-branch text-orange-400 text-xl"></i>
                        <span class="text-xs text-orange-400">1 Pending</span>
                    </div>
                    <div class="text-2xl font-bold text-white">3</div>
                    <div class="text-sm text-gray-400">Deployments</div>
                </div>
            </div>

            <!-- Model Registry Table -->
            <div class="stat-card rounded-xl p-6 mb-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-white flex items-center gap-2">
                        <i class="fas fa-brain text-purple-400"></i>
                        Model Registry
                    </h3>
                    <div class="flex gap-2">
                        <button onclick="registerModel()" class="px-3 py-1.5 bg-purple-500/20 text-purple-400 rounded hover:bg-purple-500/30 transition-colors text-sm">
                            <i class="fas fa-plus"></i> Register
                        </button>
                        <button onclick="startTraining()" class="px-3 py-1.5 bg-cyan-500/20 text-cyan-400 rounded hover:bg-cyan-500/30 transition-colors text-sm">
                            <i class="fas fa-play"></i> Train
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="text-left text-gray-400 text-xs border-b border-gray-800">
                                <th class="pb-3">Model</th>
                                <th class="pb-3">Version</th>
                                <th class="pb-3">Stage</th>
                                <th class="pb-3">Accuracy</th>
                                <th class="pb-3">Latency</th>
                                <th class="pb-3">Deployed</th>
                                <th class="pb-3">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="model-table">
                            <!-- Generated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Model Pipeline -->
            <div class="stat-card rounded-xl p-6">
                <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-project-diagram text-cyan-400"></i>
                    ML Pipeline Status
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                    <div class="text-center cursor-pointer" onclick="showPipelineStage('data')">
                        <div class="w-12 h-12 mx-auto rounded-full bg-green-500/20 flex items-center justify-center mb-2">
                            <i class="fas fa-database text-green-400"></i>
                        </div>
                        <div class="text-sm text-white font-medium">Data Prep</div>
                        <div class="text-xs text-green-400">Ready</div>
                    </div>
                    <div class="text-center cursor-pointer" onclick="showPipelineStage('training')">
                        <div class="w-12 h-12 mx-auto rounded-full bg-cyan-500/20 flex items-center justify-center mb-2">
                            <i class="fas fa-cogs text-cyan-400"></i>
                        </div>
                        <div class="text-sm text-white font-medium">Training</div>
                        <div class="text-xs text-cyan-400">45%</div>
                    </div>
                    <div class="text-center cursor-pointer" onclick="showPipelineStage('validation')">
                        <div class="w-12 h-12 mx-auto rounded-full bg-orange-500/20 flex items-center justify-center mb-2">
                            <i class="fas fa-check-circle text-orange-400"></i>
                        </div>
                        <div class="text-sm text-white font-medium">Validation</div>
                        <div class="text-xs text-orange-400">Queued</div>
                    </div>
                    <div class="text-center cursor-pointer" onclick="showPipelineStage('staging')">
                        <div class="w-12 h-12 mx-auto rounded-full bg-purple-500/20 flex items-center justify-center mb-2">
                            <i class="fas fa-flask text-purple-400"></i>
                        </div>
                        <div class="text-sm text-white font-medium">Staging</div>
                        <div class="text-xs text-purple-400">Ready</div>
                    </div>
                    <div class="text-center cursor-pointer" onclick="showPipelineStage('production')">
                        <div class="w-12 h-12 mx-auto rounded-full bg-gray-500/20 flex items-center justify-center mb-2">
                            <i class="fas fa-rocket text-gray-400"></i>
                        </div>
                        <div class="text-sm text-white font-medium">Production</div>
                        <div class="text-xs text-gray-400">Pending</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tenant Management Modal -->
        <div id="tenant-modal" class="fixed inset-0 bg-black/90 backdrop-blur-md z-50 hidden flex items-center justify-center p-4">
            <div class="stat-card w-full max-w-2xl rounded-2xl border border-cyan-500/30 glow-cyan max-h-[80vh] overflow-hidden flex flex-col">
                <div class="p-6 border-b border-white/10 flex items-center justify-between">
                    <div>
                        <h3 class="text-xl font-bold text-white" id="tenant-modal-name">Tenant Name</h3>
                        <p class="text-sm text-gray-400" id="tenant-modal-id">tenant-id</p>
                    </div>
                    <button onclick="closeTenantModal()" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="p-6 overflow-y-auto space-y-6">
                    <!-- Tenant Configuration -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-xs text-gray-500 block mb-1">Plan</label>
                            <select class="w-full bg-black/50 border border-gray-700 rounded px-3 py-2 text-white">
                                <option>Enterprise</option>
                                <option>Professional</option>
                                <option>Starter</option>
                            </select>
                        </div>
                        <div>
                            <label class="text-xs text-gray-500 block mb-1">Status</label>
                            <select class="w-full bg-black/50 border border-gray-700 rounded px-3 py-2 text-white">
                                <option>Active</option>
                                <option>Suspended</option>
                                <option>Trial</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Resource Quotas -->
                    <div>
                        <h4 class="text-white font-semibold mb-3">Resource Quotas</h4>
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between text-xs mb-1">
                                    <span class="text-gray-500">API Calls</span>
                                    <span class="text-cyan-400">84%</span>
                                </div>
                                <div class="h-2 bg-gray-800 rounded-full overflow-hidden">
                                    <div class="h-full bg-cyan-400" style="width: 84%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-xs mb-1">
                                    <span class="text-gray-500">Storage</span>
                                    <span class="text-purple-400">45%</span>
                                </div>
                                <div class="h-2 bg-gray-800 rounded-full overflow-hidden">
                                    <div class="h-full bg-purple-400" style="width: 45%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-xs mb-1">
                                    <span class="text-gray-500">Compute</span>
                                    <span class="text-green-400">24%</span>
                                </div>
                                <div class="h-2 bg-gray-800 rounded-full overflow-hidden">
                                    <div class="h-full bg-green-400" style="width: 24%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="p-4 border-t border-white/10 bg-black/30 flex justify-between">
                    <div class="flex gap-2">
                        <button onclick="impersonateTenant()" class="px-3 py-2 bg-cyan-500/20 text-cyan-400 rounded hover:bg-cyan-500/30 transition-colors text-sm">
                            <i class="fas fa-user-secret mr-1"></i> Impersonate
                        </button>
                        <button onclick="suspendTenant()" class="px-3 py-2 bg-red-500/20 text-red-400 rounded hover:bg-red-500/30 transition-colors text-sm">
                            <i class="fas fa-pause mr-1"></i> Suspend
                        </button>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="closeTenantModal()" class="px-3 py-2 bg-white/5 text-white rounded hover:bg-white/10 transition-colors text-sm">
                            Cancel
                        </button>
                        <button onclick="saveTenantConfig()" class="px-3 py-2 bg-cyan-500 text-black rounded hover:bg-cyan-400 transition-colors text-sm">
                            Save Changes
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Alert Management Modal -->
        <div id="alert-modal" class="fixed inset-0 bg-black/90 backdrop-blur-md z-50 hidden flex items-center justify-center p-4">
            <div class="stat-card w-full max-w-2xl rounded-2xl border border-orange-500/30 glow-orange max-h-[80vh] overflow-hidden flex flex-col">
                <div class="p-6 border-b border-white/10 flex items-center justify-between">
                    <div>
                        <h3 class="text-xl font-bold text-white">Alert Details</h3>
                        <p class="text-sm text-gray-400">ALT-2847 • Critical</p>
                    </div>
                    <button onclick="closeAlertModal()" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="p-6 overflow-y-auto space-y-6">
                    <div class="bg-red-500/10 rounded-lg p-4 border border-red-500/20">
                        <h4 class="text-red-400 font-semibold mb-2">Fraud Rate Spike</h4>
                        <p class="text-gray-300 text-sm mb-2">Fraud rate exceeded 5% threshold</p>
                        <div class="flex gap-2 text-xs">
                            <span class="px-2 py-1 bg-white/5 rounded">fraud-detection</span>
                            <span class="px-2 py-1 bg-white/5 rounded">Acme Corp</span>
                            <span class="px-2 py-1 bg-white/5 rounded">2 minutes ago</span>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="text-white font-semibold mb-3">Recommended Actions</h4>
                        <div class="space-y-2">
                            <button onclick="executeRemediation('enable-enhanced-fraud')" class="w-full text-left p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="text-white font-medium">Enable Enhanced Fraud Detection</div>
                                        <div class="text-xs text-gray-500">Activate additional fraud models</div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-500"></i>
                                </div>
                            </button>
                            <button onclick="executeRemediation('scale-fraud-team')" class="w-full text-left p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="text-white font-medium">Scale Fraud Review Team</div>
                                        <div class="text-xs text-gray-500">Add 5 agents to review queue</div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-500"></i>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="p-4 border-t border-white/10 bg-black/30 flex justify-between">
                    <div class="flex gap-2">
                        <button onclick="acknowledgeAlert()" class="px-3 py-2 bg-green-500/20 text-green-400 rounded hover:bg-green-500/30 transition-colors text-sm">
                            <i class="fas fa-check mr-1"></i> Acknowledge
                        </button>
                        <button onclick="escalateAlert()" class="px-3 py-2 bg-orange-500/20 text-orange-400 rounded hover:bg-orange-500/30 transition-colors text-sm">
                            <i class="fas fa-arrow-up mr-1"></i> Escalate
                        </button>
                        <button onclick="snoozeAlert()" class="px-3 py-2 bg-gray-500/20 text-gray-400 rounded hover:bg-gray-500/30 transition-colors text-sm">
                            <i class="fas fa-clock mr-1"></i> Snooze
                        </button>
                    </div>
                    <button onclick="closeAlertModal()" class="px-3 py-2 bg-white/5 text-white rounded hover:bg-white/10 transition-colors text-sm">
                        Close
                    </button>
                </div>
            </div>
        </div>

        <!-- ML Model Management Modal -->
        <div id="model-modal" class="fixed inset-0 bg-black/90 backdrop-blur-md z-50 hidden flex items-center justify-center p-4">
            <div class="stat-card w-full max-w-3xl rounded-2xl border border-purple-500/30 glow-purple max-h-[80vh] overflow-hidden flex flex-col">
                <div class="p-6 border-b border-white/10 flex items-center justify-between">
                    <div>
                        <h3 class="text-xl font-bold text-white">Risk Scoring NN v3.0.0-NN</h3>
                        <p class="text-sm text-gray-400">Production • PyTorch</p>
                    </div>
                    <button onclick="closeModelModal()" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="p-6 overflow-y-auto space-y-6">
                    <!-- Model Performance -->
                    <div class="grid grid-cols-4 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-green-400">98.7%</div>
                            <div class="text-xs text-gray-500">Accuracy</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-cyan-400">12ms</div>
                            <div class="text-xs text-gray-500">Latency</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-purple-400">2.4M</div>
                            <div class="text-xs text-gray-500">Inferences</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-orange-400">0.02%</div>
                            <div class="text-xs text-gray-500">Error Rate</div>
                        </div>
                    </div>
                    
                    <!-- Model Drift Chart -->
                    <div>
                        <h4 class="text-white font-semibold mb-3">Model Drift Analysis</h4>
                        <canvas id="modelDriftChart" height="150"></canvas>
                    </div>
                    
                    <!-- Model Actions -->
                    <div>
                        <h4 class="text-white font-semibold mb-3">Model Actions</h4>
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="rollbackModel()" class="p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors text-left">
                                <div class="flex items-center gap-2">
                                    <i class="fas fa-undo text-orange-400"></i>
                                    <div>
                                        <div class="text-white font-medium">Rollback</div>
                                        <div class="text-xs text-gray-500">Revert to v2.2.0</div>
                                    </div>
                                </div>
                            </button>
                            <button onclick="promoteModel()" class="p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors text-left">
                                <div class="flex items-center gap-2">
                                    <i class="fas fa-rocket text-cyan-400"></i>
                                    <div>
                                        <div class="text-white font-medium">Promote</div>
                                        <div class="text-xs text-gray-500">Move to production</div>
                                    </div>
                                </div>
                            </button>
                            <button onclick="retrainModel()" class="p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors text-left">
                                <div class="flex items-center gap-2">
                                    <i class="fas fa-brain text-purple-400"></i>
                                    <div>
                                        <div class="text-white font-medium">Retrain</div>
                                        <div class="text-xs text-gray-500">Start training job</div>
                                    </div>
                                </div>
                            </button>
                            <button onclick="cloneModel()" class="p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors text-left">
                                <div class="flex items-center gap-2">
                                    <i class="fas fa-copy text-green-400"></i>
                                    <div>
                                        <div class="text-white font-medium">Clone</div>
                                        <div class="text-xs text-gray-500">Create new version</div>
                                    </div>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="p-4 border-t border-white/10 bg-black/30 flex justify-end">
                    <button onclick="closeModelModal()" class="px-4 py-2 bg-white/5 text-white rounded hover:bg-white/10 transition-colors">
                        Close
                    </button>
                </div>
            </div>
        </div>

        <!-- Blockchain Audit Dashboard -->
        <div id="blockchain-dashboard" class="dashboard-view hidden">
            <!-- Blockchain Overview -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-cube text-cyan-400 text-xl"></i>
                        <span class="text-xs text-cyan-400">Latest</span>
                    </div>
                    <div class="text-2xl font-bold text-white">10</div>
                    <div class="text-sm text-gray-400">Total Blocks</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-exchange-alt text-purple-400 text-xl"></i>
                        <span class="text-xs text-purple-400">+127</span>
                    </div>
                    <div class="text-2xl font-bold text-white">2,847</div>
                    <div class="text-sm text-gray-400">Transactions</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-tachometer-alt text-green-400 text-xl"></i>
                        <span class="text-xs text-green-400">15s</span>
                    </div>
                    <div class="text-2xl font-bold text-white">15s</div>
                    <div class="text-sm text-gray-400">Block Time</div>
                </div>
                <div class="metric-card">
                    <div class="flex items-center justify-between mb-2">
                        <i class="fas fa-shield-alt text-orange-400 text-xl"></i>
                        <span class="text-xs text-orange-400">24 Nodes</span>
                    </div>
                    <div class="text-2xl font-bold text-white">100%</div>
                    <div class="text-sm text-gray-400">Consensus</div>
                </div>
            </div>

            <!-- Blockchain Visualization -->
            <div class="stat-card rounded-xl p-6 mb-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-white flex items-center gap-2">
                        <i class="fas fa-cube text-cyan-400"></i>
                        Blockchain Ledger
                    </h3>
                    <div class="flex gap-2">
                        <button onclick="BlockchainManager.addBlock()" class="px-3 py-1.5 bg-green-500/20 text-green-400 rounded hover:bg-green-500/30 transition-colors text-sm">
                            <i class="fas fa-plus"></i> Mine Block
                        </button>
                        <button onclick="BlockchainManager.verifyChain()" class="px-3 py-1.5 bg-cyan-500/20 text-cyan-400 rounded hover:bg-cyan-500/30 transition-colors text-sm">
                            <i class="fas fa-check"></i> Verify
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto pb-4">
                    <div class="flex gap-4 min-w-max" id="blockchain-viz">
                        <!-- Generated by JS -->
                    </div>
                </div>
            </div>

            <!-- Transaction Pool & Network Status -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Transaction Pool -->
                <div class="stat-card rounded-xl p-6">
                    <h4 class="text-white font-semibold mb-4 flex items-center gap-2">
                        <i class="fas fa-exchange-alt text-purple-400"></i>
                        Transaction Pool
                    </h4>
                    <div class="space-y-2 max-h-64 overflow-y-auto" id="tx-pool">
                        <!-- Generated by JS -->
                    </div>
                </div>

                <!-- Network Status -->
                <div class="stat-card rounded-xl p-6">
                    <h4 class="text-white font-semibold mb-4 flex items-center gap-2">
                        <i class="fas fa-network-wired text-green-400"></i>
                        Network Status
                    </h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <span class="text-gray-400">Active Nodes</span>
                            <span class="text-green-400">24/24</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-gray-400">Hash Rate</span>
                            <span class="text-cyan-400">1.2 TH/s</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-gray-400">Difficulty</span>
                            <span class="text-orange-400">4.2B</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-gray-400">Gas Price</span>
                            <span class="text-purple-400">42 Gwei</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <script>
        // State Management
        const state = {
            currentDecision: null,
            riskScore: 23,
            patterns: [],
            lookups: [],
            workflowSteps: [
                { id: 'input', name: 'Data Input Validation', status: 'completed', time: '0.1s' },
                { id: 'identity', name: 'Identity Verification', status: 'completed', time: '0.3s' },
                { id: 'credit', name: 'Credit Bureau Lookup', status: 'completed', time: '0.2s' },
                { id: 'fraud', name: 'Fraud Pattern Check', status: 'completed', time: '0.4s' },
                { id: 'income', name: 'Income Verification', status: 'completed', time: '0.3s' },
                { id: 'decision', name: 'Final Decision', status: 'completed', time: '0.1s' }
            ],
            recentDecisions: [
                { time: '14:32:01', applicant: 'Sarah J.', score: 15, patterns: 0, decision: 'Approved', reason: 'Low risk profile' },
                { time: '14:31:45', applicant: 'Mike R.', score: 45, patterns: 2, decision: 'Manual Review', reason: 'High velocity' },
                { time: '14:31:22', applicant: 'Corp Inc.', score: 78, patterns: 4, decision: 'Rejected', reason: 'Fraud patterns detected' },
                { time: '14:30:58', applicant: 'Lisa M.', score: 22, patterns: 0, decision: 'Approved', reason: 'Excellent credit' }
            ]
        };

        // Pattern Matching Database
        const patterns = [
            { id: 'P001', name: 'First Party Fraud', type: 'fraud', check: 'identity_mismatch', weight: 25 },
            { id: 'P002', name: 'Synthetic Identity', type: 'fraud', check: 'ssn_validation', weight: 30 },
            { id: 'P003', name: 'Velocity Abuse', type: 'risk', check: 'application_count', weight: 15 },
            { id: 'P004', name: 'Income Inflation', type: 'risk', check: 'employer_verification', weight: 10 },
            { id: 'P005', name: 'Address Discrepancy', type: 'risk', check: 'address_history', weight: 12 },
            { id: 'P006', name: 'Device Fingerprint', type: 'security', check: 'device_reputation', weight: 8 }
        ];

        // Lookup Sources
        const lookupSources = [
            { name: 'Experian Credit Bureau', type: 'credit', status: 'pass', confidence: 99.9, action: 'Score: 720' },
            { name: 'LexisNexis Fraud Shield', type: 'fraud', status: 'pass', confidence: 98.5, action: 'No matches' },
            { name: 'OFAC Sanctions List', type: 'compliance', status: 'pass', confidence: 100, action: 'Cleared' },
            { name: 'Telecheck Verification', type: 'banking', status: 'pass', confidence: 97.2, action: 'Positive' },
            { name: 'The Work Number (Employment)', type: 'employment', status: 'pass', confidence: 95.8, action: 'Verified' },
            { name: 'ChexSystems', type: 'banking', status: 'pass', confidence: 99.1, action: 'No records' },
            { name: 'Early Warning Services', type: 'fraud', status: 'pass', confidence: 98.9, action: 'Clean' },
            { name: 'SBA Fraud Alert', type: 'fraud', status: 'pass', confidence: 100, action: 'No alerts' }
        ];

        // Initialize Pattern Grid
        function renderPatterns() {
            const container = document.getElementById('pattern-grid');
            container.innerHTML = patterns.map(p => {
                const isMatch = Math.random() > 0.7; // Simulate pattern detection
                const statusClass = isMatch ? 'pattern-fail' : 'pattern-match';
                const icon = isMatch ? 'fa-exclamation-triangle' : 'fa-check-circle';
                const color = isMatch ? 'text-orange-400' : 'text-green-400';
                const status = isMatch ? 'Pattern Detected' : 'Clean';
                
                return `
                    <div class="pattern-card ${statusClass} flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-black/30 flex items-center justify-center">
                                <i class="fas ${icon} ${color}"></i>
                            </div>
                            <div>
                                <div class="text-sm text-white font-medium">${p.name}</div>
                                <div class="text-xs text-gray-500">${p.check}</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-xs ${color} font-bold">${status}</div>
                            <div class="text-xs text-gray-500">Weight: ${p.weight}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Initialize Lookup Table
        function renderLookups() {
            const container = document.getElementById('lookup-rows');
            container.innerHTML = lookupSources.map(l => {
                const statusClass = l.status === 'pass' ? 'lookup-pass' : l.status === 'fail' ? 'lookup-fail' : 'lookup-pending';
                const icon = l.status === 'pass' ? 'fa-check' : l.status === 'fail' ? 'fa-times' : 'fa-clock';
                
                return `
                    <div class="lookup-row text-sm" data-status="${l.status}">
                        <div class="flex items-center gap-2">
                            <i class="fas ${icon} ${statusClass}"></i>
                            <span class="text-gray-300">${l.name}</span>
                        </div>
                        <div class="${statusClass} font-medium uppercase text-xs">${l.status}</div>
                        <div class="text-cyan-400 mono">${l.confidence}%</div>
                        <div class="text-gray-400">${l.action}</div>
                    </div>
                `;
            }).join('');
        }

        // Initialize Workflow Steps
        function renderWorkflow() {
            const container = document.getElementById('workflow-steps');
            container.innerHTML = state.workflowSteps.map((step, _idx) => {
                const statusClass = step.status === 'completed' ? 'completed' : step.status === 'active' ? 'active' : step.status === 'failed' ? 'failed' : '';
                const icon = step.status === 'completed' ? 'fa-check' : step.status === 'active' ? 'fa-spinner fa-spin' : step.status === 'failed' ? 'fa-times' : 'fa-circle';
                const color = step.status === 'completed' ? 'text-green-400' : step.status === 'active' ? 'text-cyan-400' : step.status === 'failed' ? 'text-red-400' : 'text-gray-600';
                
                return `
                    <div class="workflow-step ${statusClass}">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <i class="fas ${icon} ${color} w-4"></i>
                                <span class="text-sm ${step.status === 'active' ? 'text-cyan-400' : 'text-gray-300'}">${step.name}</span>
                            </div>
                            <span class="text-xs text-gray-500 mono">${step.time}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Initialize Fraud Heatmap
        function renderFraudHeatmap() {
            const container = document.getElementById('fraud-heatmap');
            container.innerHTML = '';
            
            for (let i = 0; i < 64; i++) {
                const cell = document.createElement('div');
                cell.className = 'heatmap-cell';
                
                const rand = Math.random();
                let color, value;
                if (rand > 0.85) {
                    color = 'bg-red-500';
                    value = 'H';
                } else if (rand > 0.7) {
                    color = 'bg-orange-500';
                    value = 'M';
                } else if (rand > 0.5) {
                    color = 'bg-yellow-500';
                    value = 'L';
                } else {
                    color = 'bg-green-500/30';
                    value = '';
                }
                
                cell.className = `heatmap-cell ${color} text-white`;
                cell.textContent = value;
                cell.title = `Indicator ${i + 1}: ${value || 'Clean'}`;
                container.appendChild(cell);
            }
        }

        // Initialize Decisions Table
        function renderDecisionsTable() {
            const container = document.getElementById('decisions-table');
            container.innerHTML = state.recentDecisions.map(d => {
                const decisionClass = d.decision === 'Approved' ? 'text-green-400' : d.decision === 'Rejected' ? 'text-red-400' : 'text-orange-400';
                const scoreClass = d.score < 30 ? 'text-green-400' : d.score < 70 ? 'text-orange-400' : 'text-red-400';
                
                return `
                    <tr class="border-b border-gray-800 hover:bg-white/5 transition-colors">
                        <td class="py-3 text-gray-500">${d.time}</td>
                        <td class="py-3 text-cyan-400">${d.applicant}</td>
                        <td class="py-3 ${scoreClass} font-bold">${d.score}</td>
                        <td class="py-3 text-gray-400">${d.patterns}</td>
                        <td class="py-3 ${decisionClass} font-bold">${d.decision}</td>
                        <td class="py-3 text-gray-500">${d.reason}</td>
                    </tr>
                `;
            }).join('');
        }

        // Process Application
        function processApplication() {
            const btn = document.querySelector('button[onclick="processApplication()"]');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            btn.disabled = true;
            
            // Simulate processing delay
            setTimeout(() => {
                // Calculate risk score based on inputs
                const credit = parseInt(document.getElementById('app-credit').value, 10) || 600;
                const _income = document.getElementById('app-income').value;
                const employment = document.getElementById('app-employment').value;
                
                let riskScore = Math.floor(Math.random() * 40) + 10;
                if (credit < 650) riskScore += 30;
                if (employment === 'unemployed') riskScore += 25;
                if (employment === 'self-employed') riskScore += 15;
                
                // Update risk gauge
                updateRiskGauge(riskScore);
                
                // Determine decision
                let decision, decisionClass, icon;
                if (riskScore < 30) {
                    decision = 'APPROVED';
                    decisionClass = 'decision-approved';
                    icon = 'fa-check-circle';
                } else if (riskScore < 70) {
                    decision = 'MANUAL REVIEW';
                    decisionClass = 'decision-review';
                    icon = 'fa-exclamation-circle';
                } else {
                    decision = 'REJECTED';
                    decisionClass = 'decision-rejected';
                    icon = 'fa-times-circle';
                }
                
                // Update decision badge
                const badge = document.getElementById('decision-badge');
                badge.className = `decision-badge ${decisionClass}`;
                badge.innerHTML = `<i class="fas ${icon}"></i><span>${decision}</span>`;
                
                // Re-render patterns with new randomization
                renderPatterns();
                
                // Add to recent decisions
                state.recentDecisions.unshift({
                    time: new Date().toLocaleTimeString(),
                    applicant: document.getElementById('app-name').value,
                    score: riskScore,
                    patterns: Math.floor(Math.random() * 3),
                    decision: decision.replace('MANUAL REVIEW', 'Review').replace('APPROVED', 'Approved').replace('REJECTED', 'Rejected'),
                    reason: riskScore < 30 ? 'Low risk profile' : riskScore < 70 ? 'Additional verification needed' : 'Risk threshold exceeded'
                });
                if (state.recentDecisions.length > 10) state.recentDecisions.pop();
                renderDecisionsTable();
                
                // Reset button
                btn.innerHTML = '<i class="fas fa-cogs"></i> Process Application';
                btn.disabled = false;
            }, 1500);
        }

        // Update Risk Gauge
        function updateRiskGauge(score) {
            const needle = document.getElementById('risk-needle');
            const scoreEl = document.getElementById('risk-score');
            
            // Map score 0-100 to angle -90 to 90
            const angle = -90 + (score / 100) * 180;
            needle.style.transform = `rotate(${angle}deg)`;
            scoreEl.textContent = score;
            
            // Color based on score
            if (score < 30) scoreEl.className = 'text-2xl font-bold text-green-400 mono';
            else if (score < 70) scoreEl.className = 'text-2xl font-bold text-orange-400 mono';
            else scoreEl.className = 'text-2xl font-bold text-red-400 mono';
        }

        // Filter Lookups
        function _filterLookups(type) {
            const rows = document.querySelectorAll('#lookup-rows > div');
            rows.forEach(row => {
                if (type === 'all' || row.dataset.status === type) {
                    row.style.display = 'grid';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Simulate New Application
        function simulateNewApplication() {
            const names = ['Alice Johnson', 'Bob Williams', 'Carol Davis', 'David Brown', 'Emma Wilson'];
            const randomName = names[Math.floor(Math.random() * names.length)];
            const randomCredit = Math.floor(Math.random() * 300) + 550;
            
            document.getElementById('app-name').value = randomName;
            document.getElementById('app-credit').value = randomCredit;
            
            // Trigger processing
            processApplication();
        }

        // Dashboard Switching Function
        function _switchDashboard(dashboardName) {
            // Hide all dashboards
            document.querySelectorAll('.dashboard-view').forEach(dashboard => {
                dashboard.classList.add('hidden');
            });
            
            // Show selected dashboard
            document.getElementById(`${dashboardName}-dashboard`).classList.remove('hidden');
            
            // Update button states
            document.querySelectorAll('.dashboard-btn').forEach(btn => {
                btn.classList.remove('bg-cyan-500/20', 'text-cyan-400');
                btn.classList.add('text-gray-400', 'hover:text-white', 'hover:bg-white/10');
            });
            
            // Activate selected button
            event.target.classList.remove('text-gray-400', 'hover:text-white', 'hover:bg-white/10');
            event.target.classList.add('bg-cyan-500/20', 'text-cyan-400');
            
            // Initialize dashboard-specific charts
            if (dashboardName === 'payments') {
                initializePaymentChart();
            } else if (dashboardName === 'compliance') {
                initializeComplianceChart();
            }
        }

        // Initialize Payment Chart
        function initializePaymentChart() {
            const paymentCtx = document.getElementById('paymentChart');
            if (paymentCtx && !paymentCtx.chart) {
                paymentCtx.chart = new Chart(paymentCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                        datasets: [{
                            label: 'Payment Volume',
                            data: [1.2, 1.8, 2.1, 2.4, 2.2, 1.9, 1.5],
                            borderColor: '#00f3ff',
                            backgroundColor: 'rgba(0, 243, 255, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: '#e0e0e0' }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: { color: '#9ca3af' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' }
                            },
                            x: {
                                ticks: { color: '#9ca3af' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' }
                            }
                        }
                    }
                });
            }
        }

        // Initialize Compliance Chart
        function initializeComplianceChart() {
            const complianceCtx = document.getElementById('complianceChart');
            if (complianceCtx && !complianceCtx.chart) {
                complianceCtx.chart = new Chart(complianceCtx.getContext('2d'), {
                    type: 'radar',
                    data: {
                        labels: ['AML', 'KYC', 'Privacy', 'Reporting', 'Security', 'Audit'],
                        datasets: [{
                            label: 'Current Score',
                            data: [95, 98, 92, 88, 96, 94],
                            borderColor: '#00f3ff',
                            backgroundColor: 'rgba(0, 243, 255, 0.2)',
                            pointBackgroundColor: '#00f3ff'
                        }, {
                            label: 'Required',
                            data: [90, 95, 90, 85, 95, 90],
                            borderColor: '#b829dd',
                            backgroundColor: 'rgba(184, 41, 221, 0.1)',
                            pointBackgroundColor: '#b829dd'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: '#e0e0e0' }
                            }
                        },
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                ticks: { color: '#9ca3af' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                pointLabels: { color: '#e0e0e0' }
                            }
                        }
                    }
                });
            }
        }

        // DuoPlus Cloud Integration Module
const DuoPlusAPI = {
    baseURL: 'https://api.duoplus.net/v1',
    apiKey: 'YOUR_DUOPLUS_API_KEY', // Store in env
    
    async getAvailableDevices(_filters = {}) {
        // Simulate API call - replace with actual fetch
        return [
            {
                id: 'dp-us-001',
                model: 'iPhone 14 Pro',
                os: 'iOS 17.1',
                location: 'New York, NY',
                carrier: 'Verizon',
                status: 'available',
                fingerprint: { deviceId: 'A1B2C3', sdk: '23.5' }
            },
            {
                id: 'dp-us-002', 
                model: 'Samsung S23 Ultra',
                os: 'Android 14',
                location: 'Miami, FL',
                carrier: 'AT&T',
                status: 'available',
                fingerprint: { deviceId: 'D4E5F6', sdk: '34.2' }
            },
            {
                id: 'dp-us-003',
                model: 'Google Pixel 8',
                os: 'Android 14', 
                location: 'Los Angeles, CA',
                carrier: 'T-Mobile',
                status: 'in_use',
                fingerprint: { deviceId: 'G7H8I9', sdk: '34.1' }
            }
        ];
    },

    async rentDevice(deviceId, profile) {
        // Allocate device for specific KYC profile
        console.log(`Renting ${deviceId} for ${profile.email}`);
        return {
            success: true,
            sessionId: `sess-${Date.now()}`,
            websocketUrl: `wss://stream.duoplus.net/${deviceId}`,
            expiresIn: 3600 // 1 hour
        };
    },

    async executeADB(_deviceId, _command) {
        // Execute Android Debug Bridge command
        return new Promise((resolve) => {
            setTimeout(() => resolve({ stdout: 'Success', stderr: '' }), 1000);
        });
    },

    async getSMS(_deviceId, _phoneNumber) {
        // Intercept SMS/OTP for verification
        return new Promise((resolve) => {
            setTimeout(() => {
                resolve({
                    messages: [
                        { from: 'Stripe', code: '123456', time: Date.now() },
                        { from: 'PayPal', code: '789012', time: Date.now() - 60000 }
                    ]
                });
            }, 2000);
        });
    },

    async installApp(_deviceId, appPackage) {
        // Push APK/IPA to device
        return { success: true, installed: appPackage };
    },

    async takeScreenshot(_deviceId) {
        // Capture screen for verification proof
        return `data:image/png;base64,${btoa('screenshot-data')}`;
    }
};

// State extension
state.duoplus = {
    selectedDevice: null,
    sessionId: null,
    websocket: null,
    messages: [],
    installedApps: []
};

// Device Selection UI
async function renderDuoPlusDevices() {
    const container = document.getElementById('duoplus-devices');
    const devices = await DuoPlusAPI.getAvailableDevices();
    
    container.innerHTML = devices.map(dev => `
        <div class="stat-card rounded-xl p-4 border ${dev.status === 'available' ? 'border-gray-700 hover:border-cyan-400 cursor-pointer' : 'border-gray-800 opacity-50'} transition-all device-card" 
             onclick="${dev.status === 'available' ? `selectDevice('${dev.id}')` : ''}" 
             data-device-id="${dev.id}">
            
            <div class="flex items-start justify-between mb-3">
                <div class="platform-icon ${dev.os.includes('iOS') ? 'bg-gray-700' : 'bg-green-600'} w-10 h-10">
                    <i class="fab ${dev.os.includes('iOS') ? 'fa-apple' : 'fa-android'} text-white"></i>
                </div>
                ${dev.status === 'available' 
                    ? '<span class="px-2 py-1 rounded bg-green-500/10 text-green-400 text-xs border border-green-500/20">Available</span>'
                    : '<span class="px-2 py-1 rounded bg-gray-700 text-gray-400 text-xs">In Use</span>'
                }
            </div>
            
            <h5 class="text-white font-semibold mb-1">${dev.model}</h5>
            <p class="text-xs text-gray-400 mb-2">${dev.os}</p>
            
            <div class="space-y-2 text-xs">
                <div class="flex items-center gap-2 text-gray-300">
                    <i class="fas fa-map-marker-alt text-cyan-400"></i>
                    ${dev.location}
                </div>
                <div class="flex items-center gap-2 text-gray-300">
                    <i class="fas fa-signal text-green-400"></i>
                    ${dev.carrier} 5G
                </div>
            </div>
            
            ${dev.status === 'available' ? `
                <div class="mt-3 pt-3 border-t border-gray-700">
                    <button class="w-full py-2 bg-cyan-500/20 text-cyan-400 rounded hover:bg-cyan-500/30 transition-colors text-sm font-medium select-device-btn">
                        Select Device
                    </button>
                </div>
            ` : ''}
        </div>
    `).join('');
}

function _selectDevice(deviceId) {
    // Visual selection
    document.querySelectorAll('.device-card').forEach(card => {
        card.classList.remove('border-cyan-400', 'bg-cyan-500/5');
        if(card.dataset.deviceId === deviceId) {
            card.classList.add('border-cyan-400', 'bg-cyan-500/5');
        }
    });
    
    // Store selection
    state.duoplus.selectedDevice = deviceId;
    addLog(`[DuoPlus] Selected device ${deviceId} for hardware-backed provisioning`);
    
    // Show console preview
    document.getElementById('active-device-console').classList.remove('hidden');
    document.getElementById('device-logs').innerHTML += `
        <div class="text-cyan-400">[DuoPlus] Connecting to ${deviceId}...</div>
    `;
}

async function _provisionWithDevice() {
    if(!state.duoplus.selectedDevice) {
        showToast('Please select a DuoPlus device first', 'error');
        return;
    }
    
    const profile = {
        name: document.getElementById('app-name')?.value || 'Demo User',
        email: document.getElementById('input-email')?.value || 'demo@example.com',
        phone: document.getElementById('input-phone')?.value || '+1234567890'
    };
    
    // 1. Rent the device
    showToast('Allocating cloud device...', 'info');
    const rental = await DuoPlusAPI.rentDevice(state.duoplus.selectedDevice, profile);
    state.duoplus.sessionId = rental.sessionId;
    
    // 2. Start WebSocket for real-time device control
    connectDeviceWebSocket(rental.websocketUrl);
    
    // 3. Automated Setup Sequence
    await executeDeviceSetupSequence(profile);
    
    // 4. Complete provisioning
    showToast('Device ready for platform automation', 'success');
}

async function executeDeviceSetupSequence(_profile) {
    const logs = document.getElementById('device-logs');
    const deviceId = state.duoplus.selectedDevice;
    
    const steps = [
        { msg: 'Factory reset simulation...', action: () => DuoPlusAPI.executeADB(deviceId, 'pm clear com.android.settings') },
        { msg: 'Setting device locale to US...', action: () => DuoPlusAPI.executeADB(deviceId, 'setprop persist.sys.locale en-US') },
        { msg: 'Generating device fingerprint...', action: () => Promise.resolve() },
        { msg: 'Installing payment apps...', action: () => installPaymentApps(deviceId) },
        { msg: 'Preparing SMS interceptor...', action: () => setupSMSInterceptor(deviceId) }
    ];
    
    for(const step of steps) {
        logs.innerHTML += `<div class="text-gray-400">[Device] ${step.msg}</div>`;
        await step.action();
        await new Promise(r => setTimeout(r, 800));
    }
    
    logs.innerHTML += `<div class="text-green-400">[Device] Ready for platform automation</div>`;
}

async function installPaymentApps(deviceId) {
    const apps = ['com.stripe.android', 'com.paypal.android', 'com.venmo'];
    for(const app of apps) {
        await DuoPlusAPI.installApp(deviceId, app);
        state.duoplus.installedApps.push(app);
        addLog(`[DuoPlus] Installed ${app}`);
    }
}

function setupSMSInterceptor(deviceId) {
    // Monitor incoming SMS for OTPs
    setInterval(async () => {
        const sms = await DuoPlusAPI.getSMS(deviceId, '+1234567890');
        if(sms.messages.length > state.duoplus.messages.length) {
            const newMsg = sms.messages[sms.messages.length - 1];
            handleIncomingOTP(newMsg);
        }
        state.duoplus.messages = sms.messages;
    }, 3000);
}

function handleIncomingOTP(message) {
    showToast(`OTP Received from ${message.from}: ${message.code}`, 'success');
    addLog(`[SMS] Intercepted OTP from ${message.from}: ${message.code}`);
    
    // Auto-fill in current step if applicable
    const otpInputs = document.querySelectorAll('input[placeholder*="code" i], input[type="number"]');
    if(otpInputs.length > 0) {
        otpInputs[0].value = message.code;
        otpInputs[0].dispatchEvent(new Event('input'));
    }
}

function connectDeviceWebSocket(_url) {
    // Real-time screen mirroring/control would connect here
    state.duoplus.websocket = {
        send: (cmd) => console.log('WS:', cmd),
        close: () => console.log('WS closed')
    };
}

function _refreshDevice() {
    const logs = document.getElementById('device-logs');
    logs.innerHTML += `<div class="text-cyan-400">[Device] Refreshing device state...</div>`;
    setTimeout(() => {
        logs.innerHTML += `<div class="text-green-400">[Device] Device refreshed successfully</div>`;
    }, 1000);
}

async function _releaseDevice() {
    if(!state.duoplus.selectedDevice) return;
    
    if(confirm('Release this device? All data will be wiped.')) {
        showToast('Wiping device and releasing...', 'info');
        
        // Wipe commands
        await DuoPlusAPI.executeADB(state.duoplus.selectedDevice, 'pm clear com.stripe.android');
        await DuoPlusAPI.executeADB(state.duoplus.selectedDevice, 'pm clear com.paypal.android');
        
        state.duoplus = { selectedDevice: null, sessionId: null, websocket: null, messages: [], installedApps: [] };
        document.getElementById('active-device-console').classList.add('hidden');
        
        // Reset selection UI
        document.querySelectorAll('.device-card').forEach(card => {
            card.classList.remove('border-cyan-400', 'bg-cyan-500/5');
        });
        
        showToast('Device released and sanitized', 'success');
        addLog('[DuoPlus] Device session ended, storage wiped');
    }
}

function showToast(message, type = 'info') {
    // Simple toast implementation
    console.log(`[${type.toUpperCase()}] ${message}`);
}

// Initialize DuoPlus devices on load
document.addEventListener('DOMContentLoaded', () => {
    renderDuoPlusDevices();
});

// Enhanced Platform Monitoring System
const platformMonitor = {
    platforms: {
        stripe: {
            name: 'Stripe',
            icon: 'fa-cc-stripe',
            color: 'platform-stripe',
            status: 'active',
            latency: 42,
            uptime: 99.9,
            rateLimit: { used: 450, total: 1000, resetIn: 3600 },
            lastError: null,
            duoLinked: true,
            deviceId: 'dp-us-002',
            features: ['Auto-onboard', 'Webhook', 'Multi-account'],
            healthHistory: Array(24).fill(100).map(() => Math.random() > 0.9 ? 0 : 100) // Last 24h
        },
        paypal: {
            name: 'PayPal',
            icon: 'fa-paypal',
            color: 'platform-paypal',
            status: 'warning',
            latency: 120,
            uptime: 98.5,
            rateLimit: { used: 890, total: 1000, resetIn: 1800 },
            lastError: 'Rate limit 89% - approaching threshold',
            duoLinked: true,
            deviceId: 'dp-us-002',
            features: ['Auto-onboard', 'IPN'],
            healthHistory: Array(24).fill(100).map(() => Math.random() > 0.95 ? 0 : 100)
        },
        venmo: {
            name: 'Venmo',
            icon: 'fa-vimeo-v',
            color: 'platform-venmo',
            status: 'active',
            latency: 35,
            uptime: 99.9,
            rateLimit: { used: 120, total: 500, resetIn: 7200 },
            lastError: null,
            duoLinked: false,
            deviceId: null,
            features: ['Auto-onboard'],
            healthHistory: Array(24).fill(100)
        },
        cashapp: {
            name: 'Cash App',
            icon: 'fa-dollar-sign',
            color: 'platform-cashapp',
            status: 'error',
            latency: null,
            uptime: 45.2,
            rateLimit: { used: 0, total: 100, resetIn: 0 },
            lastError: 'Auth token expired - re-authentication required',
            duoLinked: false,
            deviceId: null,
            features: [],
            healthHistory: Array(24).fill(0).map((_, i) => i > 18 ? 0 : 100) // Failed 6h ago
        },
        zelle: {
            name: 'Zelle',
            icon: 'fa-bolt',
            color: 'platform-zelle',
            status: 'active',
            latency: 28,
            uptime: 99.9,
            rateLimit: { used: 45, total: 200, resetIn: 5400 },
            lastError: null,
            duoLinked: true,
            deviceId: 'dp-us-001',
            features: ['Auto-onboard', 'Phone verify'],
            healthHistory: Array(24).fill(100)
        },
        apple: {
            name: 'Apple Pay',
            icon: 'fa-apple',
            color: 'platform-apple',
            status: 'maintenance',
            latency: null,
            uptime: 0,
            rateLimit: { used: 0, total: 0, resetIn: 0 },
            lastError: 'Scheduled maintenance until 15:00 UTC',
            duoLinked: false,
            deviceId: null,
            features: [],
            healthHistory: Array(24).fill(0)
        },
        google: {
            name: 'Google Pay',
            icon: 'fa-google',
            color: 'platform-google',
            status: 'active',
            latency: 55,
            uptime: 99.1,
            rateLimit: { used: 230, total: 500, resetIn: 3600 },
            lastError: null,
            duoLinked: false,
            deviceId: null,
            features: ['Auto-onboard'],
            healthHistory: Array(24).fill(100)
        },
        square: {
            name: 'Square',
            icon: 'fa-square',
            color: 'platform-square',
            status: 'error',
            latency: 340,
            uptime: 78.3,
            rateLimit: { used: 95, total: 100, resetIn: 300 },
            lastError: '429 Too Many Requests - IP temporarily blocked',
            duoLinked: false,
            deviceId: null,
            features: [],
            healthHistory: Array(24).fill(100).map(() => Math.random() > 0.7 ? 0 : 100)
        }
    },

    activeSessions: [
        { id: 'sess-001', platform: 'stripe', device: 'dp-us-002', startTime: Date.now() - 120000, status: 'creating_account' },
        { id: 'sess-002', platform: 'paypal', device: 'dp-us-003', startTime: Date.now() - 300000, status: 'verifying_email' },
        { id: 'sess-003', platform: 'zelle', device: 'dp-us-001', startTime: Date.now() - 60000, status: 'sms_verification' }
    ],

    remediationQueue: [
        { id: 'rem-001', platform: 'cashapp', issue: 'Auth token expired', severity: 'high', autoFixable: true },
        { id: 'rem-002', platform: 'square', issue: 'Rate limit exceeded', severity: 'medium', autoFixable: true }
    ]
};

function renderEnhancedPlatformGrid() {
    const container = document.getElementById('enhanced-platform-grid');
    if (!container) return;
    
    container.innerHTML = Object.entries(platformMonitor.platforms).map(([key, platform]) => {
        const statusColors = {
            active: 'border-green-500/30 bg-green-500/5',
            warning: 'border-orange-500/30 bg-orange-500/5',
            error: 'border-red-500/30 bg-red-500/5',
            maintenance: 'border-gray-500/30 bg-gray-500/5'
        };
        
        const statusDot = {
            active: 'bg-green-400 shadow-[0_0_8px_rgba(10,255,104,0.8)]',
            warning: 'bg-orange-400 shadow-[0_0_8px_rgba(255,157,0,0.8)]',
            error: 'bg-red-500 shadow-[0_0_8px_rgba(255,68,68,0.8)]',
            maintenance: 'bg-gray-500'
        };
        
        const isDuoActive = platform.duoLinked ? '<i class="fas fa-mobile-alt text-cyan-400 text-xs ml-2" title="DuoPlus Active"></i>' : '';
        
        return `
            <div class="relative group cursor-pointer" onclick="openPlatformDetail('${key}')">
                <div class="stat-card rounded-xl p-4 border ${statusColors[platform.status]} hover:border-cyan-400 transition-all h-full">
                    <div class="flex items-start justify-between mb-3">
                        <div class="platform-icon ${platform.color} w-10 h-10">
                            <i class="fab ${platform.icon} text-white"></i>
                        </div>
                        <div class="flex items-center gap-2">
                            ${platform.duoLinked ? '<span class="text-[10px] px-1.5 py-0.5 rounded bg-cyan-500/20 text-cyan-400 border border-cyan-500/30">Duo</span>' : ''}
                            <div class="w-2 h-2 rounded-full ${statusDot[platform.status]}"></div>
                        </div>
                    </div>
                    
                    <h4 class="text-white font-semibold mb-1 flex items-center">
                        ${platform.name}
                        ${isDuoActive}
                    </h4>
                    
                    <div class="space-y-2 text-xs">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-500">Latency</span>
                            <span class="${platform.latency > 100 ? 'text-orange-400' : 'text-cyan-400'} font-mono">
                                ${platform.latency ? `${platform.latency}ms` : '--'}
                            </span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-500">Rate Limit</span>
                            <div class="w-16 h-1.5 bg-gray-800 rounded-full overflow-hidden">
                                <div class="h-full ${platform.rateLimit.used/platform.rateLimit.total > 0.8 ? 'bg-red-400' : 'bg-green-400'}" 
                                     style="width: ${(platform.rateLimit.used/platform.rateLimit.total)*100}%"></div>
                            </div>
                        </div>
                        ${platform.lastError ? `
                            <div class="text-red-400 text-[10px] mt-2 line-clamp-1" title="${platform.lastError}">
                                <i class="fas fa-exclamation-circle mr-1"></i>${platform.lastError}
                            </div>
                        ` : ''}
                    </div>
                    
                    <!-- Mini Sparkline -->
                    <div class="mt-3 flex items-end gap-0.5 h-8 opacity-50 group-hover:opacity-100 transition-opacity">
                        ${platform.healthHistory.map(h => `
                            <div class="flex-1 ${h === 100 ? 'bg-green-400' : 'bg-red-400'} rounded-sm" style="height: ${h}%"></div>
                        `).join('')}
                    </div>
                </div>
            </div>
        `;
    }).join('');
}

function renderDeviceMatrix() {
    const matrix = document.getElementById('device-allocation-matrix');
    if (!matrix) return;
    
    const devices = ['dp-us-001', 'dp-us-002', 'dp-us-003', 'dp-us-004', 'dp-us-005', 'dp-eu-001', 'dp-eu-002', 'dp-asia-001'];
    
    matrix.innerHTML = devices.map(devId => {
        const isActive = platformMonitor.activeSessions.some(s => s.device === devId);
        const session = platformMonitor.activeSessions.find(s => s.device === devId);
        
        return `
            <div class="bg-black/30 rounded-lg p-2 border ${isActive ? 'border-cyan-500/30 bg-cyan-500/10' : 'border-gray-800'} relative group cursor-pointer"
                 onclick="${isActive ? `showSessionDetails('${devId}')` : ''}">
                <div class="flex items-center justify-between mb-1">
                    <span class="text-[10px] text-gray-500 font-mono">${devId.split('-')[1].toUpperCase()}</span>
                    ${isActive ? '<div class="w-2 h-2 rounded-full bg-cyan-400 animate-pulse"></div>' : '<div class="w-2 h-2 rounded-full bg-gray-700"></div>'}
                </div>
                <div class="text-xs ${isActive ? 'text-cyan-400' : 'text-gray-600'}">
                    ${isActive ? session.platform : 'Idle'}
                </div>
                ${isActive ? `
                    <div class="absolute -top-2 -right-2 w-5 h-5 rounded-full bg-cyan-500 flex items-center justify-center text-[8px] text-white border-2 border-gray-900">
                        ${Math.floor((Date.now() - session.startTime)/60000)}m
                    </div>
                ` : ''}
            </div>
        `;
    }).join('');
}

function renderActiveSessions() {
    const container = document.getElementById('active-device-sessions');
    if (!container) return;
    
    container.innerHTML = platformMonitor.activeSessions.map(session => {
        const platform = platformMonitor.platforms[session.platform];
        const duration = Math.floor((Date.now() - session.startTime) / 1000);
        
        return `
            <div class="flex items-center justify-between p-2 bg-black/30 rounded border border-white/5 hover:border-cyan-500/30 transition-colors">
                <div class="flex items-center gap-2">
                    <div class="platform-icon ${platform.color} w-8 h-8 text-sm">
                        <i class="fab ${platform.icon}"></i>
                    </div>
                    <div>
                        <div class="text-xs text-white">${platform.name}</div>
                        <div class="text-[10px] text-cyan-400">${session.device}</div>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-xs text-gray-400 font-mono">${Math.floor(duration/60)}m ${duration%60}s</div>
                    <div class="text-[10px] text-cyan-400">${session.status.replace('_', ' ')}</div>
                </div>
            </div>
        `;
    }).join('');
}

function _openPlatformDetail(platformKey) {
    const platform = platformMonitor.platforms[platformKey];
    if (!platform) return;
    
    document.getElementById('detail-platform-name').textContent = platform.name;
    document.getElementById('detail-platform-icon').className = `platform-icon ${platform.color} w-12 h-12`;
    document.getElementById('detail-platform-icon').innerHTML = `<i class="fab ${platform.icon} text-white"></i>`;
    
    const statusEl = document.getElementById('detail-platform-status');
    statusEl.textContent = platform.status.charAt(0).toUpperCase() + platform.status.slice(1);
    statusEl.className = `text-xs px-2 py-0.5 rounded ${
        platform.status === 'active' ? 'bg-green-500/20 text-green-400' :
        platform.status === 'warning' ? 'bg-orange-500/20 text-orange-400' :
        platform.status === 'error' ? 'bg-red-500/20 text-red-400' :
        'bg-gray-500/20 text-gray-400'
    }`;
    
    const duoStatus = document.getElementById('detail-duo-status');
    if (platform.duoLinked) {
        duoStatus.textContent = `DuoPlus: ${platform.deviceId}`;
        duoStatus.className = 'text-xs px-2 py-0.5 rounded bg-cyan-500/20 text-cyan-400';
    } else {
        duoStatus.textContent = 'DuoPlus: Inactive';
        duoStatus.className = 'text-xs px-2 py-0.5 rounded bg-gray-800 text-gray-500';
    }
    
    document.getElementById('detail-latency').textContent = platform.latency ? `${platform.latency}ms` : '--';
    document.getElementById('detail-success').textContent = `${platform.uptime}%`;
    document.getElementById('detail-rate').textContent = `${platform.rateLimit.used}/${platform.rateLimit.total}`;
    document.getElementById('detail-features').textContent = platform.features.length || 'None';
    
    // Health timeline
    const timeline = document.getElementById('health-timeline');
    timeline.innerHTML = platform.healthHistory.map((h, i) => `
        <div class="flex-1 ${h === 100 ? 'bg-green-400' : 'bg-red-400'} rounded-sm relative group cursor-pointer" 
             style="opacity: ${0.3 + (i/24)*0.7}">
            <div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-1 hidden group-hover:block bg-black/90 text-white text-[10px] px-2 py-1 rounded whitespace-nowrap z-10">
                ${i}h ago: ${h === 100 ? 'Operational' : 'Down'}
            </div>
        </div>
    `).join('');
    
    // Error log
    const errorLog = document.getElementById('platform-error-log');
    if (platform.lastError) {
        errorLog.innerHTML = `
            <div class="text-red-400 flex items-start gap-2">
                <i class="fas fa-exclamation-circle mt-0.5"></i>
                <div>
                    <div class="font-bold">${new Date().toLocaleTimeString()}</div>
                    <div>${platform.lastError}</div>
                </div>
            </div>
        `;
    } else {
        errorLog.innerHTML = '<div class="text-gray-500">No errors in last 24h</div>';
    }
    
    document.getElementById('platform-detail-modal').classList.remove('hidden');
}

function _closePlatformDetail() {
    document.getElementById('platform-detail-modal').classList.add('hidden');
}

function _showSessionDetails(deviceId) {
    const session = platformMonitor.activeSessions.find(s => s.device === deviceId);
    if (session) {
        addLog(`[DuoPlus] Session ${session.id} on ${deviceId}: ${session.status.replace('_', ' ')}`);
    }
}

// XAI (Explainable AI) Functions
function openXAIAnalysis(applicationId) {
    const modal = document.getElementById('xai-modal');
    
    // Generate attention heatmap
    const attentionGrid = document.getElementById('attention-grid');
    attentionGrid.innerHTML = '';
    
    for(let i=0; i<24; i++) {
        const cell = document.createElement('div');
        const intensity = Math.random();
        let bgClass;
        if(intensity > 0.8) bgClass = 'bg-cyan-400';
        else if(intensity > 0.6) bgClass = 'bg-cyan-400/60';
        else if(intensity > 0.4) bgClass = 'bg-cyan-400/30';
        else bgClass = 'bg-cyan-400/10';
        
        cell.className = `${bgClass} rounded h-8 transition-all hover:scale-110 cursor-pointer`;
        cell.title = `Layer ${Math.floor(i/6)+1} Node ${(i%6)+1}: ${(intensity*100).toFixed(1)}% activation`;
        attentionGrid.appendChild(cell);
    }
    
    modal.classList.remove('hidden');
    addLog(`[XAI] Generated explanation for ${applicationId}`);
}

function closeXAIModal() {
    document.getElementById('xai-modal').classList.add('hidden');
}

function _exportExplanation() {
    showToast('Generating PDF explanation report...', 'info');
    setTimeout(() => {
        showToast('Report downloaded: XAI-APP-2024-0892.pdf', 'success');
        addLog('[XAI] Explanation report exported');
    }, 1500);
}

function _challengeDecision() {
    if(confirm('Flag this decision for human review?')) {
        showToast('Decision challenged - Escalated to senior underwriter', 'warning');
        addLog('[Compliance] Decision challenged by operator');
        closeXAIModal();
    }
}

// Audit Trail System
const auditEvents = [
    { time: '2024-01-27T14:32:01Z', type: 'input', user: 'System', action: 'Application received', detail: 'APP-2024-0892 submitted via API' },
    { time: '2024-01-27T14:32:01Z', type: 'security', user: 'System', action: 'Identity verification', detail: 'SSN matched with credit bureau' },
    { time: '2024-01-27T14:32:02Z', type: 'process', user: 'Auto-Underwriter', action: 'Risk calculation', detail: 'Neural network inference completed (12ms)' },
    { time: '2024-01-27T14:32:02Z', type: 'lookup', user: 'System', action: 'LexisNexis query', detail: 'No fraud patterns detected' },
    { time: '2024-01-27T14:32:03Z', type: 'decision', user: 'AI Model v2.1.3', action: 'Decision rendered', detail: 'APPROVED with 94.2% confidence' },
    { time: '2024-01-27T14:32:03Z', type: 'notify', user: 'System', action: 'Webhook dispatched', detail: 'POST /webhooks/approval (200 OK)' }
];

function showAuditTrail(_applicationId) {
    const modal = document.getElementById('audit-modal');
    const container = document.getElementById('audit-timeline');
    
    container.innerHTML = auditEvents.map((event, _idx) => {
        const icons = {
            input: 'fa-upload text-blue-400',
            security: 'fa-shield-alt text-green-400',
            process: 'fa-cogs text-cyan-400',
            lookup: 'fa-database text-purple-400',
            decision: 'fa-gavel text-orange-400',
            notify: 'fa-paper-plane text-gray-400'
        };
        
        const time = new Date(event.time).toLocaleTimeString();
        
        return `
            <div class="relative pl-8 animate-[slideIn_0.3s_ease-out]">
                <div class="absolute -left-[9px] top-0 w-4 h-4 rounded-full bg-gray-900 border-2 border-purple-500"></div>
                <div class="bg-black/40 rounded-lg p-3 border border-white/5 hover:border-purple-500/30 transition-colors">
                    <div class="flex items-center justify-between mb-1">
                        <div class="flex items-center gap-2">
                            <i class="fas ${icons[event.type]}"></i>
                            <span class="text-sm text-white font-medium">${event.action}</span>
                        </div>
                        <span class="text-xs text-gray-500 mono">${time}</span>
                    </div>
                    <div class="text-xs text-gray-400 mb-1">${event.detail}</div>
                    <div class="text-[10px] text-gray-600">Actor: ${event.user}</div>
                </div>
            </div>
        `;
    }).join('');
    
    modal.classList.remove('hidden');
}

function _closeAuditModal() {
    document.getElementById('audit-modal').classList.add('hidden');
}

function _exportAuditPDF() {
    showToast('Generating compliance PDF...', 'info');
    setTimeout(() => showToast('Audit trail exported', 'success'), 1000);
}

// Advanced Keyboard Shortcuts
document.addEventListener('keydown', (e) => {
    // Only process if not in input field
    if(e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
    
    switch(e.key.toLowerCase()) {
        case 'e':
            // Explain current decision
            if(state.recentDecisions && state.recentDecisions.length > 0) {
                openXAIAnalysis(state.recentDecisions[0].time);
            }
            break;
        case 'a':
            // Show audit trail
            showAuditTrail('APP-2024-0892');
            break;
        case 'r':
            // Refresh all data
            if(e.ctrlKey) {
                e.preventDefault();
                refreshAllPlatforms();
                renderPatterns();
                renderFraudHeatmap();
                showToast('All systems refreshed', 'success');
            }
            break;
        case 'n':
            // New application
            simulateNewApplication();
            break;
        case 'q':
            // Open review queue
            openReviewQueue();
            break;
        case '?':
            // Show help
            showShortcutHelp();
            break;
    }
});

function showShortcutHelp() {
    const helpText = `
Keyboard Shortcuts:
• N - New Application
• Q - Review Queue  
• E - Explain Decision (XAI)
• A - Audit Trail
• Ctrl+R - Refresh All
• 1-5 - Navigate Steps
• ? - Show this help
    `;
    alert(helpText);
}

function refreshAllPlatforms() {
    renderEnhancedPlatformGrid();
    renderDeviceMatrix();
    renderActiveSessions();
}

// Data Export Functions
function _exportDecisionsCSV() {
    const headers = ['Time', 'Applicant', 'Risk Score', 'Decision', 'Reason'];
    const rows = (state.recentDecisions || []).map(d => 
        [d.time, d.applicant, d.score, d.decision, d.reason].join(',')
    );
    const csv = [headers.join(','), ...rows].join('\n');
    
    downloadFile(csv, 'decisions-export.csv', 'text/csv');
    showToast('CSV exported successfully', 'success');
}

function _exportRiskReport() {
    const report = {
        generatedAt: new Date().toISOString(),
        summary: {
            totalProcessed: (state.recentDecisions || []).length,
            approvalRate: '87.3%',
            avgRiskScore: 34.2,
            fraudDetected: 3
        },
        modelPerformance: {
            accuracy: '98.7%',
            falsePositives: 12,
            falseNegatives: 2
        }
    };
    
    downloadFile(JSON.stringify(report, null, 2), 'risk-report.json', 'application/json');
    showToast('Risk report exported', 'success');
}

function downloadFile(content, filename, type) {
    const blob = new Blob([content], { type });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    a.click();
    URL.revokeObjectURL(url);
}

// Initialize platform monitoring
document.addEventListener('DOMContentLoaded', () => {
    renderDuoPlusDevices();
    renderEnhancedPlatformGrid();
    renderDeviceMatrix();
    renderActiveSessions();
    
    // Auto-refresh monitoring data
    setInterval(() => {
        renderEnhancedPlatformGrid();
        renderDeviceMatrix();
        renderActiveSessions();
    }, 10000);
    
    // Add right-click context menu to decisions
    const decisionsTable = document.getElementById('decisions-table');
    if(decisionsTable) {
        decisionsTable.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            if(confirm('View XAI explanation for this decision?')) {
                openXAIAnalysis('APP-2024-0892');
            }
        });
    }
    
    // Auto-refresh feed items
    setInterval(() => {
        if(Math.random() > 0.7) {
            addFeedItem();
        }
    }, 10000);
});

// Bulk Operations for Review Queue
function _bulkReject() {
    const checkboxes = document.querySelectorAll('.review-checkbox:checked');
    if(checkboxes.length === 0) {
        showToast('No items selected', 'warning');
        return;
    }
    if(confirm(`Reject ${checkboxes.length} applications?`)) {
        checkboxes.forEach(cb => {
            const index = cb.dataset.index;
            rejectItem(index);
        });
        showToast(`Bulk rejected ${checkboxes.length} items`, 'success');
    }
}

// Enhanced Device Control with ADB Commands
const ADBCommandHistory = [];

async function _executeADBCommand(command) {
    const deviceId = state.duoplus.selectedDevice;
    if(!deviceId) {
        showToast('No device selected', 'error');
        return;
    }
    
    const logs = document.getElementById('device-logs');
    if(logs) {
        logs.innerHTML += `<div class="text-cyan-400 mono">$ ${command}</div>`;
        
        // Simulate ADB execution
        setTimeout(() => {
            let response = 'Success';
            if(command.includes('shell')) response = 'package:com.android.settings\npackage:com.stripe.android';
            if(command.includes('logcat')) response = 'I/StripeSDK( 1234): Payment confirmed';
            if(command.includes('input')) response = 'Injecting touch event...';
            
            logs.innerHTML += `<div class="text-gray-500 ml-4">${response}</div>`;
            logs.scrollTop = logs.scrollHeight;
            
            ADBCommandHistory.push({ command, response, time: new Date() });
        }, 500);
    }
}

// Add ADB Console to device modal
function _showADBConsole() {
    const console = document.createElement('div');
    console.className = 'mt-4 bg-black/50 rounded-lg p-3 border border-cyan-500/30';
    console.innerHTML = `
        <div class="flex items-center justify-between mb-2">
            <span class="text-xs text-cyan-400 font-mono">ADB Shell</span>
            <button onclick="this.parentElement.parentElement.remove()" class="text-gray-500 hover:text-white">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="flex gap-2 mb-2">
            <input type="text" id="adb-input" placeholder="pm list packages..." 
                   class="flex-1 bg-black/50 border border-gray-700 rounded px-2 py-1 text-xs text-white font-mono focus:border-cyan-400 outline-none">
            <button onclick="executeADBCommand(document.getElementById('adb-input').value)" 
                    class="px-3 py-1 bg-cyan-500/20 text-cyan-400 rounded hover:bg-cyan-500/30 text-xs">
                <i class="fas fa-play"></i>
            </button>
        </div>
        <div class="flex gap-1 flex-wrap">
            <button onclick="executeADBCommand('shell pm list packages')" class="px-2 py-1 bg-white/5 rounded text-[10px] text-gray-400 hover:text-white">List Apps</button>
            <button onclick="executeADBCommand('logcat -d | grep Stripe')" class="px-2 py-1 bg-white/5 rounded text-[10px] text-gray-400 hover:text-white">Logs</button>
            <button onclick="executeADBCommand('shell screencap -p /sdcard/screen.png')" class="px-2 py-1 bg-white/5 rounded text-[10px] text-gray-400 hover:text-white">Screenshot</button>
        </div>
    `;
    
    const activeDeviceConsole = document.getElementById('active-device-console');
    if(activeDeviceConsole) {
        activeDeviceConsole.appendChild(console);
        const adbInput = document.getElementById('adb-input');
        if(adbInput) adbInput.focus();
    }
}

// Real-time Metrics Update
function updateMetricsRealtime() {
    // Simulate live data changes
    const metrics = [
        { id: 'total-linked', delta: () => Math.floor(Math.random() * 5) },
        { id: 'auto-onboarded', delta: () => Math.floor(Math.random() * 3) },
        { id: 'fraud-blocked', value: () => Math.floor(Math.random() * 10) + 124 }
    ];
    
    metrics.forEach(metric => {
        const el = document.getElementById(metric.id);
        if(el && metric.delta) {
            const current = parseInt(el.textContent.replace(/,/g, ''), 10);
            el.textContent = (current + metric.delta()).toLocaleString();
        } else if(el && metric.value) {
            el.textContent = metric.value().toLocaleString();
        }
    });
}

setInterval(updateMetricsRealtime, 5000);

// ==========================================
// MULTI-TENANT MANAGEMENT
// ==========================================

const TenantManager = {
    tenants: [
        { 
            id: 'tenant-acme', 
            name: 'Acme Corp', 
            plan: 'Enterprise', 
            users: 2450, 
            volume: '$12.4M', 
            models: 3, 
            status: 'active',
            quota: { api: 84, storage: 45, compute: 24 }
        },
        { 
            id: 'tenant-globex', 
            name: 'Globex Financial', 
            plan: 'Enterprise', 
            users: 1890, 
            volume: '$8.7M', 
            models: 2, 
            status: 'active',
            quota: { api: 62, storage: 78, compute: 45 }
        },
        { 
            id: 'tenant-soylent', 
            name: 'Soylent Lending', 
            plan: 'Professional', 
            users: 567, 
            volume: '$2.1M', 
            models: 1, 
            status: 'warning',
            quota: { api: 95, storage: 32, compute: 12 }
        },
        { 
            id: 'tenant-initech', 
            name: 'Initech Loans', 
            plan: 'Starter', 
            users: 89, 
            volume: '$340K', 
            models: 1, 
            status: 'active',
            quota: { api: 34, storage: 12, compute: 8 }
        }
    ],

    renderTenants() {
        const tbody = document.getElementById('tenant-table');
        if(!tbody) return;
        
        tbody.innerHTML = this.tenants.map(t => `
            <tr class="border-b border-gray-800 hover:bg-white/5 transition-colors">
                <td class="py-3">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-cyan-500/20 flex items-center justify-center">
                            <i class="fas fa-building text-cyan-400 text-sm"></i>
                        </div>
                        <div>
                            <div class="text-white font-medium">${t.name}</div>
                            <div class="text-xs text-gray-500">${t.id}</div>
                        </div>
                    </div>
                </td>
                <td class="py-3">
                    <span class="px-2 py-1 rounded bg-cyan-500/10 text-cyan-400 text-xs border border-cyan-500/20">${t.plan}</span>
                </td>
                <td class="py-3 text-gray-400">${t.users.toLocaleString()}</td>
                <td class="py-3 text-gray-400">${t.volume}</td>
                <td class="py-3 text-gray-400">${t.models}</td>
                <td class="py-3">
                    <span class="flex items-center gap-1.5">
                        <div class="w-2 h-2 rounded-full ${t.status === 'active' ? 'bg-green-400' : 'bg-orange-400'} animate-pulse"></div>
                        <span class="${t.status === 'active' ? 'text-green-400' : 'text-orange-400'} text-xs capitalize">${t.status}</span>
                    </span>
                </td>
                <td class="py-3">
                    <button onclick="openTenantModal('${t.id}')" class="text-cyan-400 hover:text-cyan-300 text-xs">
                        <i class="fas fa-cog"></i> Manage
                    </button>
                </td>
            </tr>
        `).join('');

        // Render isolation visualization
        this.renderIsolationViz();
    },

    renderIsolationViz() {
        const container = document.getElementById('isolation-viz');
        if(!container) return;
        
        container.innerHTML = this.tenants.map(t => `
            <div class="bg-black/40 rounded-lg p-4 border border-white/5">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-sm text-white font-medium">${t.name}</span>
                    <span class="text-xs text-gray-500">${t.plan}</span>
                </div>
                <div class="space-y-2">
                    <div>
                        <div class="flex justify-between text-xs mb-1">
                            <span class="text-gray-500">Compute</span>
                            <span class="text-cyan-400">${t.quota.compute}%</span>
                        </div>
                        <div class="h-1.5 bg-gray-800 rounded-full overflow-hidden">
                            <div class="h-full bg-cyan-400" style="width: ${t.quota.compute}%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between text-xs mb-1">
                            <span class="text-gray-500">Memory</span>
                            <span class="text-purple-400">${t.quota.storage}%</span>
                        </div>
                        <div class="h-1.5 bg-gray-800 rounded-full overflow-hidden">
                            <div class="h-full bg-purple-400" style="width: ${t.quota.storage}%"></div>
                        </div>
                    </div>
                </div>
                <div class="mt-3 flex gap-2">
                    <span class="px-2 py-0.5 rounded bg-green-500/10 text-green-400 text-[10px] border border-green-500/20">Isolated DB</span>
                    <span class="px-2 py-0.5 rounded bg-cyan-500/10 text-cyan-400 text-[10px] border border-cyan-500/20">Dedicated Queue</span>
                </div>
            </div>
        `).join('');
    }
};

// ==========================================
// ALERT MANAGEMENT SYSTEM
// ==========================================

const AlertManager = {
    alerts: [
        { 
            id: 'ALT-2847', 
            severity: 'critical', 
            title: 'Fraud Rate Spike', 
            message: 'Fraud rate exceeded 5% threshold',
            timestamp: Date.now() - 120000,
            acknowledged: false,
            source: 'fraud-detection',
            tenant: 'Acme Corp'
        },
        { 
            id: 'ALT-2846', 
            severity: 'warning', 
            title: 'API Latency Degradation', 
            message: 'P99 latency > 100ms for 5 minutes',
            timestamp: Date.now() - 300000,
            acknowledged: false,
            source: 'api-gateway',
            tenant: 'All'
        },
        { 
            id: 'ALT-2845', 
            severity: 'warning', 
            title: 'Model Drift Detected', 
            message: 'KS statistic = 0.12 for risk model v2.1.3',
            timestamp: Date.now() - 600000,
            acknowledged: true,
            source: 'ml-platform',
            tenant: 'Globex Financial'
        }
    ],

    renderAlerts() {
        const container = document.getElementById('alert-feed');
        if(!container) return;
        
        container.innerHTML = this.alerts.map(alert => {
            const colors = {
                critical: 'red',
                warning: 'orange',
                info: 'cyan'
            };
            const color = colors[alert.severity];
            const timeAgo = this.getTimeAgo(alert.timestamp);
            
            return `
                <div class="flex items-start gap-3 p-3 rounded-lg border-l-4 ${alert.acknowledged ? 'bg-black/20 border-gray-600 opacity-60' : `bg-${color}-500/10 border-${color}-400`} ${!alert.acknowledged ? 'animate-pulse' : ''} cursor-pointer hover:bg-white/5 transition-colors" onclick="openAlertModal('${alert.id}')">
                    <div class="w-8 h-8 rounded-full bg-${color}-500/20 flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-exclamation text-${color}-400 text-xs"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center justify-between mb-1">
                            <span class="text-sm text-white font-medium truncate">${alert.title}</span>
                            <span class="text-xs text-gray-500">${timeAgo}</span>
                        </div>
                        <p class="text-xs text-gray-400 truncate">${alert.message}</p>
                        <div class="flex items-center gap-2 mt-2">
                            <span class="px-1.5 py-0.5 rounded bg-white/5 text-gray-500 text-[10px]">${alert.source}</span>
                            <span class="px-1.5 py-0.5 rounded bg-white/5 text-gray-500 text-[10px]">${alert.tenant}</span>
                        </div>
                    </div>
                    ${!alert.acknowledged ? `<div class="w-2 h-2 rounded-full bg-${color}-400 animate-pulse"></div>` : ''}
                </div>
            `;
        }).join('');
    },

    getTimeAgo(timestamp) {
        const seconds = Math.floor((Date.now() - timestamp) / 1000);
        if(seconds < 60) return 'Just now';
        if(seconds < 3600) return `${Math.floor(seconds/60)}m ago`;
        return `${Math.floor(seconds/3600)}h ago`;
    },

    startAutoRefresh() {
        setInterval(() => {
            // Simulate new alerts
            if(Math.random() > 0.95) {
                this.alerts.unshift({
                    id: `ALT-${2848 + this.alerts.length}`,
                    severity: Math.random() > 0.7 ? 'critical' : 'warning',
                    title: 'New Anomaly Detected',
                    message: 'Unusual pattern in application velocity',
                    timestamp: Date.now(),
                    acknowledged: false,
                    source: 'auto-underwriter',
                    tenant: 'System'
                });
                if(this.alerts.length > 50) this.alerts.pop();
                this.renderAlerts();
            }
        }, 5000);
    }
};

// ==========================================
// ML MODEL REGISTRY
// ==========================================

const ModelRegistry = {
    models: [
        { 
            name: 'Risk Scoring NN', 
            version: 'v3.0.0-NN', 
            stage: 'production', 
            accuracy: 98.7, 
            latency: 12, 
            deployed: '2024-01-15',
            framework: 'PyTorch'
        },
        { 
            name: 'Risk Scoring NN', 
            version: 'v2.2.0', 
            stage: 'staging', 
            accuracy: 97.2, 
            latency: 28, 
            deployed: '2024-01-20',
            framework: 'XGBoost'
        },
        { 
            name: 'Fraud Detection', 
            version: 'v1.5.0', 
            stage: 'production', 
            accuracy: 96.8, 
            latency: 8, 
            deployed: '2024-01-10',
            framework: 'TensorFlow'
        },
        { 
            name: 'Income Verification', 
            version: 'v1.2.0', 
            stage: 'archived', 
            accuracy: 94.5, 
            latency: 45, 
            deployed: '2023-12-01',
            framework: 'scikit-learn'
        }
    ],

    renderModels() {
        const tbody = document.getElementById('model-table');
        if(!tbody) return;
        
        tbody.innerHTML = this.models.map(m => {
            const stageColors = {
                production: 'green',
                staging: 'cyan',
                development: 'purple',
                archived: 'gray'
            };
            
            return `
                <tr class="border-b border-gray-800 hover:bg-white/5 transition-colors cursor-pointer" onclick="openModelModal('${m.version}')">
                    <td class="py-3">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center">
                                <i class="fas fa-brain text-purple-400 text-sm"></i>
                            </div>
                            <span class="text-white font-medium">${m.name}</span>
                        </div>
                    </td>
                    <td class="py-3 text-cyan-400 mono">${m.version}</td>
                    <td class="py-3">
                        <span class="px-2 py-1 rounded bg-${stageColors[m.stage]}-500/10 text-${stageColors[m.stage]}-400 text-xs border border-${stageColors[m.stage]}-500/20 capitalize">${m.stage}</span>
                    </td>
                    <td class="py-3 text-green-400">${m.accuracy}%</td>
                    <td class="py-3 text-gray-400">${m.latency}ms</td>
                    <td class="py-3 text-gray-500">${m.deployed}</td>
                    <td class="py-3">
                        <div class="flex gap-2">
                            <button class="text-cyan-400 hover:text-cyan-300" onclick="event.stopPropagation(); deployModel('${m.version}')">
                                <i class="fas fa-rocket"></i>
                            </button>
                            <button class="text-gray-400 hover:text-white" onclick="event.stopPropagation();">
                                <i class="fas fa-ellipsis-v"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
    },

    initDriftChart() {
        const ctx = document.getElementById('modelDriftChart');
        if(!ctx) return;
        
        new Chart(ctx.getContext('2d'), {
            type: 'line',
            data: {
                labels: ['1d', '3d', '7d', '14d', '21d', '30d'],
                datasets: [{
                    label: 'Accuracy',
                    data: [98.9, 98.8, 98.7, 98.6, 98.5, 98.7],
                    borderColor: '#00f3ff',
                    tension: 0.4
                }, {
                    label: 'Drift Threshold',
                    data: [97, 97, 97, 97, 97, 97],
                    borderColor: '#ff9d00',
                    borderDash: [5, 5],
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { min: 95, max: 100, ticks: { color: '#9ca3af' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                    x: { ticks: { color: '#9ca3af' }, grid: { display: false } }
                }
            }
        });
    }
};

// ==========================================
// UI CONTROLLER FUNCTIONS
// ==========================================

function _createTenant() {
    const name = prompt('Enter tenant name:');
    if(name) {
        TenantManager.tenants.push({
            id: `tenant-${Date.now()}`,
            name: name,
            plan: 'Starter',
            users: 0,
            volume: '$0',
            models: 0,
            status: 'active',
            quota: { api: 0, storage: 0, compute: 0 }
        });
        TenantManager.renderTenants();
        showToast(`Created tenant: ${name}`, 'success');
    }
}

function _openTenantModal(id) {
    const tenant = TenantManager.tenants.find(t => t.id === id);
    if(!tenant) return;
    
    document.getElementById('tenant-modal-name').textContent = tenant.name;
    document.getElementById('tenant-modal-id').textContent = tenant.id;
    document.getElementById('tenant-modal').classList.remove('hidden');
}

function closeTenantModal() {
    document.getElementById('tenant-modal').classList.add('hidden');
}

function _impersonateTenant() {
    showToast('Switched to tenant context (read-only)', 'warning');
    closeTenantModal();
}

function _suspendTenant() {
    if(confirm('Suspend this tenant? All API calls will be rejected.')) {
        showToast('Tenant suspended', 'error');
        closeTenantModal();
    }
}

function _saveTenantConfig() {
    showToast('Tenant configuration saved', 'success');
    closeTenantModal();
}

function _openAlertModal(_id) {
    document.getElementById('alert-modal').classList.remove('hidden');
}

function closeAlertModal() {
    document.getElementById('alert-modal').classList.add('hidden');
}

function _executeRemediation(action) {
    const actions = {
        'enable-enhanced-fraud': 'Enhanced fraud mode activated',
        'scale-fraud-team': 'Fraud review team scaled +5 agents'
    };
    showToast(actions[action] || 'Action executed', 'success');
    closeAlertModal();
}

function _acknowledgeAlert() {
    showToast('Alert acknowledged', 'success');
    closeAlertModal();
}

function _escalateAlert() {
    showToast('Alert escalated to L2 support', 'warning');
    closeAlertModal();
}

function _snoozeAlert() {
    showToast('Alert snoozed for 1 hour', 'info');
    closeAlertModal();
}

function _acknowledgeAll() {
    AlertManager.alerts.forEach(a => a.acknowledged = true);
    AlertManager.renderAlerts();
    showToast('All alerts acknowledged', 'success');
}

function _createAlertRule() {
    const name = prompt('Rule name:');
    if(name) {
        showToast(`Created alert rule: ${name}`, 'success');
    }
}

function _openModelModal(_version) {
    document.getElementById('model-modal').classList.remove('hidden');
    setTimeout(() => ModelRegistry.initDriftChart(), 100);
}

function closeModelModal() {
    document.getElementById('model-modal').classList.add('hidden');
}

function _rollbackModel() {
    if(confirm('Rollback to previous version?')) {
        showToast('Model rollback initiated', 'warning');
        closeModelModal();
    }
}

function _promoteModel() {
    showToast('Model promoted to production', 'success');
    closeModelModal();
}

function _retrainModel() {
    showToast('Retraining job queued', 'info');
    closeModelModal();
}

function _cloneModel() {
    showToast('Model cloned to registry', 'success');
}

function _registerModel() {
    showToast('Model registration form opened', 'info');
}

function _startTraining() {
    showToast('New training job configured', 'info');
}

function _deployModel(version) {
    showToast(`Deploying ${version}...`, 'info');
}

function _showPipelineStage(stage) {
    const stages = {
        data: 'Data Preparation: 2.4M records processed, 98.5% clean',
        training: 'Training: Epoch 45/100, Loss: 0.0234, ETA: 2h 15m',
        validation: 'Validation: Queued, 5 test suites pending',
        staging: 'Staging: A/B test configured, 10% traffic',
        production: 'Production: Canary deployment ready'
    };
    showToast(stages[stage], 'info');
}

// ==========================================
// INITIALIZATION
// ==========================================

document.addEventListener('DOMContentLoaded', () => {
    // Initialize all modules
    TenantManager.renderTenants();
    AlertManager.renderAlerts();
    AlertManager.startAutoRefresh();
    ModelRegistry.renderModels();
    BlockchainManager.init();
    
    // Extend dashboard switcher
    const _originalSwitch = window.switchDashboard;
    window.switchDashboard = (name) => {
        document.querySelectorAll('.dashboard-view').forEach(d => d.classList.add('hidden'));
        document.getElementById(`${name}-dashboard`).classList.remove('hidden');
        
        if(name === 'tenant') TenantManager.renderTenants();
        if(name === 'alerting') {
            AlertManager.renderAlerts();
            initAlertCharts();
        }
        if(name === 'models') ModelRegistry.renderModels();
        if(name === 'blockchain') {
            BlockchainManager.render();
            BlockchainManager.renderTransactions();
        }
    };
});

// ==========================================
// BLOCKCHAIN AUDIT SYSTEM
// ==========================================

const BlockchainManager = {
    blocks: [],
    transactions: [],
    
    generateBlock(index) {
        const prevHash = index === 0 ? '0'.repeat(64) : this.blocks[index-1].hash;
        const timestamp = Date.now() - (10 - index) * 15000;
        const txs = Math.floor(Math.random() * 50) + 10;
        const hash = this.generateHash(prevHash + timestamp + txs);
        
        return {
            index,
            timestamp,
            transactions: txs,
            prevHash,
            hash,
            validator: `node-${Math.floor(Math.random() * 24) + 1}`,
            merkleRoot: this.generateHash(`merkle-${index}`)
        };
    },
    
    generateHash(data) {
        let hash = 0;
        for(let i = 0; i < data.length; i++) {
            const char = data.charCodeAt(i);
            hash = ((hash << 5) - hash) + char;
            hash = hash & hash;
        }
        return Math.abs(hash).toString(16).padStart(64, '0');
    },
    
    init() {
        // Generate last 10 blocks
        for(let i = 0; i < 10; i++) {
            this.blocks.push(this.generateBlock(i));
        }
        this.render();
        this.startMining();
    },
    
    render() {
        const container = document.getElementById('blockchain-viz');
        if(!container) return;
        
        container.innerHTML = this.blocks.map((block, idx) => `
            <div class="flex-shrink-0 w-64 bg-black/40 rounded-xl p-4 border ${idx === this.blocks.length - 1 ? 'border-green-400/50 glow-green' : 'border-white/10'} relative group hover:border-cyan-400/50 transition-all cursor-pointer" onclick="showBlockDetails(${idx})">
                ${idx > 0 ? `<div class="absolute -left-6 top-1/2 -translate-y-1/2 text-gray-600"><i class="fas fa-link"></i></div>` : ''}
                <div class="flex items-center justify-between mb-2">
                    <span class="text-cyan-400 font-bold mono">#${2847290 + block.index}</span>
                    <span class="text-xs text-gray-500">${new Date(block.timestamp).toLocaleTimeString()}</span>
                </div>
                <div class="space-y-1 text-xs mb-3">
                    <div class="flex justify-between">
                        <span class="text-gray-500">Txs:</span>
                        <span class="text-white">${block.transactions}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-500">Validator:</span>
                        <span class="text-purple-400">${block.validator}</span>
                    </div>
                </div>
                <div class="pt-2 border-t border-white/10">
                    <div class="text-[10px] text-gray-600 mono truncate" title="${block.hash}">Hash: ${block.hash.slice(0, 16)}...</div>
                </div>
                ${idx === this.blocks.length - 1 ? '<div class="absolute -top-2 -right-2 w-4 h-4 bg-green-400 rounded-full animate-pulse"></div>' : ''}
            </div>
        `).join('');
        
        // Auto-scroll to latest
        container.scrollLeft = container.scrollWidth;
    },
    
    startMining() {
        setInterval(() => {
            // Add new block
            const newBlock = this.generateBlock(this.blocks.length);
            this.blocks.push(newBlock);
            if(this.blocks.length > 20) this.blocks.shift();
            this.render();
            
            // Add transaction
            this.addTransaction();
        }, 15000);
    },
    
    addTransaction() {
        const events = ['DecisionRecorded', 'ModelUpdated', 'TenantConfigChanged', 'FraudDetected'];
        const event = events[Math.floor(Math.random() * events.length)];
        
        const tx = {
            hash: this.generateHash(Date.now().toString()),
            event,
            data: `APP-${20240000 + Math.floor(Math.random() * 1000)}`,
            timestamp: Date.now()
        };
        
        this.transactions.unshift(tx);
        if(this.transactions.length > 10) this.transactions.pop();
        
        this.renderTransactions();
    },
    
    renderTransactions() {
        const container = document.getElementById('tx-pool');
        if(!container) return;
        
        container.innerHTML = this.transactions.map(tx => `
            <div class="flex items-center justify-between p-2 bg-black/30 rounded hover:bg-white/5 transition-colors cursor-pointer" onclick="showTxDetails('${tx.hash}')">
                <div class="flex items-center gap-3">
                    <i class="fas fa-file-contract text-cyan-400"></i>
                    <div>
                        <div class="text-sm text-white">${tx.event}</div>
                        <div class="text-xs text-gray-500 mono">${tx.data}</div>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-xs text-gray-500">${new Date(tx.timestamp).toLocaleTimeString()}</div>
                    <div class="text-[10px] text-cyan-400 mono">${tx.hash.slice(0, 12)}...</div>
                </div>
            </div>
        `).join('');
    },
    
    addBlock() {
        const newBlock = this.generateBlock(this.blocks.length);
        this.blocks.push(newBlock);
        if(this.blocks.length > 20) this.blocks.shift();
        this.render();
        showToast('New block mined successfully', 'success');
    },
    
    verifyChain() {
        let isValid = true;
        for(let i = 1; i < this.blocks.length; i++) {
            if(this.blocks[i].prevHash !== this.blocks[i-1].hash) {
                isValid = false;
                break;
            }
        }
        showToast(isValid ? 'Blockchain integrity verified' : 'Chain integrity compromised', isValid ? 'success' : 'error');
    }
};

function _showBlockDetails(index) {
    const block = BlockchainManager.blocks[index];
    if(!block) return;
    
    showToast(`Block #${2847290 + block.index}: ${block.transactions} transactions, validated by ${block.validator}`, 'info');
}

function _showTxDetails(hash) {
    const tx = BlockchainManager.transactions.find(t => t.hash === hash);
    if(!tx) return;
    
    showToast(`Transaction: ${tx.event} for ${tx.data}`, 'info');
}

function initAlertCharts() {
    // Alert volume chart
    const volCtx = document.getElementById('alertVolumeChart');
    if(volCtx) {
        new Chart(volCtx.getContext('2d'), {
            type: 'bar',
            data: {
                labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00'],
                datasets: [{
                    label: 'Critical',
                    data: [2, 1, 5, 8, 12, 6],
                    backgroundColor: '#ff4444'
                }, {
                    label: 'Warning',
                    data: [5, 3, 12, 18, 24, 15],
                    backgroundColor: '#ff9d00'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { labels: { color: '#e0e0e0' } } },
                scales: {
                    y: { ticks: { color: '#9ca3af' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                    x: { ticks: { color: '#9ca3af' }, grid: { display: false } }
                }
            }
        });
    }
    
    // Alert type pie chart
    const typeCtx = document.getElementById('alertTypeChart');
    if(typeCtx) {
        new Chart(typeCtx.getContext('2d'), {
            type: 'doughnut',
            data: {
                labels: ['Fraud', 'Performance', 'Infrastructure', 'Compliance'],
                datasets: [{
                    data: [34, 28, 22, 16],
                    backgroundColor: ['#ff4444', '#ff9d00', '#00f3ff', '#b829dd']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { position: 'right', labels: { color: '#e0e0e0' } } }
            }
        });
    }
}

// Review Queue Data
        const reviewQueue = [
            {
                id: 'AUTO-004',
                user: 'john@fintech.io',
                platform: 'Stripe',
                issue: 'Document blurry - ID verification failed OCR',
                riskScore: 45,
                submitted: '2 mins ago',
                type: 'document'
            },
            {
                id: 'AUTO-005',
                user: 'sarah@crypto.com',
                platform: 'PayPal',
                issue: 'AML flag - PEP list match requires manual verification',
                riskScore: 62,
                submitted: '5 mins ago',
                type: 'aml'
            },
            {
                id: 'AUTO-006',
                user: 'mike@startup.org',
                platform: 'Cash App',
                issue: 'High velocity signup - Possible bot detection',
                riskScore: 78,
                submitted: '12 mins ago',
                type: 'risk'
            }
        ];

        function openReviewQueue() {
            const modal = document.getElementById('review-modal');
            const container = document.getElementById('review-queue-items');
            
            container.innerHTML = reviewQueue.map((item, index) => `
                <div class="bg-black/30 rounded-xl p-4 border border-white/5 hover:border-orange-500/30 transition-all group" id="review-item-${index}">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-orange-500/20 flex items-center justify-center text-xs font-mono text-orange-400">
                                ${item.id.split('-')[1]}
                            </div>
                            <div>
                                <div class="flex items-center gap-2">
                                    <span class="text-white font-medium">${item.user}</span>
                                    <span class="text-xs px-2 py-0.5 rounded bg-gray-800 text-gray-400">${item.platform}</span>
                                </div>
                                <div class="text-xs text-gray-500 mt-0.5">Submitted ${item.submitted}</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-xs text-gray-400">Risk Score</div>
                            <div class="text-lg font-bold ${item.riskScore > 70 ? 'text-red-400' : item.riskScore > 40 ? 'text-orange-400' : 'text-yellow-400'} mono">
                                ${item.riskScore}
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-red-500/10 border border-red-500/20 rounded-lg p-3 mb-3">
                        <div class="flex items-start gap-2">
                            <i class="fas fa-exclamation-circle text-red-400 mt-0.5 text-xs"></i>
                            <span class="text-sm text-gray-300">${item.issue}</span>
                        </div>
                    </div>
                    
                    <div class="flex gap-2">
                        <button onclick="approveItem(${index})" class="flex-1 py-2 bg-green-500/20 text-green-400 rounded-lg hover:bg-green-500/30 transition-colors text-sm flex items-center justify-center gap-2">
                            <i class="fas fa-check"></i> Approve
                        </button>
                        <button onclick="rejectItem(${index})" class="flex-1 py-2 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 transition-colors text-sm flex items-center justify-center gap-2">
                            <i class="fas fa-times"></i> Reject
                        </button>
                        <button onclick="viewDetails(${index})" class="px-3 py-2 bg-white/5 text-white rounded-lg hover:bg-white/10 transition-colors text-sm">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
            `).join('');
            
            modal.classList.remove('hidden');
            addLog('[System] Opened review queue - 3 items pending');
        }

        function closeReviewQueue() {
            document.getElementById('review-modal').classList.add('hidden');
        }

        function approveItem(index) {
            const item = document.getElementById(`review-item-${index}`);
            item.style.opacity = '0.5';
            item.innerHTML = `
                <div class="flex items-center justify-center py-4 text-green-400">
                    <i class="fas fa-check-circle mr-2"></i> Approved - Processing automation...
                </div>
            `;
            setTimeout(() => {
                item.remove();
                updateQueueCount();
                addLog(`[Review] Approved ${reviewQueue[index].id} - Auto-provisioning resumed`);
            }, 1000);
        }

        function rejectItem(index) {
            const item = document.getElementById(`review-item-${index}`);
            item.style.opacity = '0.5';
            item.innerHTML = `
                <div class="flex items-center justify-center py-4 text-red-400">
                    <i class="fas fa-times-circle mr-2"></i> Rejected - User notified
                </div>
            `;
            setTimeout(() => {
                item.remove();
                updateQueueCount();
                addLog(`[Review] Rejected ${reviewQueue[index].id} - Notification sent`);
            }, 1000);
        }

        function _viewDetails(index) {
            const item = reviewQueue[index];
            alert(`Detailed Analysis for ${item.id}:\n\nUser: ${item.user}\nPlatform: ${item.platform}\nRisk Score: ${item.riskScore}/100\nIssue Type: ${item.type}\n\nRecommendation: ${item.riskScore > 70 ? 'Request additional documentation' : 'Approve with standard monitoring'}`);
        }

        function _bulkApprove() {
            if(confirm('Approve all 3 items?')) {
                reviewQueue.forEach((_, index) => {
                    setTimeout(() => approveItem(index), index * 200);
                });
                addLog('[Review] Bulk approval initiated for 3 items');
            }
        }

        function updateQueueCount() {
            const remaining = document.querySelectorAll('[id^="review-item-"]').length;
            document.getElementById('queue-stats').textContent = `Showing ${remaining} of ${remaining} items`;
            
            // Update the orange card badge
            const badge = document.querySelector('.badge-glow');
            if(badge && remaining === 0) {
                badge.innerHTML = '<i class="fas fa-check-circle"></i><span class="font-mono">0</span><span class="text-green-400/70 font-normal">Pending</span>';
                badge.classList.remove('bg-orange-500/10', 'border-orange-400/40', 'text-orange-400');
                badge.classList.add('bg-green-500/10', 'border-green-400/40', 'text-green-400');
                closeReviewQueue();
            }
        }

        // Close modal on outside click
        document.getElementById('review-modal').addEventListener('click', function(e) {
            if(e.target === this) closeReviewQueue();
        });

        // Initialize
        renderPatterns();
        renderLookups();
        renderWorkflow();
        renderFraudHeatmap();
        renderDecisionsTable();

        // Initialize Performance Chart
        const performanceCtx = document.getElementById('performanceChart');
        if (performanceCtx && !performanceCtx.chart) {
            performanceCtx.chart = new Chart(performanceCtx.getContext('2d'), {
                type: 'radar',
                data: {
                    labels: ['Accuracy', 'Precision', 'Recall', 'F1 Score', 'Speed', 'Scalability'],
                    datasets: [{
                        label: 'Current Model',
                        data: [98.7, 97.2, 96.8, 94.0, 88.5, 92.3],
                        borderColor: '#00f3ff',
                        backgroundColor: 'rgba(0, 243, 255, 0.2)',
                        pointBackgroundColor: '#00f3ff',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#00f3ff'
                    }, {
                        label: 'Previous Model',
                        data: [95.2, 94.1, 93.7, 91.5, 82.3, 87.6],
                        borderColor: '#b829dd',
                        backgroundColor: 'rgba(184, 41, 221, 0.1)',
                        pointBackgroundColor: '#b829dd',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#b829dd'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    aspectRatio: 2,
                    plugins: {
                        legend: {
                            labels: { 
                                color: '#e0e0e0',
                                font: {
                                    size: 11
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#00f3ff',
                            bodyColor: '#e0e0e0',
                            borderColor: '#00f3ff',
                            borderWidth: 1
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { 
                                color: '#9ca3af',
                                backdropColor: 'transparent',
                                font: {
                                    size: 10
                                }
                            },
                            grid: { 
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            pointLabels: { 
                                color: '#e0e0e0',
                                font: {
                                    size: 11,
                                    weight: 'bold'
                                }
                            }
                        }
                    }
                }
            });
        }

        // Auto-update charts
        setInterval(() => {
            // Update payment chart with new data
            if (document.getElementById('paymentChart')?.chart) {
                const chart = document.getElementById('paymentChart').chart;
                chart.data.datasets[0].data = chart.data.datasets[0].data.map(() => 
                    (Math.random() * 2 + 1).toFixed(1)
                );
                chart.update('none');
            }
            
            // Update performance chart with simulated model improvements
            if (document.getElementById('performanceChart')?.chart) {
                const chart = document.getElementById('performanceChart').chart;
                // Simulate small performance variations
                chart.data.datasets[0].data = chart.data.datasets[0].data.map((_value, index) => {
                    const baseValue = [98.7, 97.2, 96.8, 94.0, 88.5, 92.3][index];
                    return Math.max(85, Math.min(100, baseValue + (Math.random() - 0.5) * 2));
                });
                chart.update('none');
            }
        }, 5000);

        // Initialize dashboard charts on load
        document.addEventListener('DOMContentLoaded', () => {
            renderDuoPlusDevices();
            
            // Initialize charts when dashboard is shown
            const originalSwitchDashboard = window.switchDashboard;
            window.switchDashboard = (dashboardName) => {
                originalSwitchDashboard(dashboardName);
                
                if (dashboardName === 'payments') {
                    setTimeout(() => initializePaymentChart(), 100);
                } else if (dashboardName === 'compliance') {
                    setTimeout(() => initializeComplianceChart(), 100);
                } else if (dashboardName === 'analytics') {
                    setTimeout(() => {
                        const performanceCtx = document.getElementById('performanceChart');
                        if (performanceCtx && !performanceCtx.chart) {
                            performanceCtx.chart = new Chart(performanceCtx.getContext('2d'), {
                                type: 'radar',
                                data: {
                                    labels: ['Accuracy', 'Precision', 'Recall', 'F1 Score', 'Speed', 'Scalability'],
                                    datasets: [{
                                        label: 'Current Model',
                                        data: [98.7, 97.2, 96.8, 94.0, 88.5, 92.3],
                                        borderColor: '#00f3ff',
                                        backgroundColor: 'rgba(0, 243, 255, 0.2)',
                                        pointBackgroundColor: '#00f3ff',
                                        pointBorderColor: '#fff',
                                        pointHoverBackgroundColor: '#fff',
                                        pointHoverBorderColor: '#00f3ff'
                                    }, {
                                        label: 'Previous Model',
                                        data: [95.2, 94.1, 93.7, 91.5, 82.3, 87.6],
                                        borderColor: '#b829dd',
                                        backgroundColor: 'rgba(184, 41, 221, 0.1)',
                                        pointBackgroundColor: '#b829dd',
                                        pointBorderColor: '#fff',
                                        pointHoverBackgroundColor: '#fff',
                                        pointHoverBorderColor: '#b829dd'
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: true,
                                    aspectRatio: 2,
                                    plugins: {
                                        legend: {
                                            labels: { 
                                                color: '#e0e0e0',
                                                font: {
                                                    size: 11
                                                }
                                            }
                                        },
                                        tooltip: {
                                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                            titleColor: '#00f3ff',
                                            bodyColor: '#e0e0e0',
                                            borderColor: '#00f3ff',
                                            borderWidth: 1
                                        }
                                    },
                                    scales: {
                                        r: {
                                            beginAtZero: true,
                                            max: 100,
                                            ticks: { 
                                                color: '#9ca3af',
                                                backdropColor: 'transparent',
                                                font: {
                                                    size: 10
                                                }
                                            },
                                            grid: { 
                                                color: 'rgba(255, 255, 255, 0.1)'
                                            },
                                            pointLabels: { 
                                                color: '#e0e0e0',
                                                font: {
                                                    size: 11,
                                                    weight: 'bold'
                                                }
                                            }
                                        }
                                    }
                                }
                            });
                        }
                    }, 100);
                }
            };
        });

        // Real-time feed simulation
        function addFeedItem() {
            const feed = document.getElementById('real-time-feed');
            const applications = [
                { id: 'APP-2024-0894', decision: 'Auto-approved', risk: 15, color: 'cyan' },
                { id: 'APP-2024-0895', decision: 'Manual review', risk: 42, color: 'orange' },
                { id: 'APP-2024-0896', decision: 'Auto-declined', risk: 71, color: 'red' },
                { id: 'APP-2024-0897', decision: 'Auto-approved', risk: 22, color: 'cyan' }
            ];
            
            const app = applications[Math.floor(Math.random() * applications.length)];
            const feedItem = document.createElement('div');
            feedItem.className = 'feed-item';
            feedItem.innerHTML = `
                <div class="flex items-center justify-between mb-1">
                    <span class="text-${app.color}-400 mono text-sm">${app.id}</span>
                    <span class="text-xs text-gray-500">Just now</span>
                </div>
                <div class="text-sm text-white">${app.decision}: Risk score ${app.risk}</div>
                <div class="text-xs text-gray-500">Model v2.1.3 • Confidence ${85 + Math.floor(Math.random() * 10)}%</div>
            `;
            
            feed.insertBefore(feedItem, feed.firstChild);
            
            // Remove old items
            while (feed.children.length > 5) {
                feed.removeChild(feed.lastChild);
            }
        }

        // Neural network interaction
        document.querySelectorAll('.neuron').forEach(neuron => {
            neuron.addEventListener('click', function() {
                this.style.background = 'radial-gradient(circle, #0aff68, rgba(10, 255, 104, 0.3))';
                this.style.borderColor = '#0aff68';
                
                setTimeout(() => {
                    this.style.background = 'radial-gradient(circle, #00f3ff, rgba(0, 243, 255, 0.3))';
                    this.style.borderColor = '#00f3ff';
                }, 1000);
            });
        });

        // Risk segment interaction
        document.querySelectorAll('.risk-segment').forEach(segment => {
            segment.addEventListener('click', function() {
                const tooltip = document.createElement('div');
                tooltip.className = 'absolute bg-black/90 text-white text-xs px-2 py-1 rounded pointer-events-none z-50';
                tooltip.textContent = this.getAttribute('title');
                tooltip.style.top = '-30px';
                tooltip.style.left = '50%';
                tooltip.style.transform = 'translateX(-50%)';
                
                this.style.position = 'relative';
                this.appendChild(tooltip);
                
                setTimeout(() => {
                    if (tooltip.parentNode) {
                        tooltip.parentNode.removeChild(tooltip);
                    }
                }, 2000);
            });
        });

        // Auto-refresh intervals
        setInterval(addFeedItem, 8000);
        setInterval(renderFraudHeatmap, 10000);

        // Advanced animations
        function animateValue(element, start, end, duration) {
            const range = end - start;
            const increment = range / (duration / 16);
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                    element.textContent = end;
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(current);
                }
            }, 16);
        }

        // Animate performance metrics on load
        window.addEventListener('load', () => {
            document.querySelectorAll('.performance-value').forEach(element => {
                const value = element.textContent;
                const numericValue = parseFloat(value.replace(/[^0-9.]/g, ''));
                const suffix = value.replace(/[0-9.]/g, '');
                
                element.textContent = `0${suffix}`;
                setTimeout(() => {
                    animateValue(element, 0, numericValue, 1500);
                    element.textContent = value;
                }, 500);
            });
        });
    </script>
</body>
</html>