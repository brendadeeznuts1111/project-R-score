<div id="fraud-tab" class="tab-content">
  <div class="section">
    <h2>üõ°Ô∏è Fraud Intelligence</h2>
    
    <!-- Live Pulse Widget: Webhook & DNS Health -->
    <div id="webhook-pulse-widget" style="margin-bottom: 20px; padding: 16px; background: rgba(0, 102, 255, 0.1); border: 1px solid rgba(0, 102, 255, 0.3); border-radius: 8px;">
      <h3 style="color: #00d4ff; font-size: 14px; margin: 0 0 12px; display: flex; align-items: center; gap: 8px;">
        <span style="animation: pulse 2s ease-in-out infinite;">üíì</span>
        Live Pulse: Webhook & DNS Health
      </h3>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
        <div>
          <div style="color: #888; font-size: 11px; margin-bottom: 4px;">DNS Hit Ratio</div>
          <div style="display: flex; align-items: center; gap: 8px;">
            <div id="dns-hit-ratio-bar" style="flex: 1; height: 20px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; position: relative;">
              <div id="dns-hit-ratio-fill" style="height: 100%; width: 0%; transition: width 0.3s ease, background 0.3s ease; background: #00ff00;"></div>
            </div>
            <span id="dns-hit-ratio-text" style="color: #fff; font-weight: bold; min-width: 50px; text-align: right;">--%</span>
          </div>
          <div id="dns-status-text" style="color: #888; font-size: 10px; margin-top: 4px;">Loading...</div>
        </div>
        <div>
          <div style="color: #888; font-size: 11px; margin-bottom: 4px;">Webhook Failure Rate</div>
          <div style="display: flex; align-items: center; gap: 8px;">
            <div id="webhook-failure-bar" style="flex: 1; height: 20px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; position: relative;">
              <div id="webhook-failure-fill" style="height: 100%; width: 0%; transition: width 0.3s ease, background 0.3s ease; background: #00ff00;"></div>
            </div>
            <span id="webhook-failure-text" style="color: #fff; font-weight: bold; min-width: 50px; text-align: right;">--%</span>
          </div>
          <div id="webhook-status-text" style="color: #888; font-size: 10px; margin-top: 4px;">Loading...</div>
        </div>
        <div>
          <div style="color: #888; font-size: 11px; margin-bottom: 4px;">Circuit Breaker</div>
          <div id="circuit-breaker-status" style="padding: 8px; background: rgba(255,255,255,0.05); border-radius: 4px; font-size: 12px;">
            <span id="circuit-breaker-state" style="color: #888;">Checking...</span>
          </div>
        </div>
      </div>
      <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.1); font-size: 11px; color: #888;">
        <div>Last Preconnect: <span id="last-preconnect-time">--</span></div>
        <div>Total Attempts: <span id="total-attempts">--</span> | Failures: <span id="total-failures">--</span></div>
      </div>
    </div>
    
    <!-- Cookie Analytics Widget -->
    <div id="cookie-analytics-widget" style="margin-bottom: 20px; padding: 16px; background: rgba(255, 165, 0, 0.1); border: 1px solid rgba(255, 165, 0, 0.3); border-radius: 8px;">
      <h3 style="color: #ffaa00; font-size: 14px; margin: 0 0 12px; display: flex; align-items: center; gap: 8px;">
        üç™ Cookie Analytics
      </h3>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
        <div>
          <div style="color: #888; font-size: 11px; margin-bottom: 4px;">Cookie Count</div>
          <div style="font-size: 18px; font-weight: bold; color: #fff;" id="cookie-count">--</div>
        </div>
        <div>
          <div style="color: #888; font-size: 11px; margin-bottom: 4px;">Total Size</div>
          <div style="font-size: 18px; font-weight: bold; color: #fff;" id="cookie-size">--</div>
        </div>
        <div>
          <div style="color: #888; font-size: 11px; margin-bottom: 4px;">Security</div>
          <div id="cookie-security" style="font-size: 12px; padding: 4px 8px; border-radius: 4px; display: inline-block;">
            <span id="cookie-security-text" style="color: #888;">Checking...</span>
          </div>
        </div>
        <div>
          <div style="color: #888; font-size: 11px; margin-bottom: 4px;">Fraud Session</div>
          <div id="fraud-session-status" style="font-size: 12px;">
            <span id="fraud-session-text" style="color: #888;">Checking...</span>
          </div>
        </div>
      </div>
      <div id="cookie-warning" style="margin-top: 12px; padding: 8px; background: rgba(255, 0, 0, 0.1); border: 1px solid rgba(255, 0, 0, 0.3); border-radius: 4px; display: none;">
        <span id="cookie-warning-text" style="color: #ff3333; font-size: 11px;"></span>
      </div>
    </div>
    
    <div id="fraud-unavailable" style="display: none; padding: 16px; background: rgba(255, 180, 0, 0.15); border: 1px solid #b8860b; border-radius: 8px; margin-bottom: 20px;">
      Fraud prevention module is not loaded. Ensure <code>@factorywager/fraud-prevention</code> is available.
    </div>
    <div id="fraud-content" style="display: none;">
      <h3 style="color: #aaa; font-size: 14px; margin: 20px 0 10px;">Collision Alert</h3>
      <p style="color: #888; font-size: 13px; margin-bottom: 10px;">Users sharing the same phone hash or device hash (potential multi-account abuse).</p>
      <div id="fraud-collisions"></div>
      <h3 style="color: #aaa; font-size: 14px; margin: 24px 0 10px;">Audit Trail</h3>
      <p style="color: #888; font-size: 13px; margin-bottom: 10px;">Account history for a user: <code>getAccountHistory(userId)</code>.</p>
      <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-bottom: 12px;">
        <input type="text" id="fraud-user-id" placeholder="@username" style="padding: 8px 12px; border: 1px solid #333; border-radius: 4px; background: rgba(255,255,255,0.05); color: #fff; width: 180px;" />
        <button type="button" onclick="loadAuditTrail()" style="padding: 8px 16px; background: #0066ff; color: white; border: none; border-radius: 4px; cursor: pointer;">Load history</button>
        <span id="fraud-audit-status" style="color: #888; font-size: 12px;"></span>
      </div>
      <div id="fraud-audit-table-wrap" style="overflow-x: auto;">
        <table id="fraud-audit-table" style="width: 100%; border-collapse: collapse; font-size: 12px; display: none;">
          <thead>
            <tr style="border-bottom: 1px solid #333;">
              <th style="text-align: left; padding: 8px;">id</th>
              <th style="text-align: left; padding: 8px;">eventType</th>
              <th style="text-align: left; padding: 8px;">timestamp</th>
              <th style="text-align: left; padding: 8px;">gateway</th>
              <th style="text-align: left; padding: 8px;">success</th>
              <th style="text-align: left; padding: 8px;">deviceHash</th>
              <th style="text-align: left; padding: 8px;">metadata</th>
            </tr>
          </thead>
          <tbody id="fraud-audit-tbody"></tbody>
        </table>
      </div>
      <div id="fraud-audit-empty" style="display: none; color: #666; padding: 12px;">Enter a userId and click Load history.</div>
      <h3 style="color: #aaa; font-size: 14px; margin: 24px 0 10px;">Reference Map</h3>
      <p style="color: #888; font-size: 13px; margin-bottom: 10px;">How many userIds are linked to a single reference hash (reference ‚Üí account count).</p>
      <div id="fraud-reference-map">
        <table style="width: 100%; border-collapse: collapse; font-size: 12px;"><thead><tr style="border-bottom: 1px solid #333;"><th style="text-align: left; padding: 8px;">Reference type</th><th style="text-align: left; padding: 8px;">Hash (truncated)</th><th style="text-align: right; padding: 8px;">User count</th><th style="text-align: left; padding: 8px;">Bar</th></tr></thead><tbody id="fraud-reference-map-body"></tbody></table>
      </div>
    </div>
  </div>
</div>
