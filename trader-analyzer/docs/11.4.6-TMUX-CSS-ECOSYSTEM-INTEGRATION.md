# Tmux ‚Üî CSS Design System Ecosystem Integration

**Version**: 11.4.6.0.0.0.0  
**Purpose**: Strategic integration of terminal operational context (Tmux) with visual design system (CSS)  
**Status**: ‚úÖ Complete  
**Last Updated**: 2024-12-07

---

## üéØ Overview: The Strategic Connection

**Tmux** provides the **operational context** and **developer environment** where Hyper-Bun engineers and analysts work. **CSS** defines the **visual experience** within the web-based dashboards and internal UIs accessed from that environment.

**The Connection**: When an engineer launches a tmux session (e.g., `mlgs-analytics`), they access web-based dashboards (e.g., `localhost:8080/registry.html`) that are styled by the CSS Design System. The colors, typography, and layout patterns must be consistent and meaningful across both layers.

---

## üèóÔ∏è Architecture: Three-Layer Integration

### Layer 1: Tmux Terminal Environment (11.4.4.0.0.0.0)

**Purpose**: Operational control center for Hyper-Bun development and operations.

**Components**:
- **Module Sessions**: `mlgs-core`, `mlgs-analytics`, `mlgs-research`, `mlgs-monitoring`
- **Windows**: Code editing, console, logs, dashboards
- **Status Bar**: Git branch, time, error/warning counts, CPU/memory

**Color System**: xterm-256color palette (`colour33`, `colour196`, `colour226`, etc.)

**Example Workflow**:
```bash
# Engineer starts development session
./scripts/tmux-mlgs.sh analytics

# Tmux creates session with:
# - Window 1: Dashboard (bun run dashboard)
# - Window 2: Correlation Engine (bun run correlation health)
# - Window 3: Metrics & Performance
```

### Layer 2: Web-Based Dashboards (Accessed from Tmux)

**Purpose**: Visual interfaces for operational insights and data analysis.

**Components**:
- **Registry Dashboard** (`localhost:8080/registry.html`)
- **Correlation Dashboard** (`localhost:8080/correlation.html`)
- **Shadow Graph Visualization** (`localhost:8080/shadow-graph.html`)
- **Covert Steam Alerts** (displayed in dashboard sections)

**Example Components**:
- `ShadowGraphViz` - Visual graph representation
- `CovertSteamEventRecordCard` - Alert cards with severity indicators
- `CorrelationCard` - Correlation event displays
- `AnomalyCounter` - Critical anomaly indicators

### Layer 3: CSS Design System (17.0.0.0.0.0.0)

**Purpose**: Unified visual language ensuring clarity, consistency, and semantic meaning.

**Components**:
- **17.1.0.0.0.0.0**: Color System & Semantic Color Patterns
- **17.2.0.0.0.0.0**: Theming (Light/Dark Mode)
- **17.3.0.0.0.0.0**: Typography System
- **17.4.0.0.0.0.0**: Spacing & Layout System
- **17.5.0.0.0.0.0**: Component Patterns & CSS Modules

**Color Variables**:
```css
--accent-cyan: #00d4ff;      /* API, Primary brand */
--accent-purple: #667eea;   /* Dashboard, Analytics */
--accent-green: #10b981;     /* Success, Active */
--accent-red: #ef4444;       /* Error, Critical */
--accent-yellow: #f59e0b;    /* Warning */
--accent-orange: #ff6b00;    /* Security, Monitoring */
```

---

## üîÑ Integration Flow: From Terminal to Dashboard

### Scenario 1: Error Detection & Visualization

**Step 1: Terminal Context (Tmux)**
```bash
# Engineer sees error in Logs window (Window 4)
[ERROR] HBMO-002 | MarketOfferingService | Required server configuration missing.
```

**Step 2: Dashboard Access (Tmux Analytics Window)**
```bash
# Engineer switches to Analytics window
# Dashboard loads: localhost:8080/registry.html
```

**Step 3: CSS Visual Design (Design System)**
```css
/* Dashboard displays error using semantic color */
.anomaly-counter.critical {
  background: var(--accent-red);  /* #ef4444 */
  color: var(--primary-bg);
  box-shadow: var(--critical-glow);
}
```

**Result**: Engineer sees red alert icon/status bar in dashboard, matching the error severity indicated in terminal logs.

**Color Consistency**:
- Terminal: `colour196` (#ff0000) for error count
- Dashboard: `--accent-red: #ef4444` for critical alerts
- **Connection**: Both use red to indicate errors/critical issues

---

### Scenario 2: Covert Steam Event Analysis

**Step 1: Research Console (Tmux Research Window)**
```bash
# Engineer runs research command
bun run console
> await research.covertSteamEvents()
# Returns: CovertSteamEventRecord with high impact_severity_score
```

**Step 2: Dashboard Visualization (Tmux Analytics Window)**
```bash
# Engineer switches to Analytics window
# Dashboard displays: CovertSteamEventRecordCard component
```

**Step 3: CSS Semantic Styling (Design System)**
```css
/* Component uses risk-based color coding */
.correlation-card.severity-critical {
  border-left-color: var(--accent-red);  /* #ef4444 */
  animation: critical-flash 3s infinite;
}

.correlation-card.severity-warning {
  border-left-color: var(--accent-yellow);  /* #f59e0b */
}

.correlation-card.severity-info {
  border-left-color: var(--accent-blue);  /* #00b8ff */
}
```

**Result**: Dashboard card displays with red border and pulsing animation, matching the high severity score from the research console.

**Color Consistency**:
- Terminal: Uses semantic colors in console output
- Dashboard: Uses CSS variables for visual indicators
- **Connection**: Same semantic meaning (red=critical, yellow=warning)

---

### Scenario 3: Shadow Graph Visualization

**Step 1: Research Session (Tmux Research Window)**
```bash
# Engineer analyzes shadow graph
bun run console
> const graph = await shadowGraph
> graph.getNodes()
# Returns: ShadowNode[] with visibility states
```

**Step 2: Visual Dashboard (Tmux Analytics Window)**
```bash
# Engineer opens Shadow Graph Visualization section
# Component: ShadowGraphViz
```

**Step 3: CSS Component Styling (Design System)**
```css
/* Shadow Graph section uses department color */
#shadow-graph-section {
  background: rgba(102, 126, 234, 0.1);  /* --accent-purple with opacity */
  border: 2px solid rgba(102, 126, 234, 0.3);
}

/* Nodes use semantic colors for visibility states */
.propagation-node.active {
  border-color: var(--accent-green);  /* #10b981 - Active/Display */
  background: var(--accent-green);
}

.propagation-node.dark {
  border-color: var(--accent-red);  /* #ef4444 - Dark/Hidden */
}
```

**Result**: Visual graph matches the data structure from console, with colors indicating node states (active=green, dark=red).

**Color Consistency**:
- Terminal: Console output uses color coding
- Dashboard: CSS uses semantic colors for visual states
- **Connection**: Same color meanings (green=active, red=hidden/critical)

---

## üé® Color Pattern Integration

### Semantic Color Mapping

| Meaning | Terminal (xterm-256) | Dashboard (CSS) | Usage |
|---------|---------------------|-----------------|-------|
| **Success/Active** | `colour82` (#5fff87) | `--accent-green: #10b981` | Health checks, active nodes |
| **Error/Critical** | `colour196` (#ff0000) | `--accent-red: #ef4444` | Errors, critical alerts |
| **Warning** | `colour220` (#ffd700) | `--accent-yellow: #f59e0b` | Warnings, medium severity |
| **Info/API** | `colour51` (#00ffff) | `--accent-cyan: #00d4ff` | API endpoints, info messages |
| **Analytics** | `colour99` (#875fff) | `--accent-purple: #667eea` | Dashboard, analytics views |
| **Security** | `colour166` (#d75f00) | `--accent-orange: #ff6b00` | Security, monitoring |

### Module-Specific Color Coding

**Core Development Session** (`mlgs-core`):
- Terminal: Cyan theme (`colour51`) - matches `--dept-api: #00d4ff`
- Dashboard: API-related components use `--accent-cyan`

**Analytics Session** (`mlgs-analytics`):
- Terminal: Purple theme (`colour99`) - matches `--dept-dashboard: #667eea`
- Dashboard: Analytics components use `--accent-purple`

**Research Session** (`mlgs-research`):
- Terminal: Purple theme (`colour93`) - matches `--dept-orca: #9c27b0`
- Dashboard: Research components use purple variants

**Monitoring Session** (`mlgs-monitoring`):
- Terminal: Orange theme (`colour166`) - matches `--dept-security: #ff6b00`
- Dashboard: Security/monitoring components use `--accent-orange`

---

## üîß Implementation: Connecting the Layers

### Pattern 1: Status Bar ‚Üí Dashboard Status Indicators

**Tmux Status Bar**:
```tmux
# Error count in status bar
#[fg=colour196]ERR:#{error_count}
```

**Dashboard Status Indicator**:
```css
.status-dot.critical {
  background: var(--accent-red);  /* Matches colour196 semantic meaning */
}
```

**Connection**: Both use red to indicate errors, providing visual consistency when switching between terminal and dashboard.

### Pattern 2: Module Session ‚Üí Dashboard Theme

**Tmux Session Creation**:
```bash
# Analytics session uses purple theme
create_mlgs_analytics_session() {
  # Session uses purple color coding
  tmux set-option -t "$session_name" status-style "bg=colour234,fg=colour99"
}
```

**Dashboard Component**:
```css
/* Analytics dashboard section */
#analytics-section {
  border-color: var(--accent-purple);  /* #667eea matches colour99 */
  background: rgba(102, 126, 234, 0.1);
}
```

**Connection**: Same purple color identifies analytics-related content in both terminal and dashboard.

### Pattern 3: Log Severity ‚Üí Component Severity

**Terminal Log Output**:
```bash
# Log uses semantic colors
[ERROR] ‚Üí Red text (colour196)
[WARN]  ‚Üí Yellow text (colour220)
[INFO]  ‚Üí Cyan text (colour51)
```

**Dashboard Component**:
```css
.correlation-card.severity-critical {
  border-left-color: var(--accent-red);  /* Matches ERROR color */
}

.correlation-card.severity-warning {
  border-left-color: var(--accent-yellow);  /* Matches WARN color */
}
```

**Connection**: Same color coding for severity levels across terminal logs and dashboard components.

---

## üìä Component-Specific Integration

### ShadowGraphViz Component

**Terminal Context**:
- Accessed via Research console (`bun run console`)
- Data structure: `ShadowNode[]` with visibility states

**Dashboard Display**:
- Component: `ShadowGraphViz` in registry dashboard
- CSS: Uses semantic colors for node states

**Color Mapping**:
```css
/* Active/Display nodes */
.propagation-node.active {
  border-color: var(--accent-green);  /* #10b981 */
}

/* Dark/Hidden nodes */
.propagation-node.dark {
  border-color: var(--accent-red);  /* #ef4444 */
}

/* API-only nodes */
.propagation-node.api-only {
  border-color: var(--accent-cyan);  /* #00d4ff */
}
```

**Integration**: Terminal console output and dashboard visualization use consistent color meanings.

### CovertSteamEventRecordCard Component

**Terminal Context**:
- Research console: `await research.covertSteamEvents()`
- Returns: `CovertSteamEventRecord` with `impact_severity_score`

**Dashboard Display**:
- Component: `CovertSteamEventRecordCard`
- CSS: Risk-based color coding

**Color Mapping**:
```css
/* Critical severity */
.covert-steam-card.critical {
  background: rgba(239, 68, 68, 0.1);  /* --accent-red */
  border-color: var(--accent-red);
}

/* Warning severity */
.covert-steam-card.warning {
  background: rgba(245, 158, 11, 0.1);  /* --accent-yellow */
  border-color: var(--accent-yellow);
}
```

**Integration**: Severity scores from console match visual severity indicators in dashboard.

### CorrelationCard Component

**Terminal Context**:
- Correlation CLI: `bun run correlation health`
- Returns: Correlation metrics and anomalies

**Dashboard Display**:
- Component: `CorrelationCard`
- CSS: Semantic color coding for correlation strength

**Color Mapping**:
```css
.correlation-card.high-correlation {
  border-left-color: var(--accent-green);  /* Strong correlation */
}

.correlation-card.low-correlation {
  border-left-color: var(--accent-yellow);  /* Weak correlation */
}

.correlation-card.anomaly {
  border-left-color: var(--accent-red);  /* Anomaly detected */
}
```

**Integration**: Correlation metrics from CLI match visual indicators in dashboard.

---

## üéØ Benefits of Integration

### 1. **Cognitive Consistency**
- Engineers recognize color meanings across terminal ‚Üí dashboard ‚Üí logs
- Reduced mental overhead when switching contexts
- Faster problem identification and resolution

### 2. **Operational Efficiency**
- Visual consistency enables faster workflow transitions
- Color-coded modules help identify functional areas quickly
- Semantic colors convey meaning without reading text

### 3. **Accessibility**
- High contrast maintained across all layers
- Color-blind friendly (use symbols + colors)
- Consistent visual hierarchy

### 4. **Maintainability**
- Single source of truth for color definitions (CSS variables)
- Easy to update across all interfaces
- Version-controlled design system

---

## üìã Integration Checklist

### Phase 1: Color Alignment ‚úÖ
- [x] Map terminal colors to CSS variables
- [x] Document semantic color meanings
- [x] Create color mapping reference

### Phase 2: Module Colors (In Progress)
- [ ] Add module-specific status bar colors
- [ ] Color-code dashboard sections by module
- [ ] Match department colors across layers

### Phase 3: Component Integration
- [ ] Ensure ShadowGraphViz uses semantic colors
- [ ] Align CovertSteamEventRecordCard with severity colors
- [ ] Match CorrelationCard with correlation metrics

### Phase 4: Theme Support
- [ ] Detect system theme preference
- [ ] Switch tmux colors based on theme
- [ ] Match dashboard `light-dark()` behavior

---

## üîç Ripgrep Patterns

```bash
# Find color usage across layers
rg "colour196|--accent-red" config/.tmux.conf styles/*.css
rg "colour220|--accent-yellow" config/.tmux.conf styles/*.css
rg "colour82|--accent-green" config/.tmux.conf styles/*.css

# Find component styling
rg "ShadowGraphViz|shadow-graph" styles/*.css dashboard/*.html
rg "CovertSteam|covert-steam" styles/*.css dashboard/*.html
rg "CorrelationCard|correlation-card" styles/*.css dashboard/*.html

# Find semantic color patterns
rg "severity-critical|severity-warning" styles/*.css
rg "active|dark|api-only" styles/*.css
```

---

## üìö Related Documentation

- `docs/11.4.4-QUICK-REFERENCE.md` - Tmux module sessions quick reference
- `docs/11.4.5-COLOR-PATTERNS-INTEGRATION.md` - Color pattern integration guide
- `docs/11.4.5-COLOR-MAPPING-QUICK-REFERENCE.md` - Color mapping reference
- `styles/dashboard.css` - Dashboard color definitions
- `styles/golden-template.css` - Modern CSS color patterns
- `src/utils/bun-color.ts` - Bun color utility with theme colors

---

**Version**: 11.4.6.0.0.0.0  
**Status**: ‚úÖ Complete  
**Next Steps**: Implement Phase 2 module-specific colors and Phase 3 component integration
