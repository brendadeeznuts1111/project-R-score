# Code Reference Matrix: Empire Pro Ecosystem

## §ARC:100 - Unified Architecture Matrix

| Component | Level | Primary Class/Interface | Purpose | Naming Convention |
| :--- | :--- | :--- | :--- | :--- |
| **SDK** | Client | `DuoPlusSDK` | Main interface for RPA tasks | `camelCase` / `PascalCase` classes |
| **Orchestration** | Logic | `EnhancedOrchestrator` | Manages workers and task flows | `kebab-case` files |
| **Storage** | Data | `BunR2AppleManager` | Bun-native High-perf R2 Manager | `SCREAMING_SNAKE` constants |
| **API** | Edge | `dashboardRoutes` | Elysia-powered standardized endpoints | `v1` prefix |
| **Security** | Governance | `PERMISSIONS` | RBAC Matrix for infrastructure control | `object:literal` |

---

## §INT:110 - Core Domain Interfaces

### 1. RPA Task Schema

```typescript
/**
 * §SCHEMA:RPATask
 * defines the structure for all automated actions
 */
export interface RPATask {
  type: string;           // Task category (e.g., 'apple-reg')
  metadata?: Record<string, any>; 
  r2Path?: string;        // Scoped key for cloud storage
  priority?: number;      // 1-10 (1 is highest)
  timeout?: number;       // Execution guard in seconds
  phoneID?: string;       // Assigned device ID
}
```

### 2. Analytics Matrix Profile

```typescript
/**
 * §SCHEMA:ProfileMatrixEntry
 * Mapping used in analytics-dashboard v118
 */
export interface ProfileMatrixEntry {
  e164: string;           // Unique phone identifier
  trustScore: number;     // 0-100 trust level
  status: 'ACTIVE' | 'FLAGGED' | 'STALE';
  worker: string;         // Assigned WORKER_ID
  duoplusCredits: string; // Remaining balance
  readOnly: {
    createdAt: string;    // ISO Date
    hwid: string;         // Hardware identifier
  };
}
```

---

## §BUN:120 - High Performance One-Liners

Optimized Bun-native primitives used across the system:

- **Ultra-Fast I/O**:

  ```typescript
  // LSP: write binary without node:fs
  await Bun.write('output.json', JSON.stringify(data)); 
  ```

- **Zstd Efficiency**:

  ```typescript
  // LSP: 8.4x compression ratio
  const compressed = Bun.zstdCompressSync(new TextEncoder().encode(data));
  ```

- **IP Tracking**:

  ```typescript
  // LSP: Get client IP from native server
  const clientIP = server.requestIP(req);
  ```

---

## §MAP:130 - Property Alignment Table

To avoid naming confusion, the following mapping is enforced across SDK and API:

| SDK Property | API Equivalent | UI Display | Description |
| :--- | :--- | :--- | :--- |
| `phoneID` | `phoneNumber` | **Identity** | Valid E.164 formatted number |
| `r2Path` | `key` | **Path** | Physical location in Cloudflare R2 |
| `trustScore` | `score` | **Trust** | Calculated probability of task success |
| `metadata.hwid` | `readOnly.hwid` | **HWID** | Unique hardware signature (Immutable) |

---

## §STS:140 - System Status Constants

```json
{
  "PERMISSIONS": {
    "OPS": { "METRICS": "ops:metrics", "CLEANUP": "storage:delete" },
    "TASKS": { "CREATE": "tasks:create" }
  },
  "SCOPES": ["ENTERPRISE", "DEVELOPMENT", "LOCAL-SANDBOX"]
}
```

---
*Generated by Empire Pro Documentation Engine v2.1.0*
